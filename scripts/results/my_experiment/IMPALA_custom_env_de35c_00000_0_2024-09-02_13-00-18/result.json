{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 46344, "learner_queue": {"size_count": 0, "size_mean": NaN, "size_std": NaN, "size_quantiles": 1.0}, "timing_breakdown": {"learner_grad_time_ms": 0.0, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 0.0, "learner_dequeue_time_ms": 0.0}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 0, "num_env_steps_sampled_lifetime": 0, "num_agent_steps_sampled_lifetime": 0, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 0, "timers": {"training_iteration_time_ms": 10000.317, "restore_workers_time_ms": 0.008, "training_step_time_ms": 0.196, "sample_time_ms": 0.172, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 46344}, "done": false, "training_iteration": 1, "trial_id": "de35c_00000", "date": "2024-09-02_13-01-12", "timestamp": 1725249672, "time_this_iter_s": 39.269312620162964, "time_total_s": 39.269312620162964, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.269312620162964, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 68.25714285714285, "ram_util_percent": 61.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -2747.46484375, "policy_loss": -3095.6142578125, "entropy": 11.837623596191406, "entropy_coeff": 0.01, "var_gnorm": 2048.5341796875, "vf_loss": 1666.0369873046875, "vf_explained_var": -0.01780688762664795}, "model": {}, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 43520, "num_training_step_calls_since_last_synch_worker_weights": 42233, "num_samples_added_to_queue": 16384, "num_times_learner_queue_full": 2, "num_weight_broadcasts": 1, "learner_queue": {"size_count": 4, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 150.158, "learner_load_time_ms": 931.847, "learner_load_wait_time_ms": 11224.075, "learner_dequeue_time_ms": 40710.55}}, "env_runners": {"episode_reward_max": 1.6697754290362354e-13, "episode_reward_min": 0.0, "episode_reward_mean": 1.517977662760214e-14, "episode_len_mean": 1026.1818181818182, "episode_media": {}, "episodes_timesteps_total": 11288, "policy_reward_min": {"default_policy": -850.0}, "policy_reward_max": {"default_policy": 857.7205255792884}, "policy_reward_mean": {"default_policy": 5.190051287291166e-14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.6697754290362354e-13, 0.0, 0.0, 0.0], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1027, 1026, 1026, 1027, 1026], "policy_default_policy_reward": [46.0, -46.0, 644.0, -644.0, 565.0, -565.0, -761.0, 761.0, -726.0, 726.0, -850.0, 850.0, -788.0, 788.0, 857.7205255792884, -737.5123727775738, -120.20815280171344, 483.0, -483.0, -214.0, 214.0, -289.0, 289.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.066477276924642, "mean_inference_ms": 4.506509059376426, "mean_action_processing_ms": 0.8460451205899411, "mean_env_wait_ms": 22.55341972727822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014016845009543678, "StateBufferConnector_ms": 0.012148510326038708, "ViewRequirementAgentConnector_ms": 0.4573778672651811}, "num_episodes": 11, "episode_return_max": 1.6697754290362354e-13, "episode_return_min": 0.0, "episode_return_mean": 1.517977662760214e-14, "episodes_this_iter": 11}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 43520, "num_env_steps_sampled": 25600, "num_env_steps_trained": 43520, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 43520, "num_env_steps_sampled_throughput_per_sec": 2559.9884033728445, "num_env_steps_trained_throughput_per_sec": 4351.980285733836, "timesteps_total": 25600, "num_env_steps_sampled_lifetime": 25600, "num_agent_steps_sampled_lifetime": 68608, "num_steps_trained_this_iter": 43520, "agent_timesteps_total": 68608, "timers": {"training_iteration_time_ms": 10000.186, "restore_workers_time_ms": 0.007, "training_step_time_ms": 0.154, "sample_time_ms": 0.109, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 43520, "num_training_step_calls_since_last_synch_worker_weights": 42233, "num_samples_added_to_queue": 16384, "num_times_learner_queue_full": 2, "num_weight_broadcasts": 1}, "done": false, "training_iteration": 2, "trial_id": "de35c_00000", "date": "2024-09-02_13-01-59", "timestamp": 1725249719, "time_this_iter_s": 46.7825665473938, "time_total_s": 86.05187916755676, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.05187916755676, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 50.26119402985075, "ram_util_percent": 63.191044776119405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -6259.7998046875, "policy_loss": -7485.22314453125, "entropy": 12.364137649536133, "entropy_coeff": 0.01, "var_gnorm": 2048.5341796875, "vf_loss": 3463.716552734375, "vf_explained_var": 0.00688403844833374}, "model": {}, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 95718, "num_agent_steps_sampled": 149478, "num_agent_steps_trained": 95718, "num_training_step_calls_since_last_synch_worker_weights": 45773, "num_samples_added_to_queue": 32768, "num_times_learner_queue_full": 4, "num_weight_broadcasts": 2, "learner_queue": {"size_count": 8, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 129.297, "learner_load_time_ms": 931.847, "learner_load_wait_time_ms": 11357.96, "learner_dequeue_time_ms": 40710.55}}, "env_runners": {"episode_reward_max": 4.218847493575595e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 6.489650087157121e-14, "episode_len_mean": 1537.8214285714287, "episode_media": {}, "episodes_timesteps_total": 43059, "policy_reward_min": {"default_policy": -2095.864499436885}, "policy_reward_max": {"default_policy": 2994.2820895569203}, "policy_reward_mean": {"default_policy": 2.4434883340440487e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.6697754290362354e-13, 0.0, 0.0, 0.0, 4.2099657093785936e-13, 0.0, 3.3306690738754696e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.063416270128073e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.001243780749064e-13, 1.1102230246251565e-16, 0.0, 4.218847493575595e-13, 0.0, 2.220446049250313e-16], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1027, 1026, 1026, 1027, 1026, 2050, 2050, 2050, 1024, 1023, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 1024, 2050, 2050, 2050], "policy_default_policy_reward": [46.0, -46.0, 644.0, -644.0, 565.0, -565.0, -761.0, 761.0, -726.0, 726.0, -850.0, 850.0, -788.0, 788.0, 857.7205255792884, -737.5123727775738, -120.20815280171344, 483.0, -483.0, -214.0, 214.0, -289.0, 289.0, 344.36100243785023, -695.0859659063806, 350.7249634685297, -1316.0, 1316.0, -655.761811921523, -347.761811921513, -1429.3223166441626, 2432.845940487173, 655.0, -655.0, 329.0, -329.0, -1541.8812264734613, 2688.498861084164, -482.3088173053092, -664.3088173053155, -1241.0956056608634, 1573.6493607140812, -1607.095605660842, 1274.5418506076828, 1958.6857838867506, -646.2955980045097, -1312.390185882196, -654.419887294617, 2410.155341563976, -963.315566974707, -792.4198872946238, -383.0, 383.0, 0.0, 0.0, 1726.7547596575623, -2095.864499436885, 369.1097397793801, -848.6596702664101, -310.6596702663877, -737.808418582006, 1897.1277591147282, 715.0, -715.0, -1080.4591616530442, 2018.7898602876076, -938.330698634556, 0.0, 0.0, -929.6775269347748, 2994.2820895569203, -1162.9270356873672, -901.6775269347735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.322687242530809, "mean_inference_ms": 4.658009502980507, "mean_action_processing_ms": 0.9082157520701664, "mean_env_wait_ms": 21.657912302452335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021313769476754323, "StateBufferConnector_ms": 0.013414451054164342, "ViewRequirementAgentConnector_ms": 0.5133271217346191}, "num_episodes": 17, "episode_return_max": 4.218847493575595e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 6.489650087157121e-14, "episodes_this_iter": 17}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149478, "num_agent_steps_trained": 95718, "num_env_steps_sampled": 51200, "num_env_steps_trained": 95718, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 52198, "num_env_steps_sampled_throughput_per_sec": 2559.993896498927, "num_env_steps_trained_throughput_per_sec": 5219.787555056679, "timesteps_total": 51200, "num_env_steps_sampled_lifetime": 51200, "num_agent_steps_sampled_lifetime": 149478, "num_steps_trained_this_iter": 52198, "agent_timesteps_total": 149478, "timers": {"training_iteration_time_ms": 10000.136, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.15, "sample_time_ms": 0.106, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 95718, "num_agent_steps_sampled": 149478, "num_agent_steps_trained": 95718, "num_training_step_calls_since_last_synch_worker_weights": 45773, "num_samples_added_to_queue": 32768, "num_times_learner_queue_full": 4, "num_weight_broadcasts": 2}, "done": false, "training_iteration": 3, "trial_id": "de35c_00000", "date": "2024-09-02_13-02-50", "timestamp": 1725249770, "time_this_iter_s": 50.515127658843994, "time_total_s": 136.56700682640076, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.56700682640076, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 50.44583333333334, "ram_util_percent": 63.254166666666656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 13448.509765625, "policy_loss": 4846.45458984375, "entropy": 12.222277641296387, "entropy_coeff": 0.01, "var_gnorm": 2048.5341796875, "vf_loss": 18205.359375, "vf_explained_var": -0.03180062770843506}, "model": {}, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 145243, "num_agent_steps_sampled": 228806, "num_agent_steps_trained": 145243, "num_training_step_calls_since_last_synch_worker_weights": 44027, "num_samples_added_to_queue": 49152, "num_times_learner_queue_full": 6, "num_weight_broadcasts": 3, "learner_queue": {"size_count": 12, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 130.289, "learner_load_time_ms": 941.221, "learner_load_wait_time_ms": 9807.921, "learner_dequeue_time_ms": 68574.796}}, "env_runners": {"episode_reward_max": 4.218847493575595e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 7.321017177499143e-14, "episode_len_mean": 1549.0697674418604, "episode_media": {}, "episodes_timesteps_total": 66610, "policy_reward_min": {"default_policy": -2095.864499436885}, "policy_reward_max": {"default_policy": 3153.260270728387}, "policy_reward_mean": {"default_policy": -4.586011419956714e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.6697754290362354e-13, 0.0, 0.0, 0.0, 4.2099657093785936e-13, 0.0, 3.3306690738754696e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.063416270128073e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.001243780749064e-13, 1.1102230246251565e-16, 0.0, 4.218847493575595e-13, 0.0, 2.220446049250313e-16, 3.801403636316536e-13, 3.11972669919669e-13, -2.220446049250313e-16, 1.1102230246251565e-16, 2.220446049250313e-16, 0.0, 0.0, 1.4921397450962104e-13, -3.3306690738754696e-16, 2.602362769721367e-13, 0.0, 0.0, 1.9828583219805296e-13, 3.1308289294429414e-14, 0.0], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1027, 1026, 1026, 1027, 1026, 2050, 2050, 2050, 1024, 1023, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 1024, 2050, 2050, 2050, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 2048, 1024, 1024, 1024, 2047, 1024], "policy_default_policy_reward": [46.0, -46.0, 644.0, -644.0, 565.0, -565.0, -761.0, 761.0, -726.0, 726.0, -850.0, 850.0, -788.0, 788.0, 857.7205255792884, -737.5123727775738, -120.20815280171344, 483.0, -483.0, -214.0, 214.0, -289.0, 289.0, 344.36100243785023, -695.0859659063806, 350.7249634685297, -1316.0, 1316.0, -655.761811921523, -347.761811921513, -1429.3223166441626, 2432.845940487173, 655.0, -655.0, 329.0, -329.0, -1541.8812264734613, 2688.498861084164, -482.3088173053092, -664.3088173053155, -1241.0956056608634, 1573.6493607140812, -1607.095605660842, 1274.5418506076828, 1958.6857838867506, -646.2955980045097, -1312.390185882196, -654.419887294617, 2410.155341563976, -963.315566974707, -792.4198872946238, -383.0, 383.0, 0.0, 0.0, 1726.7547596575623, -2095.864499436885, 369.1097397793801, -848.6596702664101, -310.6596702663877, -737.808418582006, 1897.1277591147282, 715.0, -715.0, -1080.4591616530442, 2018.7898602876076, -938.330698634556, 0.0, 0.0, -929.6775269347748, 2994.2820895569203, -1162.9270356873672, -901.6775269347735, -1837.7705243037567, 43.840620433565824, 1793.9299038702848, -735.3910524340142, 421.7802666341059, 313.61078579990703, 1781.358613752328, 149.9162987847017, -699.5537550532263, -1231.7211574838293, -1066.28304342461, -826.105331441726, 1940.3913509776476, -48.00297611141942, 1850.3447443171779, -969.4339704049556, -261.4768035073657, -619.4339704049395, 755.0, -755.0, 354.0, -354.0, -209.30360723121913, 817.4154390516549, -608.1118318204345, 1409.9085952475168, -282.88239401646234, -921.4702675131427, -205.55593371797937, 1217.6378772032128, 50.91168824543138, -1268.5495654486751, 834.0, -834.0, 103.0, -103.0, 195.8685783886746, -962.3723291948977, 766.503750806223, 3153.260270728387, -853.4510296266673, -1089.8601925551536, -1209.9490485465792, 78.0, -78.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.817073870649124, "mean_inference_ms": 4.630646433084333, "mean_action_processing_ms": 0.907313229575256, "mean_env_wait_ms": 21.25137773472263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01977987067643986, "StateBufferConnector_ms": 0.013909783474234648, "ViewRequirementAgentConnector_ms": 0.5419265392214753}, "num_episodes": 15, "episode_return_max": 4.218847493575595e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 7.321017177499143e-14, "episodes_this_iter": 15}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228806, "num_agent_steps_trained": 145243, "num_env_steps_sampled": 76800, "num_env_steps_trained": 145243, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 49525, "num_env_steps_sampled_throughput_per_sec": 2559.9862671635124, "num_env_steps_trained_throughput_per_sec": 4952.473432862224, "timesteps_total": 76800, "num_env_steps_sampled_lifetime": 76800, "num_agent_steps_sampled_lifetime": 228806, "num_steps_trained_this_iter": 49525, "agent_timesteps_total": 228806, "timers": {"training_iteration_time_ms": 10000.117, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.144, "sample_time_ms": 0.101, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 145243, "num_agent_steps_sampled": 228806, "num_agent_steps_trained": 145243, "num_training_step_calls_since_last_synch_worker_weights": 44027, "num_samples_added_to_queue": 49152, "num_times_learner_queue_full": 6, "num_weight_broadcasts": 3}, "done": false, "training_iteration": 4, "trial_id": "de35c_00000", "date": "2024-09-02_13-03-37", "timestamp": 1725249817, "time_this_iter_s": 47.33302974700928, "time_total_s": 183.90003657341003, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 183.90003657341003, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 52.670149253731346, "ram_util_percent": 63.40298507462686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -22664.638671875, "policy_loss": -42580.3203125, "entropy": 12.171875953674316, "entropy_coeff": 0.01, "var_gnorm": 2048.5341796875, "vf_loss": 40828.48046875, "vf_explained_var": 0.008916974067687988}, "model": {}, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 102400, "num_env_steps_trained": 195317, "num_agent_steps_sampled": 306297, "num_agent_steps_trained": 195317, "num_training_step_calls_since_last_synch_worker_weights": 43937, "num_samples_added_to_queue": 65536, "num_times_learner_queue_full": 9, "num_weight_broadcasts": 4, "learner_queue": {"size_count": 16, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 135.85, "learner_load_time_ms": 941.221, "learner_load_wait_time_ms": 9880.335, "learner_dequeue_time_ms": 68574.796}}, "env_runners": {"episode_reward_max": 4.3298697960381105e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 9.903982396102557e-14, "episode_len_mean": 1610.0357142857142, "episode_media": {}, "episodes_timesteps_total": 90162, "policy_reward_min": {"default_policy": -2095.864499436885}, "policy_reward_max": {"default_policy": 3153.260270728387}, "policy_reward_mean": {"default_policy": 8.269450234272962e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.6697754290362354e-13, 0.0, 0.0, 0.0, 4.2099657093785936e-13, 0.0, 3.3306690738754696e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.063416270128073e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.001243780749064e-13, 1.1102230246251565e-16, 0.0, 4.218847493575595e-13, 0.0, 2.220446049250313e-16, 3.801403636316536e-13, 3.11972669919669e-13, -2.220446049250313e-16, 1.1102230246251565e-16, 2.220446049250313e-16, 0.0, 0.0, 1.4921397450962104e-13, -3.3306690738754696e-16, 2.602362769721367e-13, 0.0, 0.0, 1.9828583219805296e-13, 3.1308289294429414e-14, 0.0, 4.3298697960381105e-13, 0.0, -2.220446049250313e-16, 0.0, 3.3084646133829665e-13, 0.0, 3.2374103398069565e-13, 4.1944225870338414e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 2.227107387398064e-13, 3.2596148002994596e-13, 3.423927807943983e-13], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1027, 1026, 1026, 1027, 1026, 2050, 2050, 2050, 1024, 1023, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 1024, 2050, 2050, 2050, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 2048, 1024, 1024, 1024, 2047, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048], "policy_default_policy_reward": [46.0, -46.0, 644.0, -644.0, 565.0, -565.0, -761.0, 761.0, -726.0, 726.0, -850.0, 850.0, -788.0, 788.0, 857.7205255792884, -737.5123727775738, -120.20815280171344, 483.0, -483.0, -214.0, 214.0, -289.0, 289.0, 344.36100243785023, -695.0859659063806, 350.7249634685297, -1316.0, 1316.0, -655.761811921523, -347.761811921513, -1429.3223166441626, 2432.845940487173, 655.0, -655.0, 329.0, -329.0, -1541.8812264734613, 2688.498861084164, -482.3088173053092, -664.3088173053155, -1241.0956056608634, 1573.6493607140812, -1607.095605660842, 1274.5418506076828, 1958.6857838867506, -646.2955980045097, -1312.390185882196, -654.419887294617, 2410.155341563976, -963.315566974707, -792.4198872946238, -383.0, 383.0, 0.0, 0.0, 1726.7547596575623, -2095.864499436885, 369.1097397793801, -848.6596702664101, -310.6596702663877, -737.808418582006, 1897.1277591147282, 715.0, -715.0, -1080.4591616530442, 2018.7898602876076, -938.330698634556, 0.0, 0.0, -929.6775269347748, 2994.2820895569203, -1162.9270356873672, -901.6775269347735, -1837.7705243037567, 43.840620433565824, 1793.9299038702848, -735.3910524340142, 421.7802666341059, 313.61078579990703, 1781.358613752328, 149.9162987847017, -699.5537550532263, -1231.7211574838293, -1066.28304342461, -826.105331441726, 1940.3913509776476, -48.00297611141942, 1850.3447443171779, -969.4339704049556, -261.4768035073657, -619.4339704049395, 755.0, -755.0, 354.0, -354.0, -209.30360723121913, 817.4154390516549, -608.1118318204345, 1409.9085952475168, -282.88239401646234, -921.4702675131427, -205.55593371797937, 1217.6378772032128, 50.91168824543138, -1268.5495654486751, 834.0, -834.0, 103.0, -103.0, 195.8685783886746, -962.3723291948977, 766.503750806223, 3153.260270728387, -853.4510296266673, -1089.8601925551536, -1209.9490485465792, 78.0, -78.0, -733.269732090455, -1619.9816356982965, 2353.251367788782, 302.0, -302.0, 1668.4038391946892, -218.3768405169832, -384.37684051698955, -1065.6501581607577, -819.0, 819.0, 1704.834449440779, -1455.9328624630425, -248.90158697766614, 0.0, 0.0, -1289.7627688842292, 48.33095244168749, 1241.4318164425897, 1828.5781361484014, 36.062445840513746, -1864.6405819888873, -1284.0765814495824, -563.4442799572253, 2678.855666268037, -831.334804861221, 36.05314265470375, -1202.3006864177516, -1139.9468573452843, 2306.1944011083233, -809.6372644586028, 218.9247481060251, 590.7125163525777, -1277.7419536040597, 1836.356310741478, -558.6143571373764, 2119.9061299972736, -968.7362902255772, -1151.169839771687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.835731437197492, "mean_inference_ms": 4.642462919877924, "mean_action_processing_ms": 0.920537659706552, "mean_env_wait_ms": 21.017413138877973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01952094691140311, "StateBufferConnector_ms": 0.014128855296543666, "ViewRequirementAgentConnector_ms": 0.5567554916654315}, "num_episodes": 13, "episode_return_max": 4.3298697960381105e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 9.903982396102557e-14, "episodes_this_iter": 13}, "num_healthy_workers": 24, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306297, "num_agent_steps_trained": 195317, "num_env_steps_sampled": 102400, "num_env_steps_trained": 195317, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 50074, "num_env_steps_sampled_throughput_per_sec": 2559.9683231458735, "num_env_steps_trained_throughput_per_sec": 5007.338039578377, "timesteps_total": 102400, "num_env_steps_sampled_lifetime": 102400, "num_agent_steps_sampled_lifetime": 306297, "num_steps_trained_this_iter": 50074, "agent_timesteps_total": 306297, "timers": {"training_iteration_time_ms": 10000.121, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.154, "sample_time_ms": 0.11, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 102400, "num_env_steps_trained": 195317, "num_agent_steps_sampled": 306297, "num_agent_steps_trained": 195317, "num_training_step_calls_since_last_synch_worker_weights": 43937, "num_samples_added_to_queue": 65536, "num_times_learner_queue_full": 9, "num_weight_broadcasts": 4}, "done": false, "training_iteration": 5, "trial_id": "de35c_00000", "date": "2024-09-02_13-04-26", "timestamp": 1725249866, "time_this_iter_s": 48.65108776092529, "time_total_s": 232.55112433433533, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 232.55112433433533, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 47.15362318840579, "ram_util_percent": 62.75797101449277}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 26062.548828125, "policy_loss": -4638.47216796875, "entropy": 12.256529569625854, "entropy_coeff": 0.01, "var_gnorm": 2048.5341796875, "vf_loss": 62405.9736328125, "vf_explained_var": -0.019016891717910767}, "model": {}, "num_grad_updates_lifetime": 18.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 132608, "num_env_steps_trained": 247445, "num_agent_steps_sampled": 406404, "num_agent_steps_trained": 247445, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_samples_added_to_queue": 86016, "num_times_learner_queue_full": 11, "num_weight_broadcasts": 6, "total_num_restored_workers": 3, "learner_queue": {"size_count": 21, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 123.33, "learner_load_time_ms": 803.785, "learner_load_wait_time_ms": 11172.427, "learner_dequeue_time_ms": 77459.266}}, "env_runners": {"episode_reward_max": 4.3298697960381105e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.207218988311774e-13, "episode_len_mean": 1644.8732394366198, "episode_media": {}, "episodes_timesteps_total": 116786, "policy_reward_min": {"default_policy": -2095.864499436885}, "policy_reward_max": {"default_policy": 3153.260270728387}, "policy_reward_mean": {"default_policy": 1.6215928544670306e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.6697754290362354e-13, 0.0, 0.0, 0.0, 4.2099657093785936e-13, 0.0, 3.3306690738754696e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.063416270128073e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.001243780749064e-13, 1.1102230246251565e-16, 0.0, 4.218847493575595e-13, 0.0, 2.220446049250313e-16, 3.801403636316536e-13, 3.11972669919669e-13, -2.220446049250313e-16, 1.1102230246251565e-16, 2.220446049250313e-16, 0.0, 0.0, 1.4921397450962104e-13, -3.3306690738754696e-16, 2.602362769721367e-13, 0.0, 0.0, 1.9828583219805296e-13, 3.1308289294429414e-14, 0.0, 4.3298697960381105e-13, 0.0, -2.220446049250313e-16, 0.0, 3.3084646133829665e-13, 0.0, 3.2374103398069565e-13, 4.1944225870338414e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 2.227107387398064e-13, 3.2596148002994596e-13, 3.423927807943983e-13, 2.220446049250313e-16, 4.1944225870338414e-13, 3.852473895449293e-13, 0.0, 4.2721381987576024e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.2521541843143495e-13, 4.2166270475263445e-13, 4.178879464689089e-13, 3.965716643961059e-13, 0.0, 2.220446049250313e-16, 1.312283615106935e-13], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1027, 1026, 1026, 1027, 1026, 2050, 2050, 2050, 1024, 1023, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 1024, 2050, 2050, 2050, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 2048, 1024, 1024, 1024, 2047, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 1024, 2048, 1024], "policy_default_policy_reward": [46.0, -46.0, 644.0, -644.0, 565.0, -565.0, -761.0, 761.0, -726.0, 726.0, -850.0, 850.0, -788.0, 788.0, 857.7205255792884, -737.5123727775738, -120.20815280171344, 483.0, -483.0, -214.0, 214.0, -289.0, 289.0, 344.36100243785023, -695.0859659063806, 350.7249634685297, -1316.0, 1316.0, -655.761811921523, -347.761811921513, -1429.3223166441626, 2432.845940487173, 655.0, -655.0, 329.0, -329.0, -1541.8812264734613, 2688.498861084164, -482.3088173053092, -664.3088173053155, -1241.0956056608634, 1573.6493607140812, -1607.095605660842, 1274.5418506076828, 1958.6857838867506, -646.2955980045097, -1312.390185882196, -654.419887294617, 2410.155341563976, -963.315566974707, -792.4198872946238, -383.0, 383.0, 0.0, 0.0, 1726.7547596575623, -2095.864499436885, 369.1097397793801, -848.6596702664101, -310.6596702663877, -737.808418582006, 1897.1277591147282, 715.0, -715.0, -1080.4591616530442, 2018.7898602876076, -938.330698634556, 0.0, 0.0, -929.6775269347748, 2994.2820895569203, -1162.9270356873672, -901.6775269347735, -1837.7705243037567, 43.840620433565824, 1793.9299038702848, -735.3910524340142, 421.7802666341059, 313.61078579990703, 1781.358613752328, 149.9162987847017, -699.5537550532263, -1231.7211574838293, -1066.28304342461, -826.105331441726, 1940.3913509776476, -48.00297611141942, 1850.3447443171779, -969.4339704049556, -261.4768035073657, -619.4339704049395, 755.0, -755.0, 354.0, -354.0, -209.30360723121913, 817.4154390516549, -608.1118318204345, 1409.9085952475168, -282.88239401646234, -921.4702675131427, -205.55593371797937, 1217.6378772032128, 50.91168824543138, -1268.5495654486751, 834.0, -834.0, 103.0, -103.0, 195.8685783886746, -962.3723291948977, 766.503750806223, 3153.260270728387, -853.4510296266673, -1089.8601925551536, -1209.9490485465792, 78.0, -78.0, -733.269732090455, -1619.9816356982965, 2353.251367788782, 302.0, -302.0, 1668.4038391946892, -218.3768405169832, -384.37684051698955, -1065.6501581607577, -819.0, 819.0, 1704.834449440779, -1455.9328624630425, -248.90158697766614, 0.0, 0.0, -1289.7627688842292, 48.33095244168749, 1241.4318164425897, 1828.5781361484014, 36.062445840513746, -1864.6405819888873, -1284.0765814495824, -563.4442799572253, 2678.855666268037, -831.334804861221, 36.05314265470375, -1202.3006864177516, -1139.9468573452843, 2306.1944011083233, -809.6372644586028, 218.9247481060251, 590.7125163525777, -1277.7419536040597, 1836.356310741478, -558.6143571373764, 2119.9061299972736, -968.7362902255772, -1151.169839771687, 91.2183664205358, -1036.9181073532047, -924.9181073532019, 1870.6178482857472, 1477.8531726799474, -972.27182413151, -505.5813485483843, -1160.3622279271112, -1260.0642840743992, 2420.4265120015107, -206.0, 206.0, 2465.6813459974433, -877.5195154525119, -1588.1618305449067, -815.7574545920305, -1111.4377439629832, 2846.952653147034, -919.7574545920354, -269.0, 269.0, -607.0, 607.0, -299.8132752230986, 1653.922761195346, -1354.1094859721957, 2356.7869016947334, -910.0464273870933, -1446.7404743076204, -8.485281374239214, -1393.7074657186363, 1402.1927470929327, -1702.0060223159235, -384.66608896548433, 2086.6721112815117, 0.0, 0.0, -1439.990701569483, -141.03709455483204, 225.0533563298926, 1355.974439794445, 648.4169183480686, -43.13351365237934, -605.2834046956883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.07000819370107, "mean_inference_ms": 4.62888704113904, "mean_action_processing_ms": 0.919159419982741, "mean_env_wait_ms": 20.780649625371233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018809211086219465, "StateBufferConnector_ms": 0.014066024565360916, "ViewRequirementAgentConnector_ms": 0.5534608599165796}, "num_episodes": 15, "episode_return_max": 4.3298697960381105e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.207218988311774e-13, "episodes_this_iter": 15}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 40, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 406404, "num_agent_steps_trained": 247445, "num_env_steps_sampled": 132608, "num_env_steps_trained": 247445, "num_env_steps_sampled_this_iter": 30208, "num_env_steps_trained_this_iter": 52128, "num_env_steps_sampled_throughput_per_sec": 1434.6874138447808, "num_env_steps_trained_throughput_per_sec": 2475.7476664757924, "timesteps_total": 132608, "num_env_steps_sampled_lifetime": 132608, "num_agent_steps_sampled_lifetime": 406404, "num_steps_trained_this_iter": 52128, "agent_timesteps_total": 406404, "timers": {"training_iteration_time_ms": 11842.679, "restore_workers_time_ms": 1896.015, "training_step_time_ms": 209.626, "sample_time_ms": 3.13, "synch_weights_time_ms": 7.605}, "counters": {"num_env_steps_sampled": 132608, "num_env_steps_trained": 247445, "num_agent_steps_sampled": 406404, "num_agent_steps_trained": 247445, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_samples_added_to_queue": 86016, "num_times_learner_queue_full": 11, "num_weight_broadcasts": 6, "total_num_restored_workers": 3}, "done": false, "training_iteration": 6, "trial_id": "de35c_00000", "date": "2024-09-02_13-05-17", "timestamp": 1725249917, "time_this_iter_s": 50.85705304145813, "time_total_s": 283.40817737579346, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 283.40817737579346, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 48.354166666666664, "ram_util_percent": 63.48333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 29573.03515625, "policy_loss": 6939.43505859375, "entropy": 12.426398277282715, "entropy_coeff": 0.01, "var_gnorm": 2048.5341796875, "vf_loss": 46271.5, "vf_explained_var": -0.007292032241821289}, "model": {}, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 153088, "num_env_steps_trained": 313611, "num_agent_steps_sampled": 469566, "num_agent_steps_trained": 313611, "num_training_step_calls_since_last_synch_worker_weights": 45525, "num_samples_added_to_queue": 102400, "num_times_learner_queue_full": 12, "num_weight_broadcasts": 7, "total_num_restored_workers": 3, "learner_queue": {"size_count": 25, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 117.65, "learner_load_time_ms": 886.862, "learner_load_wait_time_ms": 9971.204, "learner_dequeue_time_ms": 70601.48}}, "env_runners": {"episode_reward_max": 4.3298697960381105e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.0852808550832936e-13, "episode_len_mean": 1618.1022727272727, "episode_media": {}, "episodes_timesteps_total": 142393, "policy_reward_min": {"default_policy": -2095.864499436885}, "policy_reward_max": {"default_policy": 3153.260270728387}, "policy_reward_mean": {"default_policy": 1.5637557125344814e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.6697754290362354e-13, 0.0, 0.0, 0.0, 4.2099657093785936e-13, 0.0, 3.3306690738754696e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.063416270128073e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.001243780749064e-13, 1.1102230246251565e-16, 0.0, 4.218847493575595e-13, 0.0, 2.220446049250313e-16, 3.801403636316536e-13, 3.11972669919669e-13, -2.220446049250313e-16, 1.1102230246251565e-16, 2.220446049250313e-16, 0.0, 0.0, 1.4921397450962104e-13, -3.3306690738754696e-16, 2.602362769721367e-13, 0.0, 0.0, 1.9828583219805296e-13, 3.1308289294429414e-14, 0.0, 4.3298697960381105e-13, 0.0, -2.220446049250313e-16, 0.0, 3.3084646133829665e-13, 0.0, 3.2374103398069565e-13, 4.1944225870338414e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 2.227107387398064e-13, 3.2596148002994596e-13, 3.423927807943983e-13, 2.220446049250313e-16, 4.1944225870338414e-13, 3.852473895449293e-13, 0.0, 4.2721381987576024e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.2521541843143495e-13, 4.2166270475263445e-13, 4.178879464689089e-13, 3.965716643961059e-13, 0.0, 2.220446049250313e-16, 1.312283615106935e-13, 2.220446049250313e-16, 0.0, 4.929390229335695e-14, -2.220446049250313e-16, 1.5920598173124745e-13, 3.341771304121721e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 1.1102230246251565e-16, 5.5289106626332796e-14, 0.0, 0.0, 2.8177460364986473e-13, 9.903189379656396e-14, 1.1102230246251565e-16], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1027, 1026, 1026, 1027, 1026, 2050, 2050, 2050, 1024, 1023, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 1024, 2050, 2050, 2050, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 2048, 1024, 1024, 1024, 2047, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1026, 2048, 1024, 2048, 5, 1024, 1024, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048], "policy_default_policy_reward": [46.0, -46.0, 644.0, -644.0, 565.0, -565.0, -761.0, 761.0, -726.0, 726.0, -850.0, 850.0, -788.0, 788.0, 857.7205255792884, -737.5123727775738, -120.20815280171344, 483.0, -483.0, -214.0, 214.0, -289.0, 289.0, 344.36100243785023, -695.0859659063806, 350.7249634685297, -1316.0, 1316.0, -655.761811921523, -347.761811921513, -1429.3223166441626, 2432.845940487173, 655.0, -655.0, 329.0, -329.0, -1541.8812264734613, 2688.498861084164, -482.3088173053092, -664.3088173053155, -1241.0956056608634, 1573.6493607140812, -1607.095605660842, 1274.5418506076828, 1958.6857838867506, -646.2955980045097, -1312.390185882196, -654.419887294617, 2410.155341563976, -963.315566974707, -792.4198872946238, -383.0, 383.0, 0.0, 0.0, 1726.7547596575623, -2095.864499436885, 369.1097397793801, -848.6596702664101, -310.6596702663877, -737.808418582006, 1897.1277591147282, 715.0, -715.0, -1080.4591616530442, 2018.7898602876076, -938.330698634556, 0.0, 0.0, -929.6775269347748, 2994.2820895569203, -1162.9270356873672, -901.6775269347735, -1837.7705243037567, 43.840620433565824, 1793.9299038702848, -735.3910524340142, 421.7802666341059, 313.61078579990703, 1781.358613752328, 149.9162987847017, -699.5537550532263, -1231.7211574838293, -1066.28304342461, -826.105331441726, 1940.3913509776476, -48.00297611141942, 1850.3447443171779, -969.4339704049556, -261.4768035073657, -619.4339704049395, 755.0, -755.0, 354.0, -354.0, -209.30360723121913, 817.4154390516549, -608.1118318204345, 1409.9085952475168, -282.88239401646234, -921.4702675131427, -205.55593371797937, 1217.6378772032128, 50.91168824543138, -1268.5495654486751, 834.0, -834.0, 103.0, -103.0, 195.8685783886746, -962.3723291948977, 766.503750806223, 3153.260270728387, -853.4510296266673, -1089.8601925551536, -1209.9490485465792, 78.0, -78.0, -733.269732090455, -1619.9816356982965, 2353.251367788782, 302.0, -302.0, 1668.4038391946892, -218.3768405169832, -384.37684051698955, -1065.6501581607577, -819.0, 819.0, 1704.834449440779, -1455.9328624630425, -248.90158697766614, 0.0, 0.0, -1289.7627688842292, 48.33095244168749, 1241.4318164425897, 1828.5781361484014, 36.062445840513746, -1864.6405819888873, -1284.0765814495824, -563.4442799572253, 2678.855666268037, -831.334804861221, 36.05314265470375, -1202.3006864177516, -1139.9468573452843, 2306.1944011083233, -809.6372644586028, 218.9247481060251, 590.7125163525777, -1277.7419536040597, 1836.356310741478, -558.6143571373764, 2119.9061299972736, -968.7362902255772, -1151.169839771687, 91.2183664205358, -1036.9181073532047, -924.9181073532019, 1870.6178482857472, 1477.8531726799474, -972.27182413151, -505.5813485483843, -1160.3622279271112, -1260.0642840743992, 2420.4265120015107, -206.0, 206.0, 2465.6813459974433, -877.5195154525119, -1588.1618305449067, -815.7574545920305, -1111.4377439629832, 2846.952653147034, -919.7574545920354, -269.0, 269.0, -607.0, 607.0, -299.8132752230986, 1653.922761195346, -1354.1094859721957, 2356.7869016947334, -910.0464273870933, -1446.7404743076204, -8.485281374239214, -1393.7074657186363, 1402.1927470929327, -1702.0060223159235, -384.66608896548433, 2086.6721112815117, 0.0, 0.0, -1439.990701569483, -141.03709455483204, 225.0533563298926, 1355.974439794445, 648.4169183480686, -43.13351365237934, -605.2834046956883, -1383.0172728968498, 273.35005551442396, -678.6499444855759, 1788.3171618679937, 0.0, 0.0, -275.7716446627545, 195.161471607488, 80.61017305526647, 2113.7836558231315, -782.2052944320931, -1124.2052944320899, -207.3730669589834, 160.5132393293468, -284.9640328181803, 124.45079348883223, -682.3580438449906, 885.297690045585, -202.93964620054018, 0.0, 0.0, 117.0, -117.0, -771.0, 771.0, -430.3139720814521, -545.1874377637384, -241.1636288725634, 1216.6650387177065, -1176.644205937957, -971.1075101064803, 1904.105545116852, 243.64617092749137, 326.2710480275773, -656.7631311424087, 1347.8927325229804, -1017.4006494081674, -52.0, 52.0, 0.0, 0.0, -1026.7190462828737, -1298.517423411457, 2325.2364696943323, -506.32218789440464, 556.0023074145168, -1009.2288896480632, 959.5487701279148, -898.1771282114548, 448.998618781858, 1146.4377439629475, -697.2592345334593]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.196878333175688, "mean_inference_ms": 4.619554763298026, "mean_action_processing_ms": 0.9190331200542733, "mean_env_wait_ms": 20.592367030644855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01808973875912753, "StateBufferConnector_ms": 0.014818798411976208, "ViewRequirementAgentConnector_ms": 0.5536139011383057}, "num_episodes": 17, "episode_return_max": 4.3298697960381105e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.0852808550832936e-13, "episodes_this_iter": 17}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 469566, "num_agent_steps_trained": 313611, "num_env_steps_sampled": 153088, "num_env_steps_trained": 313611, "num_env_steps_sampled_this_iter": 20480, "num_env_steps_trained_this_iter": 66166, "num_env_steps_sampled_throughput_per_sec": 2047.9789064672566, "num_env_steps_trained_throughput_per_sec": 6616.5318518219, "timesteps_total": 153088, "num_env_steps_sampled_lifetime": 153088, "num_agent_steps_sampled_lifetime": 469566, "num_steps_trained_this_iter": 66166, "agent_timesteps_total": 469566, "timers": {"training_iteration_time_ms": 11579.455, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.158, "sample_time_ms": 0.11, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 153088, "num_env_steps_trained": 313611, "num_agent_steps_sampled": 469566, "num_agent_steps_trained": 313611, "num_training_step_calls_since_last_synch_worker_weights": 45525, "num_samples_added_to_queue": 102400, "num_times_learner_queue_full": 12, "num_weight_broadcasts": 7, "total_num_restored_workers": 3}, "done": false, "training_iteration": 7, "trial_id": "de35c_00000", "date": "2024-09-02_13-06-13", "timestamp": 1725249973, "time_this_iter_s": 56.5726478099823, "time_total_s": 339.98082518577576, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 339.98082518577576, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 47.07530864197531, "ram_util_percent": 63.5716049382716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 27406.09765625, "policy_loss": 9156.9677734375, "entropy": 12.543455123901367, "entropy_coeff": 0.01, "var_gnorm": 2048.5341796875, "vf_loss": 37525.8203125, "vf_explained_var": -0.002881169319152832}, "model": {}, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 178688, "num_env_steps_trained": 361851, "num_agent_steps_sampled": 547065, "num_agent_steps_trained": 361851, "num_training_step_calls_since_last_synch_worker_weights": 50843, "num_samples_added_to_queue": 118784, "num_times_learner_queue_full": 14, "num_weight_broadcasts": 8, "total_num_restored_workers": 3, "learner_queue": {"size_count": 29, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 119.614, "learner_load_time_ms": 886.862, "learner_load_wait_time_ms": 10769.381, "learner_dequeue_time_ms": 70601.48}}, "env_runners": {"episode_reward_max": 4.3298697960381105e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.1306289238177669e-13, "episode_len_mean": 1628.48, "episode_media": {}, "episodes_timesteps_total": 162848, "policy_reward_min": {"default_policy": -2221.0223997069743}, "policy_reward_max": {"default_policy": 3153.260270728387}, "policy_reward_mean": {"default_policy": 3.4980565452804934e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 3.3306690738754696e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.063416270128073e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.001243780749064e-13, 1.1102230246251565e-16, 0.0, 4.218847493575595e-13, 0.0, 2.220446049250313e-16, 3.801403636316536e-13, 3.11972669919669e-13, -2.220446049250313e-16, 1.1102230246251565e-16, 2.220446049250313e-16, 0.0, 0.0, 1.4921397450962104e-13, -3.3306690738754696e-16, 2.602362769721367e-13, 0.0, 0.0, 1.9828583219805296e-13, 3.1308289294429414e-14, 0.0, 4.3298697960381105e-13, 0.0, -2.220446049250313e-16, 0.0, 3.3084646133829665e-13, 0.0, 3.2374103398069565e-13, 4.1944225870338414e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 2.227107387398064e-13, 3.2596148002994596e-13, 3.423927807943983e-13, 2.220446049250313e-16, 4.1944225870338414e-13, 3.852473895449293e-13, 0.0, 4.2721381987576024e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.2521541843143495e-13, 4.2166270475263445e-13, 4.178879464689089e-13, 3.965716643961059e-13, 0.0, 2.220446049250313e-16, 1.312283615106935e-13, 2.220446049250313e-16, 0.0, 4.929390229335695e-14, -2.220446049250313e-16, 1.5920598173124745e-13, 3.341771304121721e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 1.1102230246251565e-16, 5.5289106626332796e-14, 0.0, 0.0, 2.8177460364986473e-13, 9.903189379656396e-14, 1.1102230246251565e-16, 0.0, 4.0589753780295723e-13, 1.8074430840897548e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 3.914646384828302e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 3.0464519795714295e-13, 1.7719159473017498e-13, 1.1102230246251565e-16, 0.0, 1.1102230246251565e-16, -2.220446049250313e-16, 3.0375701953744283e-13, 2.220446049250313e-16, 0.0, 4.143352327901084e-13, 1.6497914145929826e-13, 0.0, 0.0], "episode_lengths": [2050, 2050, 1024, 1023, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 1024, 2050, 2050, 2050, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 2048, 1024, 1024, 1024, 2047, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1026, 2048, 1024, 2048, 5, 1024, 1024, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1025, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 1024, 1024, 1024], "policy_default_policy_reward": [-1316.0, 1316.0, -655.761811921523, -347.761811921513, -1429.3223166441626, 2432.845940487173, 655.0, -655.0, 329.0, -329.0, -1541.8812264734613, 2688.498861084164, -482.3088173053092, -664.3088173053155, -1241.0956056608634, 1573.6493607140812, -1607.095605660842, 1274.5418506076828, 1958.6857838867506, -646.2955980045097, -1312.390185882196, -654.419887294617, 2410.155341563976, -963.315566974707, -792.4198872946238, -383.0, 383.0, 0.0, 0.0, 1726.7547596575623, -2095.864499436885, 369.1097397793801, -848.6596702664101, -310.6596702663877, -737.808418582006, 1897.1277591147282, 715.0, -715.0, -1080.4591616530442, 2018.7898602876076, -938.330698634556, 0.0, 0.0, -929.6775269347748, 2994.2820895569203, -1162.9270356873672, -901.6775269347735, -1837.7705243037567, 43.840620433565824, 1793.9299038702848, -735.3910524340142, 421.7802666341059, 313.61078579990703, 1781.358613752328, 149.9162987847017, -699.5537550532263, -1231.7211574838293, -1066.28304342461, -826.105331441726, 1940.3913509776476, -48.00297611141942, 1850.3447443171779, -969.4339704049556, -261.4768035073657, -619.4339704049395, 755.0, -755.0, 354.0, -354.0, -209.30360723121913, 817.4154390516549, -608.1118318204345, 1409.9085952475168, -282.88239401646234, -921.4702675131427, -205.55593371797937, 1217.6378772032128, 50.91168824543138, -1268.5495654486751, 834.0, -834.0, 103.0, -103.0, 195.8685783886746, -962.3723291948977, 766.503750806223, 3153.260270728387, -853.4510296266673, -1089.8601925551536, -1209.9490485465792, 78.0, -78.0, -733.269732090455, -1619.9816356982965, 2353.251367788782, 302.0, -302.0, 1668.4038391946892, -218.3768405169832, -384.37684051698955, -1065.6501581607577, -819.0, 819.0, 1704.834449440779, -1455.9328624630425, -248.90158697766614, 0.0, 0.0, -1289.7627688842292, 48.33095244168749, 1241.4318164425897, 1828.5781361484014, 36.062445840513746, -1864.6405819888873, -1284.0765814495824, -563.4442799572253, 2678.855666268037, -831.334804861221, 36.05314265470375, -1202.3006864177516, -1139.9468573452843, 2306.1944011083233, -809.6372644586028, 218.9247481060251, 590.7125163525777, -1277.7419536040597, 1836.356310741478, -558.6143571373764, 2119.9061299972736, -968.7362902255772, -1151.169839771687, 91.2183664205358, -1036.9181073532047, -924.9181073532019, 1870.6178482857472, 1477.8531726799474, -972.27182413151, -505.5813485483843, -1160.3622279271112, -1260.0642840743992, 2420.4265120015107, -206.0, 206.0, 2465.6813459974433, -877.5195154525119, -1588.1618305449067, -815.7574545920305, -1111.4377439629832, 2846.952653147034, -919.7574545920354, -269.0, 269.0, -607.0, 607.0, -299.8132752230986, 1653.922761195346, -1354.1094859721957, 2356.7869016947334, -910.0464273870933, -1446.7404743076204, -8.485281374239214, -1393.7074657186363, 1402.1927470929327, -1702.0060223159235, -384.66608896548433, 2086.6721112815117, 0.0, 0.0, -1439.990701569483, -141.03709455483204, 225.0533563298926, 1355.974439794445, 648.4169183480686, -43.13351365237934, -605.2834046956883, -1383.0172728968498, 273.35005551442396, -678.6499444855759, 1788.3171618679937, 0.0, 0.0, -275.7716446627545, 195.161471607488, 80.61017305526647, 2113.7836558231315, -782.2052944320931, -1124.2052944320899, -207.3730669589834, 160.5132393293468, -284.9640328181803, 124.45079348883223, -682.3580438449906, 885.297690045585, -202.93964620054018, 0.0, 0.0, 117.0, -117.0, -771.0, 771.0, -430.3139720814521, -545.1874377637384, -241.1636288725634, 1216.6650387177065, -1176.644205937957, -971.1075101064803, 1904.105545116852, 243.64617092749137, 326.2710480275773, -656.7631311424087, 1347.8927325229804, -1017.4006494081674, -52.0, 52.0, 0.0, 0.0, -1026.7190462828737, -1298.517423411457, 2325.2364696943323, -506.32218789440464, 556.0023074145168, -1009.2288896480632, 959.5487701279148, -898.1771282114548, 448.998618781858, 1146.4377439629475, -697.2592345334593, -624.0, 624.0, 1786.1517292772328, -1618.5674221359236, -167.58430714121303, 450.42701961583333, -811.7585848021619, 361.331565186328, -788.0, 788.0, -758.0, 758.0, 78.0, -78.0, 835.8284539150795, 260.78758580221705, -576.0208327797698, -520.5952069375629, 139.0, -139.0, -2221.0223997069743, 1518.8653659887157, 702.1570337182467, -523.1075101064571, 1686.6354912789577, -294.4204710660881, -869.1075101064737, 2114.6083361801184, -1113.934369128253, -413.7344431475145, -586.9395239044028, -816.7083322704677, -55.154328932550655, 871.8626612030189, 744.5834405894399, -948.2301935711666, 203.6467529817267, -416.37684051699085, -186.37684051698352, 638.024606337794, -35.270925303824406, -620.0, 620.0, -366.64856326746343, -762.6485632674759, 2686.379660207324, -1557.0825336723078, 1317.661265159658, -12.553755053226027, -652.553755053239, -652.553755053239, -1409.2638149047375, 1492.702415084813, -83.4386001800127, -714.7211574838417, -439.90242934956643, -479.2391992003305, 1633.862786033683, -596.0, 596.0, 1030.2545801888073, -1831.406563273073, 801.1519830843747, 735.3910524340147, -713.470742217231, -21.92031021678348, 809.3790191817332, 809.3790191817332, -512.6209808182668, -1106.1370575452029, -439.0, 439.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.524784901110667, "mean_inference_ms": 4.6483897706447745, "mean_action_processing_ms": 0.9349848560862044, "mean_env_wait_ms": 20.218287981773518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01802206039428711, "StateBufferConnector_ms": 0.015014886856079102, "ViewRequirementAgentConnector_ms": 0.5689854621887207}, "num_episodes": 24, "episode_return_max": 4.3298697960381105e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.1306289238177669e-13, "episodes_this_iter": 24}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 547065, "num_agent_steps_trained": 361851, "num_env_steps_sampled": 178688, "num_env_steps_trained": 361851, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 48240, "num_env_steps_sampled_throughput_per_sec": 2559.9988403325565, "num_env_steps_trained_throughput_per_sec": 4823.997814751661, "timesteps_total": 178688, "num_env_steps_sampled_lifetime": 178688, "num_agent_steps_sampled_lifetime": 547065, "num_steps_trained_this_iter": 48240, "agent_timesteps_total": 547065, "timers": {"training_iteration_time_ms": 11382.025, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.149, "sample_time_ms": 0.105, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 178688, "num_env_steps_trained": 361851, "num_agent_steps_sampled": 547065, "num_agent_steps_trained": 361851, "num_training_step_calls_since_last_synch_worker_weights": 50843, "num_samples_added_to_queue": 118784, "num_times_learner_queue_full": 14, "num_weight_broadcasts": 8, "total_num_restored_workers": 3}, "done": false, "training_iteration": 8, "trial_id": "de35c_00000", "date": "2024-09-02_13-07-04", "timestamp": 1725250024, "time_this_iter_s": 50.8614559173584, "time_total_s": 390.84228110313416, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 390.84228110313416, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 55.71944444444444, "ram_util_percent": 62.92222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 3133.587890625, "policy_loss": -19090.109375, "entropy": 12.320650100708008, "entropy_coeff": 0.01, "var_gnorm": 2048.5341796875, "vf_loss": 45456.703125, "vf_explained_var": 0.059530019760131836}, "model": {}, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 204288, "num_env_steps_trained": 411003, "num_agent_steps_sampled": 625909, "num_agent_steps_trained": 411003, "num_training_step_calls_since_last_synch_worker_weights": 35312, "num_samples_added_to_queue": 135168, "num_times_learner_queue_full": 16, "num_weight_broadcasts": 9, "total_num_restored_workers": 3, "learner_queue": {"size_count": 33, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 143.939, "learner_load_time_ms": 1001.72, "learner_load_wait_time_ms": 11035.667, "learner_dequeue_time_ms": 77089.51}}, "env_runners": {"episode_reward_max": 4.3298697960381105e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.1707412816974738e-13, "episode_len_mean": 1618.15, "episode_media": {}, "episodes_timesteps_total": 161815, "policy_reward_min": {"default_policy": -2221.0223997069743}, "policy_reward_max": {"default_policy": 3153.260270728387}, "policy_reward_mean": {"default_policy": 8.37009805239012e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.063416270128073e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.001243780749064e-13, 1.1102230246251565e-16, 0.0, 4.218847493575595e-13, 0.0, 2.220446049250313e-16, 3.801403636316536e-13, 3.11972669919669e-13, -2.220446049250313e-16, 1.1102230246251565e-16, 2.220446049250313e-16, 0.0, 0.0, 1.4921397450962104e-13, -3.3306690738754696e-16, 2.602362769721367e-13, 0.0, 0.0, 1.9828583219805296e-13, 3.1308289294429414e-14, 0.0, 4.3298697960381105e-13, 0.0, -2.220446049250313e-16, 0.0, 3.3084646133829665e-13, 0.0, 3.2374103398069565e-13, 4.1944225870338414e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 2.227107387398064e-13, 3.2596148002994596e-13, 3.423927807943983e-13, 2.220446049250313e-16, 4.1944225870338414e-13, 3.852473895449293e-13, 0.0, 4.2721381987576024e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.2521541843143495e-13, 4.2166270475263445e-13, 4.178879464689089e-13, 3.965716643961059e-13, 0.0, 2.220446049250313e-16, 1.312283615106935e-13, 2.220446049250313e-16, 0.0, 4.929390229335695e-14, -2.220446049250313e-16, 1.5920598173124745e-13, 3.341771304121721e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 1.1102230246251565e-16, 5.5289106626332796e-14, 0.0, 0.0, 2.8177460364986473e-13, 9.903189379656396e-14, 1.1102230246251565e-16, 0.0, 4.0589753780295723e-13, 1.8074430840897548e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 3.914646384828302e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 3.0464519795714295e-13, 1.7719159473017498e-13, 1.1102230246251565e-16, 0.0, 1.1102230246251565e-16, -2.220446049250313e-16, 3.0375701953744283e-13, 2.220446049250313e-16, 0.0, 4.143352327901084e-13, 1.6497914145929826e-13, 0.0, 0.0, 4.014566457044566e-13, 0.0, 0.0], "episode_lengths": [1023, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 1024, 2050, 2050, 2050, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 2048, 1024, 1024, 1024, 2047, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1026, 2048, 1024, 2048, 5, 1024, 1024, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1025, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 2043, 1024, 1024], "policy_default_policy_reward": [329.0, -329.0, -1541.8812264734613, 2688.498861084164, -482.3088173053092, -664.3088173053155, -1241.0956056608634, 1573.6493607140812, -1607.095605660842, 1274.5418506076828, 1958.6857838867506, -646.2955980045097, -1312.390185882196, -654.419887294617, 2410.155341563976, -963.315566974707, -792.4198872946238, -383.0, 383.0, 0.0, 0.0, 1726.7547596575623, -2095.864499436885, 369.1097397793801, -848.6596702664101, -310.6596702663877, -737.808418582006, 1897.1277591147282, 715.0, -715.0, -1080.4591616530442, 2018.7898602876076, -938.330698634556, 0.0, 0.0, -929.6775269347748, 2994.2820895569203, -1162.9270356873672, -901.6775269347735, -1837.7705243037567, 43.840620433565824, 1793.9299038702848, -735.3910524340142, 421.7802666341059, 313.61078579990703, 1781.358613752328, 149.9162987847017, -699.5537550532263, -1231.7211574838293, -1066.28304342461, -826.105331441726, 1940.3913509776476, -48.00297611141942, 1850.3447443171779, -969.4339704049556, -261.4768035073657, -619.4339704049395, 755.0, -755.0, 354.0, -354.0, -209.30360723121913, 817.4154390516549, -608.1118318204345, 1409.9085952475168, -282.88239401646234, -921.4702675131427, -205.55593371797937, 1217.6378772032128, 50.91168824543138, -1268.5495654486751, 834.0, -834.0, 103.0, -103.0, 195.8685783886746, -962.3723291948977, 766.503750806223, 3153.260270728387, -853.4510296266673, -1089.8601925551536, -1209.9490485465792, 78.0, -78.0, -733.269732090455, -1619.9816356982965, 2353.251367788782, 302.0, -302.0, 1668.4038391946892, -218.3768405169832, -384.37684051698955, -1065.6501581607577, -819.0, 819.0, 1704.834449440779, -1455.9328624630425, -248.90158697766614, 0.0, 0.0, -1289.7627688842292, 48.33095244168749, 1241.4318164425897, 1828.5781361484014, 36.062445840513746, -1864.6405819888873, -1284.0765814495824, -563.4442799572253, 2678.855666268037, -831.334804861221, 36.05314265470375, -1202.3006864177516, -1139.9468573452843, 2306.1944011083233, -809.6372644586028, 218.9247481060251, 590.7125163525777, -1277.7419536040597, 1836.356310741478, -558.6143571373764, 2119.9061299972736, -968.7362902255772, -1151.169839771687, 91.2183664205358, -1036.9181073532047, -924.9181073532019, 1870.6178482857472, 1477.8531726799474, -972.27182413151, -505.5813485483843, -1160.3622279271112, -1260.0642840743992, 2420.4265120015107, -206.0, 206.0, 2465.6813459974433, -877.5195154525119, -1588.1618305449067, -815.7574545920305, -1111.4377439629832, 2846.952653147034, -919.7574545920354, -269.0, 269.0, -607.0, 607.0, -299.8132752230986, 1653.922761195346, -1354.1094859721957, 2356.7869016947334, -910.0464273870933, -1446.7404743076204, -8.485281374239214, -1393.7074657186363, 1402.1927470929327, -1702.0060223159235, -384.66608896548433, 2086.6721112815117, 0.0, 0.0, -1439.990701569483, -141.03709455483204, 225.0533563298926, 1355.974439794445, 648.4169183480686, -43.13351365237934, -605.2834046956883, -1383.0172728968498, 273.35005551442396, -678.6499444855759, 1788.3171618679937, 0.0, 0.0, -275.7716446627545, 195.161471607488, 80.61017305526647, 2113.7836558231315, -782.2052944320931, -1124.2052944320899, -207.3730669589834, 160.5132393293468, -284.9640328181803, 124.45079348883223, -682.3580438449906, 885.297690045585, -202.93964620054018, 0.0, 0.0, 117.0, -117.0, -771.0, 771.0, -430.3139720814521, -545.1874377637384, -241.1636288725634, 1216.6650387177065, -1176.644205937957, -971.1075101064803, 1904.105545116852, 243.64617092749137, 326.2710480275773, -656.7631311424087, 1347.8927325229804, -1017.4006494081674, -52.0, 52.0, 0.0, 0.0, -1026.7190462828737, -1298.517423411457, 2325.2364696943323, -506.32218789440464, 556.0023074145168, -1009.2288896480632, 959.5487701279148, -898.1771282114548, 448.998618781858, 1146.4377439629475, -697.2592345334593, -624.0, 624.0, 1786.1517292772328, -1618.5674221359236, -167.58430714121303, 450.42701961583333, -811.7585848021619, 361.331565186328, -788.0, 788.0, -758.0, 758.0, 78.0, -78.0, 835.8284539150795, 260.78758580221705, -576.0208327797698, -520.5952069375629, 139.0, -139.0, -2221.0223997069743, 1518.8653659887157, 702.1570337182467, -523.1075101064571, 1686.6354912789577, -294.4204710660881, -869.1075101064737, 2114.6083361801184, -1113.934369128253, -413.7344431475145, -586.9395239044028, -816.7083322704677, -55.154328932550655, 871.8626612030189, 744.5834405894399, -948.2301935711666, 203.6467529817267, -416.37684051699085, -186.37684051698352, 638.024606337794, -35.270925303824406, -620.0, 620.0, -366.64856326746343, -762.6485632674759, 2686.379660207324, -1557.0825336723078, 1317.661265159658, -12.553755053226027, -652.553755053239, -652.553755053239, -1409.2638149047375, 1492.702415084813, -83.4386001800127, -714.7211574838417, -439.90242934956643, -479.2391992003305, 1633.862786033683, -596.0, 596.0, 1030.2545801888073, -1831.406563273073, 801.1519830843747, 735.3910524340147, -713.470742217231, -21.92031021678348, 809.3790191817332, 809.3790191817332, -512.6209808182668, -1106.1370575452029, -439.0, 439.0, 1983.434521228281, -131.52186130069836, -1851.9126599274682, -842.0, 842.0, 310.0, -310.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.571892514333316, "mean_inference_ms": 4.648828371233204, "mean_action_processing_ms": 0.937120985161253, "mean_env_wait_ms": 20.18378622461029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017729520797729492, "StateBufferConnector_ms": 0.015038251876831055, "ViewRequirementAgentConnector_ms": 0.5705149173736572}, "num_episodes": 3, "episode_return_max": 4.3298697960381105e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.1707412816974738e-13, "episodes_this_iter": 3}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 625909, "num_agent_steps_trained": 411003, "num_env_steps_sampled": 204288, "num_env_steps_trained": 411003, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 49152, "num_env_steps_sampled_throughput_per_sec": 2559.971618966989, "num_env_steps_trained_throughput_per_sec": 4915.145508416619, "timesteps_total": 204288, "num_env_steps_sampled_lifetime": 204288, "num_agent_steps_sampled_lifetime": 625909, "num_steps_trained_this_iter": 49152, "agent_timesteps_total": 625909, "timers": {"training_iteration_time_ms": 11228.48, "restore_workers_time_ms": 0.008, "training_step_time_ms": 0.189, "sample_time_ms": 0.129, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 204288, "num_env_steps_trained": 411003, "num_agent_steps_sampled": 625909, "num_agent_steps_trained": 411003, "num_training_step_calls_since_last_synch_worker_weights": 35312, "num_samples_added_to_queue": 135168, "num_times_learner_queue_full": 16, "num_weight_broadcasts": 9, "total_num_restored_workers": 3}, "done": false, "training_iteration": 9, "trial_id": "de35c_00000", "date": "2024-09-02_13-07-49", "timestamp": 1725250069, "time_this_iter_s": 44.951842308044434, "time_total_s": 435.7941234111786, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 435.7941234111786, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 51.3046875, "ram_util_percent": 64.528125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 118007.53125, "policy_loss": 64168.98828125, "entropy": 12.671195030212402, "entropy_coeff": 0.01, "var_gnorm": 2048.534423828125, "vf_loss": 108715.109375, "vf_explained_var": 0.025762200355529785}, "model": {}, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 229888, "num_env_steps_trained": 462264, "num_agent_steps_sampled": 704057, "num_agent_steps_trained": 462264, "num_training_step_calls_since_last_synch_worker_weights": 51030, "num_samples_added_to_queue": 151552, "num_times_learner_queue_full": 19, "num_weight_broadcasts": 10, "total_num_restored_workers": 3, "learner_queue": {"size_count": 37, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 141.03, "learner_load_time_ms": 1001.72, "learner_load_wait_time_ms": 9609.811, "learner_dequeue_time_ms": 77089.51}}, "env_runners": {"episode_reward_max": 4.3298697960381105e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 1.5189738356014005e-13, "episode_len_mean": 1658.89, "episode_media": {}, "episodes_timesteps_total": 165889, "policy_reward_min": {"default_policy": -2221.0223997069743}, "policy_reward_max": {"default_policy": 3166.8179879418017}, "policy_reward_mean": {"default_policy": 2.4969279709627172e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 1.9828583219805296e-13, 3.1308289294429414e-14, 0.0, 4.3298697960381105e-13, 0.0, -2.220446049250313e-16, 0.0, 3.3084646133829665e-13, 0.0, 3.2374103398069565e-13, 4.1944225870338414e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 2.227107387398064e-13, 3.2596148002994596e-13, 3.423927807943983e-13, 2.220446049250313e-16, 4.1944225870338414e-13, 3.852473895449293e-13, 0.0, 4.2721381987576024e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.2521541843143495e-13, 4.2166270475263445e-13, 4.178879464689089e-13, 3.965716643961059e-13, 0.0, 2.220446049250313e-16, 1.312283615106935e-13, 2.220446049250313e-16, 0.0, 4.929390229335695e-14, -2.220446049250313e-16, 1.5920598173124745e-13, 3.341771304121721e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 1.1102230246251565e-16, 5.5289106626332796e-14, 0.0, 0.0, 2.8177460364986473e-13, 9.903189379656396e-14, 1.1102230246251565e-16, 0.0, 4.0589753780295723e-13, 1.8074430840897548e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 3.914646384828302e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 3.0464519795714295e-13, 1.7719159473017498e-13, 1.1102230246251565e-16, 0.0, 1.1102230246251565e-16, -2.220446049250313e-16, 3.0375701953744283e-13, 2.220446049250313e-16, 0.0, 4.143352327901084e-13, 1.6497914145929826e-13, 0.0, 0.0, 4.014566457044566e-13, 0.0, 0.0, 6.661338147750939e-16, 3.672617765460018e-13, 3.774758283725532e-13, 3.3151259515307174e-13, 2.617905892066119e-13, 3.865796571744795e-13, 3.8413716652030416e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 4.1255887595070817e-13, 4.2454928461665986e-13, 4.1522341120980855e-13, 3.141931159689193e-13, 3.566036355096003e-13, 9.969802761133906e-14, 4.2654768606098514e-13, 2.220446049250313e-16, 3.921307722976053e-13, 2.7067237340361316e-13, 2.220446049250313e-16, 3.5793590313915047e-13, 2.3225865675158275e-13], "episode_lengths": [1024, 1024, 2047, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1026, 2048, 1024, 2048, 5, 1024, 1024, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1025, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 2043, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2047, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048], "policy_default_policy_reward": [103.0, -103.0, 195.8685783886746, -962.3723291948977, 766.503750806223, 3153.260270728387, -853.4510296266673, -1089.8601925551536, -1209.9490485465792, 78.0, -78.0, -733.269732090455, -1619.9816356982965, 2353.251367788782, 302.0, -302.0, 1668.4038391946892, -218.3768405169832, -384.37684051698955, -1065.6501581607577, -819.0, 819.0, 1704.834449440779, -1455.9328624630425, -248.90158697766614, 0.0, 0.0, -1289.7627688842292, 48.33095244168749, 1241.4318164425897, 1828.5781361484014, 36.062445840513746, -1864.6405819888873, -1284.0765814495824, -563.4442799572253, 2678.855666268037, -831.334804861221, 36.05314265470375, -1202.3006864177516, -1139.9468573452843, 2306.1944011083233, -809.6372644586028, 218.9247481060251, 590.7125163525777, -1277.7419536040597, 1836.356310741478, -558.6143571373764, 2119.9061299972736, -968.7362902255772, -1151.169839771687, 91.2183664205358, -1036.9181073532047, -924.9181073532019, 1870.6178482857472, 1477.8531726799474, -972.27182413151, -505.5813485483843, -1160.3622279271112, -1260.0642840743992, 2420.4265120015107, -206.0, 206.0, 2465.6813459974433, -877.5195154525119, -1588.1618305449067, -815.7574545920305, -1111.4377439629832, 2846.952653147034, -919.7574545920354, -269.0, 269.0, -607.0, 607.0, -299.8132752230986, 1653.922761195346, -1354.1094859721957, 2356.7869016947334, -910.0464273870933, -1446.7404743076204, -8.485281374239214, -1393.7074657186363, 1402.1927470929327, -1702.0060223159235, -384.66608896548433, 2086.6721112815117, 0.0, 0.0, -1439.990701569483, -141.03709455483204, 225.0533563298926, 1355.974439794445, 648.4169183480686, -43.13351365237934, -605.2834046956883, -1383.0172728968498, 273.35005551442396, -678.6499444855759, 1788.3171618679937, 0.0, 0.0, -275.7716446627545, 195.161471607488, 80.61017305526647, 2113.7836558231315, -782.2052944320931, -1124.2052944320899, -207.3730669589834, 160.5132393293468, -284.9640328181803, 124.45079348883223, -682.3580438449906, 885.297690045585, -202.93964620054018, 0.0, 0.0, 117.0, -117.0, -771.0, 771.0, -430.3139720814521, -545.1874377637384, -241.1636288725634, 1216.6650387177065, -1176.644205937957, -971.1075101064803, 1904.105545116852, 243.64617092749137, 326.2710480275773, -656.7631311424087, 1347.8927325229804, -1017.4006494081674, -52.0, 52.0, 0.0, 0.0, -1026.7190462828737, -1298.517423411457, 2325.2364696943323, -506.32218789440464, 556.0023074145168, -1009.2288896480632, 959.5487701279148, -898.1771282114548, 448.998618781858, 1146.4377439629475, -697.2592345334593, -624.0, 624.0, 1786.1517292772328, -1618.5674221359236, -167.58430714121303, 450.42701961583333, -811.7585848021619, 361.331565186328, -788.0, 788.0, -758.0, 758.0, 78.0, -78.0, 835.8284539150795, 260.78758580221705, -576.0208327797698, -520.5952069375629, 139.0, -139.0, -2221.0223997069743, 1518.8653659887157, 702.1570337182467, -523.1075101064571, 1686.6354912789577, -294.4204710660881, -869.1075101064737, 2114.6083361801184, -1113.934369128253, -413.7344431475145, -586.9395239044028, -816.7083322704677, -55.154328932550655, 871.8626612030189, 744.5834405894399, -948.2301935711666, 203.6467529817267, -416.37684051699085, -186.37684051698352, 638.024606337794, -35.270925303824406, -620.0, 620.0, -366.64856326746343, -762.6485632674759, 2686.379660207324, -1557.0825336723078, 1317.661265159658, -12.553755053226027, -652.553755053239, -652.553755053239, -1409.2638149047375, 1492.702415084813, -83.4386001800127, -714.7211574838417, -439.90242934956643, -479.2391992003305, 1633.862786033683, -596.0, 596.0, 1030.2545801888073, -1831.406563273073, 801.1519830843747, 735.3910524340147, -713.470742217231, -21.92031021678348, 809.3790191817332, 809.3790191817332, -512.6209808182668, -1106.1370575452029, -439.0, 439.0, 1983.434521228281, -131.52186130069836, -1851.9126599274682, -842.0, 842.0, 310.0, -310.0, 1225.2142227662316, -710.2177826491057, -190.9341554530627, -324.0622846640813, -914.9961748553992, -318.90515831513517, 1233.901333170534, -1729.5831867821994, 1876.6613972691116, -147.07821048680253, -1575.433908483566, 1905.697364450923, -330.2634559672906, 939.7449121969286, -1561.2917728598911, 621.5468606629796, 2356.079794913545, -1018.9408716898225, -1337.1389232237207, -1479.9744930233815, 2189.909701334732, -709.9352083112988, -1089.0, 1089.0, 2068.0922594531744, -1009.231865759453, -1314.072807891529, 255.21241419776067, 265.0, -265.0, -131.0, 131.0, -93.3380951166244, 1646.1445866022877, -1552.806491485613, -871.1555544218329, -345.0681092190374, 1216.2236636408702, -1343.5028842543998, 482.95393155041415, 860.5489527040338, -1081.873375215416, -1178.9215357060648, 2260.7949109214906, -1170.9688296449078, 1996.1624432896385, -825.1936136447072, 1276.0263075561734, 417.4174368195804, -799.1866885070979, -894.2570558687125, 193.04015126392835, 1546.4425304549911, -1739.4826817188048, -1240.7774899251192, 3166.8179879418017, -773.0202490083162, -1153.020249008309, -1751.5034969990666, 1248.0434687942386, 503.4600282048253, -802.5661966467372, -891.6616510762431, 1694.2278477229802, 2306.526016182947, -766.1554979850454, 366.62911170578104, -1906.9996299036432, -1231.7800128269498, -154.1492782986678, 1385.929291125618, -1122.8855685242295, 1904.0155108391568, -781.1299423149112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.97124387930853, "mean_inference_ms": 4.663511260449565, "mean_action_processing_ms": 0.9446037206511138, "mean_env_wait_ms": 19.90010450200288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016105175018310547, "StateBufferConnector_ms": 0.014798879623413086, "ViewRequirementAgentConnector_ms": 0.5678906440734863}, "num_episodes": 24, "episode_return_max": 4.3298697960381105e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 1.5189738356014005e-13, "episodes_this_iter": 24}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 704057, "num_agent_steps_trained": 462264, "num_env_steps_sampled": 229888, "num_env_steps_trained": 462264, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 51261, "num_env_steps_sampled_throughput_per_sec": 2559.9691776171994, "num_env_steps_trained_throughput_per_sec": 5126.03828179044, "timesteps_total": 229888, "num_env_steps_sampled_lifetime": 229888, "num_agent_steps_sampled_lifetime": 704057, "num_steps_trained_this_iter": 51261, "agent_timesteps_total": 704057, "timers": {"training_iteration_time_ms": 11105.645, "restore_workers_time_ms": 0.005, "training_step_time_ms": 0.132, "sample_time_ms": 0.096, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 229888, "num_env_steps_trained": 462264, "num_agent_steps_sampled": 704057, "num_agent_steps_trained": 462264, "num_training_step_calls_since_last_synch_worker_weights": 51030, "num_samples_added_to_queue": 151552, "num_times_learner_queue_full": 19, "num_weight_broadcasts": 10, "total_num_restored_workers": 3}, "done": false, "training_iteration": 10, "trial_id": "de35c_00000", "date": "2024-09-02_13-08-39", "timestamp": 1725250119, "time_this_iter_s": 50.28408193588257, "time_total_s": 486.07820534706116, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 486.07820534706116, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 54.60704225352113, "ram_util_percent": 63.09577464788734}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 37429.015625, "policy_loss": -4808.67529296875, "entropy": 12.458650588989258, "entropy_coeff": 0.01, "var_gnorm": 2048.534423828125, "vf_loss": 85495.9921875, "vf_explained_var": 0.022691428661346436}, "model": {}, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 255488, "num_env_steps_trained": 515095, "num_agent_steps_sampled": 787801, "num_agent_steps_trained": 515095, "num_training_step_calls_since_last_synch_worker_weights": 35882, "num_samples_added_to_queue": 167936, "num_times_learner_queue_full": 21, "num_weight_broadcasts": 11, "total_num_restored_workers": 3, "learner_queue": {"size_count": 41, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 151.456, "learner_load_time_ms": 1084.633, "learner_load_wait_time_ms": 9757.788, "learner_dequeue_time_ms": 79089.049}}, "env_runners": {"episode_reward_max": 4.3298697960381105e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 1.503031032967783e-13, "episode_len_mean": 1658.9, "episode_media": {}, "episodes_timesteps_total": 165890, "policy_reward_min": {"default_policy": -2221.0223997069743}, "policy_reward_max": {"default_policy": 3166.8179879418017}, "policy_reward_mean": {"default_policy": 2.1012990005726882e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.3298697960381105e-13, 0.0, -2.220446049250313e-16, 0.0, 3.3084646133829665e-13, 0.0, 3.2374103398069565e-13, 4.1944225870338414e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 2.227107387398064e-13, 3.2596148002994596e-13, 3.423927807943983e-13, 2.220446049250313e-16, 4.1944225870338414e-13, 3.852473895449293e-13, 0.0, 4.2721381987576024e-13, 1.1102230246251565e-16, 0.0, 0.0, 4.2521541843143495e-13, 4.2166270475263445e-13, 4.178879464689089e-13, 3.965716643961059e-13, 0.0, 2.220446049250313e-16, 1.312283615106935e-13, 2.220446049250313e-16, 0.0, 4.929390229335695e-14, -2.220446049250313e-16, 1.5920598173124745e-13, 3.341771304121721e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 1.1102230246251565e-16, 5.5289106626332796e-14, 0.0, 0.0, 2.8177460364986473e-13, 9.903189379656396e-14, 1.1102230246251565e-16, 0.0, 4.0589753780295723e-13, 1.8074430840897548e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 3.914646384828302e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 3.0464519795714295e-13, 1.7719159473017498e-13, 1.1102230246251565e-16, 0.0, 1.1102230246251565e-16, -2.220446049250313e-16, 3.0375701953744283e-13, 2.220446049250313e-16, 0.0, 4.143352327901084e-13, 1.6497914145929826e-13, 0.0, 0.0, 4.014566457044566e-13, 0.0, 0.0, 6.661338147750939e-16, 3.672617765460018e-13, 3.774758283725532e-13, 3.3151259515307174e-13, 2.617905892066119e-13, 3.865796571744795e-13, 3.8413716652030416e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 4.1255887595070817e-13, 4.2454928461665986e-13, 4.1522341120980855e-13, 3.141931159689193e-13, 3.566036355096003e-13, 9.969802761133906e-14, 4.2654768606098514e-13, 2.220446049250313e-16, 3.921307722976053e-13, 2.7067237340361316e-13, 2.220446049250313e-16, 3.5793590313915047e-13, 2.3225865675158275e-13, 0.0, 7.016609515630989e-14, 0.0, 0.0], "episode_lengths": [2048, 1024, 2048, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1026, 2048, 1024, 2048, 5, 1024, 1024, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1025, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 2043, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2047, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 1024], "policy_default_policy_reward": [-733.269732090455, -1619.9816356982965, 2353.251367788782, 302.0, -302.0, 1668.4038391946892, -218.3768405169832, -384.37684051698955, -1065.6501581607577, -819.0, 819.0, 1704.834449440779, -1455.9328624630425, -248.90158697766614, 0.0, 0.0, -1289.7627688842292, 48.33095244168749, 1241.4318164425897, 1828.5781361484014, 36.062445840513746, -1864.6405819888873, -1284.0765814495824, -563.4442799572253, 2678.855666268037, -831.334804861221, 36.05314265470375, -1202.3006864177516, -1139.9468573452843, 2306.1944011083233, -809.6372644586028, 218.9247481060251, 590.7125163525777, -1277.7419536040597, 1836.356310741478, -558.6143571373764, 2119.9061299972736, -968.7362902255772, -1151.169839771687, 91.2183664205358, -1036.9181073532047, -924.9181073532019, 1870.6178482857472, 1477.8531726799474, -972.27182413151, -505.5813485483843, -1160.3622279271112, -1260.0642840743992, 2420.4265120015107, -206.0, 206.0, 2465.6813459974433, -877.5195154525119, -1588.1618305449067, -815.7574545920305, -1111.4377439629832, 2846.952653147034, -919.7574545920354, -269.0, 269.0, -607.0, 607.0, -299.8132752230986, 1653.922761195346, -1354.1094859721957, 2356.7869016947334, -910.0464273870933, -1446.7404743076204, -8.485281374239214, -1393.7074657186363, 1402.1927470929327, -1702.0060223159235, -384.66608896548433, 2086.6721112815117, 0.0, 0.0, -1439.990701569483, -141.03709455483204, 225.0533563298926, 1355.974439794445, 648.4169183480686, -43.13351365237934, -605.2834046956883, -1383.0172728968498, 273.35005551442396, -678.6499444855759, 1788.3171618679937, 0.0, 0.0, -275.7716446627545, 195.161471607488, 80.61017305526647, 2113.7836558231315, -782.2052944320931, -1124.2052944320899, -207.3730669589834, 160.5132393293468, -284.9640328181803, 124.45079348883223, -682.3580438449906, 885.297690045585, -202.93964620054018, 0.0, 0.0, 117.0, -117.0, -771.0, 771.0, -430.3139720814521, -545.1874377637384, -241.1636288725634, 1216.6650387177065, -1176.644205937957, -971.1075101064803, 1904.105545116852, 243.64617092749137, 326.2710480275773, -656.7631311424087, 1347.8927325229804, -1017.4006494081674, -52.0, 52.0, 0.0, 0.0, -1026.7190462828737, -1298.517423411457, 2325.2364696943323, -506.32218789440464, 556.0023074145168, -1009.2288896480632, 959.5487701279148, -898.1771282114548, 448.998618781858, 1146.4377439629475, -697.2592345334593, -624.0, 624.0, 1786.1517292772328, -1618.5674221359236, -167.58430714121303, 450.42701961583333, -811.7585848021619, 361.331565186328, -788.0, 788.0, -758.0, 758.0, 78.0, -78.0, 835.8284539150795, 260.78758580221705, -576.0208327797698, -520.5952069375629, 139.0, -139.0, -2221.0223997069743, 1518.8653659887157, 702.1570337182467, -523.1075101064571, 1686.6354912789577, -294.4204710660881, -869.1075101064737, 2114.6083361801184, -1113.934369128253, -413.7344431475145, -586.9395239044028, -816.7083322704677, -55.154328932550655, 871.8626612030189, 744.5834405894399, -948.2301935711666, 203.6467529817267, -416.37684051699085, -186.37684051698352, 638.024606337794, -35.270925303824406, -620.0, 620.0, -366.64856326746343, -762.6485632674759, 2686.379660207324, -1557.0825336723078, 1317.661265159658, -12.553755053226027, -652.553755053239, -652.553755053239, -1409.2638149047375, 1492.702415084813, -83.4386001800127, -714.7211574838417, -439.90242934956643, -479.2391992003305, 1633.862786033683, -596.0, 596.0, 1030.2545801888073, -1831.406563273073, 801.1519830843747, 735.3910524340147, -713.470742217231, -21.92031021678348, 809.3790191817332, 809.3790191817332, -512.6209808182668, -1106.1370575452029, -439.0, 439.0, 1983.434521228281, -131.52186130069836, -1851.9126599274682, -842.0, 842.0, 310.0, -310.0, 1225.2142227662316, -710.2177826491057, -190.9341554530627, -324.0622846640813, -914.9961748553992, -318.90515831513517, 1233.901333170534, -1729.5831867821994, 1876.6613972691116, -147.07821048680253, -1575.433908483566, 1905.697364450923, -330.2634559672906, 939.7449121969286, -1561.2917728598911, 621.5468606629796, 2356.079794913545, -1018.9408716898225, -1337.1389232237207, -1479.9744930233815, 2189.909701334732, -709.9352083112988, -1089.0, 1089.0, 2068.0922594531744, -1009.231865759453, -1314.072807891529, 255.21241419776067, 265.0, -265.0, -131.0, 131.0, -93.3380951166244, 1646.1445866022877, -1552.806491485613, -871.1555544218329, -345.0681092190374, 1216.2236636408702, -1343.5028842543998, 482.95393155041415, 860.5489527040338, -1081.873375215416, -1178.9215357060648, 2260.7949109214906, -1170.9688296449078, 1996.1624432896385, -825.1936136447072, 1276.0263075561734, 417.4174368195804, -799.1866885070979, -894.2570558687125, 193.04015126392835, 1546.4425304549911, -1739.4826817188048, -1240.7774899251192, 3166.8179879418017, -773.0202490083162, -1153.020249008309, -1751.5034969990666, 1248.0434687942386, 503.4600282048253, -802.5661966467372, -891.6616510762431, 1694.2278477229802, 2306.526016182947, -766.1554979850454, 366.62911170578104, -1906.9996299036432, -1231.7800128269498, -154.1492782986678, 1385.929291125618, -1122.8855685242295, 1904.0155108391568, -781.1299423149112, -36.0, 36.0, -1327.866132241394, 1459.1953450499295, 1664.7320408814408, -1796.0612536901099, -615.0, 615.0, 241.0, -241.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.023732419441085, "mean_inference_ms": 4.664202990124889, "mean_action_processing_ms": 0.9452114972202875, "mean_env_wait_ms": 19.85641077658899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016087770462036133, "StateBufferConnector_ms": 0.014865875244140625, "ViewRequirementAgentConnector_ms": 0.5672941207885742}, "num_episodes": 4, "episode_return_max": 4.3298697960381105e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 1.503031032967783e-13, "episodes_this_iter": 4}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 787801, "num_agent_steps_trained": 515095, "num_env_steps_sampled": 255488, "num_env_steps_trained": 515095, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 52831, "num_env_steps_sampled_throughput_per_sec": 2559.9537972206, "num_env_steps_trained_throughput_per_sec": 5283.004650818809, "timesteps_total": 255488, "num_env_steps_sampled_lifetime": 255488, "num_agent_steps_sampled_lifetime": 787801, "num_steps_trained_this_iter": 52831, "agent_timesteps_total": 787801, "timers": {"training_iteration_time_ms": 11105.633, "restore_workers_time_ms": 0.009, "training_step_time_ms": 0.203, "sample_time_ms": 0.135, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 255488, "num_env_steps_trained": 515095, "num_agent_steps_sampled": 787801, "num_agent_steps_trained": 515095, "num_training_step_calls_since_last_synch_worker_weights": 35882, "num_samples_added_to_queue": 167936, "num_times_learner_queue_full": 21, "num_weight_broadcasts": 11, "total_num_restored_workers": 3}, "done": false, "training_iteration": 11, "trial_id": "de35c_00000", "date": "2024-09-02_13-09-25", "timestamp": 1725250165, "time_this_iter_s": 45.167686462402344, "time_total_s": 531.2458918094635, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 531.2458918094635, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 46.665625000000006, "ram_util_percent": 64.4203125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 69577.0, "policy_loss": 29933.466796875, "entropy": 12.825776100158691, "entropy_coeff": 0.01, "var_gnorm": 2048.534423828125, "vf_loss": 80332.1015625, "vf_explained_var": 0.03159666061401367}, "model": {}, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 281088, "num_env_steps_trained": 569014, "num_agent_steps_sampled": 874482, "num_agent_steps_trained": 569014, "num_training_step_calls_since_last_synch_worker_weights": 45977, "num_samples_added_to_queue": 184320, "num_times_learner_queue_full": 23, "num_weight_broadcasts": 12, "total_num_restored_workers": 3, "learner_queue": {"size_count": 45, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 127.704, "learner_load_time_ms": 1084.633, "learner_load_wait_time_ms": 9676.24, "learner_dequeue_time_ms": 79089.049}}, "env_runners": {"episode_reward_max": 4.2676973066591017e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 1.5421330878950812e-13, "episode_len_mean": 1710.1, "episode_media": {}, "episodes_timesteps_total": 171010, "policy_reward_min": {"default_policy": -2221.0223997069743}, "policy_reward_max": {"default_policy": 3166.8179879418017}, "policy_reward_mean": {"default_policy": 2.018959736997559e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.2521541843143495e-13, 4.2166270475263445e-13, 4.178879464689089e-13, 3.965716643961059e-13, 0.0, 2.220446049250313e-16, 1.312283615106935e-13, 2.220446049250313e-16, 0.0, 4.929390229335695e-14, -2.220446049250313e-16, 1.5920598173124745e-13, 3.341771304121721e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 1.1102230246251565e-16, 5.5289106626332796e-14, 0.0, 0.0, 2.8177460364986473e-13, 9.903189379656396e-14, 1.1102230246251565e-16, 0.0, 4.0589753780295723e-13, 1.8074430840897548e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 3.914646384828302e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 3.0464519795714295e-13, 1.7719159473017498e-13, 1.1102230246251565e-16, 0.0, 1.1102230246251565e-16, -2.220446049250313e-16, 3.0375701953744283e-13, 2.220446049250313e-16, 0.0, 4.143352327901084e-13, 1.6497914145929826e-13, 0.0, 0.0, 4.014566457044566e-13, 0.0, 0.0, 6.661338147750939e-16, 3.672617765460018e-13, 3.774758283725532e-13, 3.3151259515307174e-13, 2.617905892066119e-13, 3.865796571744795e-13, 3.8413716652030416e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 4.1255887595070817e-13, 4.2454928461665986e-13, 4.1522341120980855e-13, 3.141931159689193e-13, 3.566036355096003e-13, 9.969802761133906e-14, 4.2654768606098514e-13, 2.220446049250313e-16, 3.921307722976053e-13, 2.7067237340361316e-13, 2.220446049250313e-16, 3.5793590313915047e-13, 2.3225865675158275e-13, 0.0, 7.016609515630989e-14, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, -2.220446049250313e-16, 3.8125058665627876e-13, 4.2676973066591017e-13, 4.1167069753100805e-13, 2.220446049250313e-16, 3.894662370385049e-13, 2.220446049250313e-16, 1.6120438317557273e-13, 3.04867242562068e-13, 1.7985612998927536e-14, 4.078959392472825e-13, 1.1524114995609125e-13, 2.220446049250313e-16, 0.0, 4.056754931980322e-13, 3.3217872896784684e-13, 3.999023334699814e-13, 2.666755705149626e-13, 2.220446049250313e-16], "episode_lengths": [2048, 2048, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1026, 2048, 1024, 2048, 5, 1024, 1024, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1025, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 2043, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2047, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048], "policy_default_policy_reward": [-299.8132752230986, 1653.922761195346, -1354.1094859721957, 2356.7869016947334, -910.0464273870933, -1446.7404743076204, -8.485281374239214, -1393.7074657186363, 1402.1927470929327, -1702.0060223159235, -384.66608896548433, 2086.6721112815117, 0.0, 0.0, -1439.990701569483, -141.03709455483204, 225.0533563298926, 1355.974439794445, 648.4169183480686, -43.13351365237934, -605.2834046956883, -1383.0172728968498, 273.35005551442396, -678.6499444855759, 1788.3171618679937, 0.0, 0.0, -275.7716446627545, 195.161471607488, 80.61017305526647, 2113.7836558231315, -782.2052944320931, -1124.2052944320899, -207.3730669589834, 160.5132393293468, -284.9640328181803, 124.45079348883223, -682.3580438449906, 885.297690045585, -202.93964620054018, 0.0, 0.0, 117.0, -117.0, -771.0, 771.0, -430.3139720814521, -545.1874377637384, -241.1636288725634, 1216.6650387177065, -1176.644205937957, -971.1075101064803, 1904.105545116852, 243.64617092749137, 326.2710480275773, -656.7631311424087, 1347.8927325229804, -1017.4006494081674, -52.0, 52.0, 0.0, 0.0, -1026.7190462828737, -1298.517423411457, 2325.2364696943323, -506.32218789440464, 556.0023074145168, -1009.2288896480632, 959.5487701279148, -898.1771282114548, 448.998618781858, 1146.4377439629475, -697.2592345334593, -624.0, 624.0, 1786.1517292772328, -1618.5674221359236, -167.58430714121303, 450.42701961583333, -811.7585848021619, 361.331565186328, -788.0, 788.0, -758.0, 758.0, 78.0, -78.0, 835.8284539150795, 260.78758580221705, -576.0208327797698, -520.5952069375629, 139.0, -139.0, -2221.0223997069743, 1518.8653659887157, 702.1570337182467, -523.1075101064571, 1686.6354912789577, -294.4204710660881, -869.1075101064737, 2114.6083361801184, -1113.934369128253, -413.7344431475145, -586.9395239044028, -816.7083322704677, -55.154328932550655, 871.8626612030189, 744.5834405894399, -948.2301935711666, 203.6467529817267, -416.37684051699085, -186.37684051698352, 638.024606337794, -35.270925303824406, -620.0, 620.0, -366.64856326746343, -762.6485632674759, 2686.379660207324, -1557.0825336723078, 1317.661265159658, -12.553755053226027, -652.553755053239, -652.553755053239, -1409.2638149047375, 1492.702415084813, -83.4386001800127, -714.7211574838417, -439.90242934956643, -479.2391992003305, 1633.862786033683, -596.0, 596.0, 1030.2545801888073, -1831.406563273073, 801.1519830843747, 735.3910524340147, -713.470742217231, -21.92031021678348, 809.3790191817332, 809.3790191817332, -512.6209808182668, -1106.1370575452029, -439.0, 439.0, 1983.434521228281, -131.52186130069836, -1851.9126599274682, -842.0, 842.0, 310.0, -310.0, 1225.2142227662316, -710.2177826491057, -190.9341554530627, -324.0622846640813, -914.9961748553992, -318.90515831513517, 1233.901333170534, -1729.5831867821994, 1876.6613972691116, -147.07821048680253, -1575.433908483566, 1905.697364450923, -330.2634559672906, 939.7449121969286, -1561.2917728598911, 621.5468606629796, 2356.079794913545, -1018.9408716898225, -1337.1389232237207, -1479.9744930233815, 2189.909701334732, -709.9352083112988, -1089.0, 1089.0, 2068.0922594531744, -1009.231865759453, -1314.072807891529, 255.21241419776067, 265.0, -265.0, -131.0, 131.0, -93.3380951166244, 1646.1445866022877, -1552.806491485613, -871.1555544218329, -345.0681092190374, 1216.2236636408702, -1343.5028842543998, 482.95393155041415, 860.5489527040338, -1081.873375215416, -1178.9215357060648, 2260.7949109214906, -1170.9688296449078, 1996.1624432896385, -825.1936136447072, 1276.0263075561734, 417.4174368195804, -799.1866885070979, -894.2570558687125, 193.04015126392835, 1546.4425304549911, -1739.4826817188048, -1240.7774899251192, 3166.8179879418017, -773.0202490083162, -1153.020249008309, -1751.5034969990666, 1248.0434687942386, 503.4600282048253, -802.5661966467372, -891.6616510762431, 1694.2278477229802, 2306.526016182947, -766.1554979850454, 366.62911170578104, -1906.9996299036432, -1231.7800128269498, -154.1492782986678, 1385.929291125618, -1122.8855685242295, 1904.0155108391568, -781.1299423149112, -36.0, 36.0, -1327.866132241394, 1459.1953450499295, 1664.7320408814408, -1796.0612536901099, -615.0, 615.0, 241.0, -241.0, -950.2267109833178, -598.2267109833025, -1395.941118797645, 2944.3945407643223, -1320.0047846798498, 1703.0012247969898, 373.1503432088434, -756.1467833260474, -621.8121921400285, -859.8121921400398, -309.8994532381713, 1791.523837518168, 723.3702371538433, -982.171319068086, 258.8010819142778, -956.0083681642193, 2516.593034242867, -1560.5846660786356, 1961.514211011498, -953.1799410394725, -1008.3342699720242, -1193.6834791575393, -672.3125908633527, -757.2066756502045, 2623.202745671082, 2202.6376233960573, -962.3723291948884, -1240.265294201179, 1309.096403107504, -826.4315780650012, -1613.5493977236936, 1130.8845726812385, -823.0722933011467, 717.0062761231643, 106.06601717798236, 1864.12229202571, -693.671752344008, -1170.4505396816871, -833.6405529398547, -1049.5813375024413, -825.6405529398544, 2708.8624433820887, 1924.03755160861, -400.9295449327751, -1523.1080066757543, 1917.6078507516306, 583.2050029583609, -1618.2991693229285, -882.5136843870046, -1119.2193775424141, -381.8913223506436, -919.9817732353896, 2421.092473128398, -941.0, 941.0, -1439.6694064957544, 2435.982861187613, -996.3134546918528, 1967.8781720421769, -1205.617061923043, -762.2611101191037, -1510.3800846144686, 2151.0188283694997, -640.6387437550165, 287.08535316173936, -705.6925676241794, 418.6072144624378, -725.2074730968402, 2907.4804206443664, -1307.0654744506455, -875.2074730968476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.218000632402005, "mean_inference_ms": 4.692783738712189, "mean_action_processing_ms": 0.9538982560076071, "mean_env_wait_ms": 19.746351587746137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01666855812072754, "StateBufferConnector_ms": 0.015119552612304688, "ViewRequirementAgentConnector_ms": 0.582319974899292}, "num_episodes": 21, "episode_return_max": 4.2676973066591017e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 1.5421330878950812e-13, "episodes_this_iter": 21}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 874482, "num_agent_steps_trained": 569014, "num_env_steps_sampled": 281088, "num_env_steps_trained": 569014, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 53919, "num_env_steps_sampled_throughput_per_sec": 2559.979309249262, "num_env_steps_trained_throughput_per_sec": 5391.856420914491, "timesteps_total": 281088, "num_env_steps_sampled_lifetime": 281088, "num_agent_steps_sampled_lifetime": 874482, "num_steps_trained_this_iter": 53919, "agent_timesteps_total": 874482, "timers": {"training_iteration_time_ms": 11105.636, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.151, "sample_time_ms": 0.106, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 281088, "num_env_steps_trained": 569014, "num_agent_steps_sampled": 874482, "num_agent_steps_trained": 569014, "num_training_step_calls_since_last_synch_worker_weights": 45977, "num_samples_added_to_queue": 184320, "num_times_learner_queue_full": 23, "num_weight_broadcasts": 12, "total_num_restored_workers": 3}, "done": false, "training_iteration": 12, "trial_id": "de35c_00000", "date": "2024-09-02_13-10-15", "timestamp": 1725250215, "time_this_iter_s": 49.973145484924316, "time_total_s": 581.2190372943878, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 581.2190372943878, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 53.05915492957747, "ram_util_percent": 63.332394366197185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 5271.501953125, "policy_loss": -22982.869140625, "entropy": 12.616134643554688, "entropy_coeff": 0.01, "var_gnorm": 2048.534423828125, "vf_loss": 57542.25390625, "vf_explained_var": 0.045172691345214844}, "model": {}, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 306688, "num_env_steps_trained": 621215, "num_agent_steps_sampled": 957403, "num_agent_steps_trained": 621215, "num_training_step_calls_since_last_synch_worker_weights": 39389, "num_samples_added_to_queue": 200704, "num_times_learner_queue_full": 25, "num_weight_broadcasts": 13, "total_num_restored_workers": 3, "learner_queue": {"size_count": 49, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 129.91, "learner_load_time_ms": 1093.998, "learner_load_wait_time_ms": 9620.555, "learner_dequeue_time_ms": 80435.253}}, "env_runners": {"episode_reward_max": 4.2676973066591017e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 1.4442558260441273e-13, "episode_len_mean": 1689.62, "episode_media": {}, "episodes_timesteps_total": 168962, "policy_reward_min": {"default_policy": -2221.0223997069743}, "policy_reward_max": {"default_policy": 3166.8179879418017}, "policy_reward_mean": {"default_policy": 1.3735606459152626e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.929390229335695e-14, -2.220446049250313e-16, 1.5920598173124745e-13, 3.341771304121721e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 1.1102230246251565e-16, 5.5289106626332796e-14, 0.0, 0.0, 2.8177460364986473e-13, 9.903189379656396e-14, 1.1102230246251565e-16, 0.0, 4.0589753780295723e-13, 1.8074430840897548e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 3.914646384828302e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 3.0464519795714295e-13, 1.7719159473017498e-13, 1.1102230246251565e-16, 0.0, 1.1102230246251565e-16, -2.220446049250313e-16, 3.0375701953744283e-13, 2.220446049250313e-16, 0.0, 4.143352327901084e-13, 1.6497914145929826e-13, 0.0, 0.0, 4.014566457044566e-13, 0.0, 0.0, 6.661338147750939e-16, 3.672617765460018e-13, 3.774758283725532e-13, 3.3151259515307174e-13, 2.617905892066119e-13, 3.865796571744795e-13, 3.8413716652030416e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 4.1255887595070817e-13, 4.2454928461665986e-13, 4.1522341120980855e-13, 3.141931159689193e-13, 3.566036355096003e-13, 9.969802761133906e-14, 4.2654768606098514e-13, 2.220446049250313e-16, 3.921307722976053e-13, 2.7067237340361316e-13, 2.220446049250313e-16, 3.5793590313915047e-13, 2.3225865675158275e-13, 0.0, 7.016609515630989e-14, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, -2.220446049250313e-16, 3.8125058665627876e-13, 4.2676973066591017e-13, 4.1167069753100805e-13, 2.220446049250313e-16, 3.894662370385049e-13, 2.220446049250313e-16, 1.6120438317557273e-13, 3.04867242562068e-13, 1.7985612998927536e-14, 4.078959392472825e-13, 1.1524114995609125e-13, 2.220446049250313e-16, 0.0, 4.056754931980322e-13, 3.3217872896784684e-13, 3.999023334699814e-13, 2.666755705149626e-13, 2.220446049250313e-16, 6.061817714453355e-14, 2.220446049250313e-16, 3.54605234065275e-13, 0.0, 0.0, 0.0, 0.0, 3.9901415505028126e-13, -2.220446049250313e-16], "episode_lengths": [1026, 2048, 1024, 2048, 5, 1024, 1024, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1025, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 2043, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2047, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 2048, 2048], "policy_default_policy_reward": [-275.7716446627545, 195.161471607488, 80.61017305526647, 2113.7836558231315, -782.2052944320931, -1124.2052944320899, -207.3730669589834, 160.5132393293468, -284.9640328181803, 124.45079348883223, -682.3580438449906, 885.297690045585, -202.93964620054018, 0.0, 0.0, 117.0, -117.0, -771.0, 771.0, -430.3139720814521, -545.1874377637384, -241.1636288725634, 1216.6650387177065, -1176.644205937957, -971.1075101064803, 1904.105545116852, 243.64617092749137, 326.2710480275773, -656.7631311424087, 1347.8927325229804, -1017.4006494081674, -52.0, 52.0, 0.0, 0.0, -1026.7190462828737, -1298.517423411457, 2325.2364696943323, -506.32218789440464, 556.0023074145168, -1009.2288896480632, 959.5487701279148, -898.1771282114548, 448.998618781858, 1146.4377439629475, -697.2592345334593, -624.0, 624.0, 1786.1517292772328, -1618.5674221359236, -167.58430714121303, 450.42701961583333, -811.7585848021619, 361.331565186328, -788.0, 788.0, -758.0, 758.0, 78.0, -78.0, 835.8284539150795, 260.78758580221705, -576.0208327797698, -520.5952069375629, 139.0, -139.0, -2221.0223997069743, 1518.8653659887157, 702.1570337182467, -523.1075101064571, 1686.6354912789577, -294.4204710660881, -869.1075101064737, 2114.6083361801184, -1113.934369128253, -413.7344431475145, -586.9395239044028, -816.7083322704677, -55.154328932550655, 871.8626612030189, 744.5834405894399, -948.2301935711666, 203.6467529817267, -416.37684051699085, -186.37684051698352, 638.024606337794, -35.270925303824406, -620.0, 620.0, -366.64856326746343, -762.6485632674759, 2686.379660207324, -1557.0825336723078, 1317.661265159658, -12.553755053226027, -652.553755053239, -652.553755053239, -1409.2638149047375, 1492.702415084813, -83.4386001800127, -714.7211574838417, -439.90242934956643, -479.2391992003305, 1633.862786033683, -596.0, 596.0, 1030.2545801888073, -1831.406563273073, 801.1519830843747, 735.3910524340147, -713.470742217231, -21.92031021678348, 809.3790191817332, 809.3790191817332, -512.6209808182668, -1106.1370575452029, -439.0, 439.0, 1983.434521228281, -131.52186130069836, -1851.9126599274682, -842.0, 842.0, 310.0, -310.0, 1225.2142227662316, -710.2177826491057, -190.9341554530627, -324.0622846640813, -914.9961748553992, -318.90515831513517, 1233.901333170534, -1729.5831867821994, 1876.6613972691116, -147.07821048680253, -1575.433908483566, 1905.697364450923, -330.2634559672906, 939.7449121969286, -1561.2917728598911, 621.5468606629796, 2356.079794913545, -1018.9408716898225, -1337.1389232237207, -1479.9744930233815, 2189.909701334732, -709.9352083112988, -1089.0, 1089.0, 2068.0922594531744, -1009.231865759453, -1314.072807891529, 255.21241419776067, 265.0, -265.0, -131.0, 131.0, -93.3380951166244, 1646.1445866022877, -1552.806491485613, -871.1555544218329, -345.0681092190374, 1216.2236636408702, -1343.5028842543998, 482.95393155041415, 860.5489527040338, -1081.873375215416, -1178.9215357060648, 2260.7949109214906, -1170.9688296449078, 1996.1624432896385, -825.1936136447072, 1276.0263075561734, 417.4174368195804, -799.1866885070979, -894.2570558687125, 193.04015126392835, 1546.4425304549911, -1739.4826817188048, -1240.7774899251192, 3166.8179879418017, -773.0202490083162, -1153.020249008309, -1751.5034969990666, 1248.0434687942386, 503.4600282048253, -802.5661966467372, -891.6616510762431, 1694.2278477229802, 2306.526016182947, -766.1554979850454, 366.62911170578104, -1906.9996299036432, -1231.7800128269498, -154.1492782986678, 1385.929291125618, -1122.8855685242295, 1904.0155108391568, -781.1299423149112, -36.0, 36.0, -1327.866132241394, 1459.1953450499295, 1664.7320408814408, -1796.0612536901099, -615.0, 615.0, 241.0, -241.0, -950.2267109833178, -598.2267109833025, -1395.941118797645, 2944.3945407643223, -1320.0047846798498, 1703.0012247969898, 373.1503432088434, -756.1467833260474, -621.8121921400285, -859.8121921400398, -309.8994532381713, 1791.523837518168, 723.3702371538433, -982.171319068086, 258.8010819142778, -956.0083681642193, 2516.593034242867, -1560.5846660786356, 1961.514211011498, -953.1799410394725, -1008.3342699720242, -1193.6834791575393, -672.3125908633527, -757.2066756502045, 2623.202745671082, 2202.6376233960573, -962.3723291948884, -1240.265294201179, 1309.096403107504, -826.4315780650012, -1613.5493977236936, 1130.8845726812385, -823.0722933011467, 717.0062761231643, 106.06601717798236, 1864.12229202571, -693.671752344008, -1170.4505396816871, -833.6405529398547, -1049.5813375024413, -825.6405529398544, 2708.8624433820887, 1924.03755160861, -400.9295449327751, -1523.1080066757543, 1917.6078507516306, 583.2050029583609, -1618.2991693229285, -882.5136843870046, -1119.2193775424141, -381.8913223506436, -919.9817732353896, 2421.092473128398, -941.0, 941.0, -1439.6694064957544, 2435.982861187613, -996.3134546918528, 1967.8781720421769, -1205.617061923043, -762.2611101191037, -1510.3800846144686, 2151.0188283694997, -640.6387437550165, 287.08535316173936, -705.6925676241794, 418.6072144624378, -725.2074730968402, 2907.4804206443664, -1307.0654744506455, -875.2074730968476, -130.81475451951172, -224.1528496361368, 354.9676041556485, 1617.1811154446307, 65.21756897391248, -516.7515023692303, -1165.6471820493566, -1307.4404384138902, 1683.6212460052038, -376.18080759124564, -209.0, 209.0, -688.0, 688.0, 369.0, -369.0, 656.0, -656.0, -1535.1288219559237, -629.3250352560317, 2164.45385721202, 865.5019936166171, 1434.122390663395, -1328.955785679457, -970.668598600592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.280752043367947, "mean_inference_ms": 4.700089173624233, "mean_action_processing_ms": 0.9564009686178988, "mean_env_wait_ms": 19.699640028663023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016739368438720703, "StateBufferConnector_ms": 0.01525568962097168, "ViewRequirementAgentConnector_ms": 0.5828266143798828}, "num_episodes": 9, "episode_return_max": 4.2676973066591017e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 1.4442558260441273e-13, "episodes_this_iter": 9}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 957403, "num_agent_steps_trained": 621215, "num_env_steps_sampled": 306688, "num_env_steps_trained": 621215, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 52201, "num_env_steps_sampled_throughput_per_sec": 2559.983154407725, "num_env_steps_trained_throughput_per_sec": 5220.06565012647, "timesteps_total": 306688, "num_env_steps_sampled_lifetime": 306688, "num_agent_steps_sampled_lifetime": 957403, "num_steps_trained_this_iter": 52201, "agent_timesteps_total": 957403, "timers": {"training_iteration_time_ms": 11105.64, "restore_workers_time_ms": 0.009, "training_step_time_ms": 0.215, "sample_time_ms": 0.149, "synch_weights_time_ms": 0.016}, "counters": {"num_env_steps_sampled": 306688, "num_env_steps_trained": 621215, "num_agent_steps_sampled": 957403, "num_agent_steps_trained": 621215, "num_training_step_calls_since_last_synch_worker_weights": 39389, "num_samples_added_to_queue": 200704, "num_times_learner_queue_full": 25, "num_weight_broadcasts": 13, "total_num_restored_workers": 3}, "done": false, "training_iteration": 13, "trial_id": "de35c_00000", "date": "2024-09-02_13-11-01", "timestamp": 1725250261, "time_this_iter_s": 46.60724496841431, "time_total_s": 627.8262822628021, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 627.8262822628021, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 50.94179104477612, "ram_util_percent": 64.04179104477613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 59778.83984375, "policy_loss": 14413.83203125, "entropy": 13.248062133789062, "entropy_coeff": 0.01, "var_gnorm": 2048.53466796875, "vf_loss": 91815.296875, "vf_explained_var": 0.08022218942642212}, "model": {}, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 332288, "num_env_steps_trained": 673418, "num_agent_steps_sampled": 1040299, "num_agent_steps_trained": 673418, "num_training_step_calls_since_last_synch_worker_weights": 46010, "num_samples_added_to_queue": 217088, "num_times_learner_queue_full": 28, "num_weight_broadcasts": 14, "total_num_restored_workers": 3, "learner_queue": {"size_count": 53, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 119.226, "learner_load_time_ms": 1093.998, "learner_load_wait_time_ms": 9742.766, "learner_dequeue_time_ms": 80435.253}}, "env_runners": {"episode_reward_max": 4.2676973066591017e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.4874212972415535e-13, "episode_len_mean": 1771.49, "episode_media": {}, "episodes_timesteps_total": 177149, "policy_reward_min": {"default_policy": -2276.1767286395266}, "policy_reward_max": {"default_policy": 3166.8179879418017}, "policy_reward_mean": {"default_policy": 1.5835476299417356e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.220446049250313e-16, 0.0, 3.914646384828302e-13, 1.1102230246251565e-16, 2.220446049250313e-16, 3.0464519795714295e-13, 1.7719159473017498e-13, 1.1102230246251565e-16, 0.0, 1.1102230246251565e-16, -2.220446049250313e-16, 3.0375701953744283e-13, 2.220446049250313e-16, 0.0, 4.143352327901084e-13, 1.6497914145929826e-13, 0.0, 0.0, 4.014566457044566e-13, 0.0, 0.0, 6.661338147750939e-16, 3.672617765460018e-13, 3.774758283725532e-13, 3.3151259515307174e-13, 2.617905892066119e-13, 3.865796571744795e-13, 3.8413716652030416e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 4.1255887595070817e-13, 4.2454928461665986e-13, 4.1522341120980855e-13, 3.141931159689193e-13, 3.566036355096003e-13, 9.969802761133906e-14, 4.2654768606098514e-13, 2.220446049250313e-16, 3.921307722976053e-13, 2.7067237340361316e-13, 2.220446049250313e-16, 3.5793590313915047e-13, 2.3225865675158275e-13, 0.0, 7.016609515630989e-14, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, -2.220446049250313e-16, 3.8125058665627876e-13, 4.2676973066591017e-13, 4.1167069753100805e-13, 2.220446049250313e-16, 3.894662370385049e-13, 2.220446049250313e-16, 1.6120438317557273e-13, 3.04867242562068e-13, 1.7985612998927536e-14, 4.078959392472825e-13, 1.1524114995609125e-13, 2.220446049250313e-16, 0.0, 4.056754931980322e-13, 3.3217872896784684e-13, 3.999023334699814e-13, 2.666755705149626e-13, 2.220446049250313e-16, 6.061817714453355e-14, 2.220446049250313e-16, 3.54605234065275e-13, 0.0, 0.0, 0.0, 0.0, 3.9901415505028126e-13, -2.220446049250313e-16, -2.220446049250313e-16, -3.3306690738754696e-16, 0.0, 0.0, 3.623767952376511e-13, 0.0, 0.0, 2.220446049250313e-16, -3.3306690738754696e-16, 3.3306690738754696e-16, 3.7414515929867775e-13, 1.1879386363489175e-13, -2.220446049250313e-16, 3.723688024592775e-13, 4.1611158962950867e-13, 0.0, 1.1102230246251565e-16, 3.5371705564557487e-13, 2.220446049250313e-16], "episode_lengths": [1024, 1024, 1024, 1025, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 2043, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2047, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 1025, 2048, 2048, 2048, 2049, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048], "policy_default_policy_reward": [-758.0, 758.0, 78.0, -78.0, 835.8284539150795, 260.78758580221705, -576.0208327797698, -520.5952069375629, 139.0, -139.0, -2221.0223997069743, 1518.8653659887157, 702.1570337182467, -523.1075101064571, 1686.6354912789577, -294.4204710660881, -869.1075101064737, 2114.6083361801184, -1113.934369128253, -413.7344431475145, -586.9395239044028, -816.7083322704677, -55.154328932550655, 871.8626612030189, 744.5834405894399, -948.2301935711666, 203.6467529817267, -416.37684051699085, -186.37684051698352, 638.024606337794, -35.270925303824406, -620.0, 620.0, -366.64856326746343, -762.6485632674759, 2686.379660207324, -1557.0825336723078, 1317.661265159658, -12.553755053226027, -652.553755053239, -652.553755053239, -1409.2638149047375, 1492.702415084813, -83.4386001800127, -714.7211574838417, -439.90242934956643, -479.2391992003305, 1633.862786033683, -596.0, 596.0, 1030.2545801888073, -1831.406563273073, 801.1519830843747, 735.3910524340147, -713.470742217231, -21.92031021678348, 809.3790191817332, 809.3790191817332, -512.6209808182668, -1106.1370575452029, -439.0, 439.0, 1983.434521228281, -131.52186130069836, -1851.9126599274682, -842.0, 842.0, 310.0, -310.0, 1225.2142227662316, -710.2177826491057, -190.9341554530627, -324.0622846640813, -914.9961748553992, -318.90515831513517, 1233.901333170534, -1729.5831867821994, 1876.6613972691116, -147.07821048680253, -1575.433908483566, 1905.697364450923, -330.2634559672906, 939.7449121969286, -1561.2917728598911, 621.5468606629796, 2356.079794913545, -1018.9408716898225, -1337.1389232237207, -1479.9744930233815, 2189.909701334732, -709.9352083112988, -1089.0, 1089.0, 2068.0922594531744, -1009.231865759453, -1314.072807891529, 255.21241419776067, 265.0, -265.0, -131.0, 131.0, -93.3380951166244, 1646.1445866022877, -1552.806491485613, -871.1555544218329, -345.0681092190374, 1216.2236636408702, -1343.5028842543998, 482.95393155041415, 860.5489527040338, -1081.873375215416, -1178.9215357060648, 2260.7949109214906, -1170.9688296449078, 1996.1624432896385, -825.1936136447072, 1276.0263075561734, 417.4174368195804, -799.1866885070979, -894.2570558687125, 193.04015126392835, 1546.4425304549911, -1739.4826817188048, -1240.7774899251192, 3166.8179879418017, -773.0202490083162, -1153.020249008309, -1751.5034969990666, 1248.0434687942386, 503.4600282048253, -802.5661966467372, -891.6616510762431, 1694.2278477229802, 2306.526016182947, -766.1554979850454, 366.62911170578104, -1906.9996299036432, -1231.7800128269498, -154.1492782986678, 1385.929291125618, -1122.8855685242295, 1904.0155108391568, -781.1299423149112, -36.0, 36.0, -1327.866132241394, 1459.1953450499295, 1664.7320408814408, -1796.0612536901099, -615.0, 615.0, 241.0, -241.0, -950.2267109833178, -598.2267109833025, -1395.941118797645, 2944.3945407643223, -1320.0047846798498, 1703.0012247969898, 373.1503432088434, -756.1467833260474, -621.8121921400285, -859.8121921400398, -309.8994532381713, 1791.523837518168, 723.3702371538433, -982.171319068086, 258.8010819142778, -956.0083681642193, 2516.593034242867, -1560.5846660786356, 1961.514211011498, -953.1799410394725, -1008.3342699720242, -1193.6834791575393, -672.3125908633527, -757.2066756502045, 2623.202745671082, 2202.6376233960573, -962.3723291948884, -1240.265294201179, 1309.096403107504, -826.4315780650012, -1613.5493977236936, 1130.8845726812385, -823.0722933011467, 717.0062761231643, 106.06601717798236, 1864.12229202571, -693.671752344008, -1170.4505396816871, -833.6405529398547, -1049.5813375024413, -825.6405529398544, 2708.8624433820887, 1924.03755160861, -400.9295449327751, -1523.1080066757543, 1917.6078507516306, 583.2050029583609, -1618.2991693229285, -882.5136843870046, -1119.2193775424141, -381.8913223506436, -919.9817732353896, 2421.092473128398, -941.0, 941.0, -1439.6694064957544, 2435.982861187613, -996.3134546918528, 1967.8781720421769, -1205.617061923043, -762.2611101191037, -1510.3800846144686, 2151.0188283694997, -640.6387437550165, 287.08535316173936, -705.6925676241794, 418.6072144624378, -725.2074730968402, 2907.4804206443664, -1307.0654744506455, -875.2074730968476, -130.81475451951172, -224.1528496361368, 354.9676041556485, 1617.1811154446307, 65.21756897391248, -516.7515023692303, -1165.6471820493566, -1307.4404384138902, 1683.6212460052038, -376.18080759124564, -209.0, 209.0, -688.0, 688.0, 369.0, -369.0, 656.0, -656.0, -1535.1288219559237, -629.3250352560317, 2164.45385721202, 865.5019936166171, 1434.122390663395, -1328.955785679457, -970.668598600592, 975.4280181821033, 792.5220289497047, -986.975023565953, -780.975023565943, -583.4887079529473, -874.4732436245287, 2661.949677035621, -1203.9877254581554, 0.0, 0.0, 0.0, 0.0, 610.9402589451813, -1520.9866863322604, 910.0464273870928, 592.0, -592.0, 0.0, 0.0, -1218.9787971240012, -1096.5805400557947, -576.5805400557887, 2892.1398772355437, -877.3147695281124, -234.6618489311337, 2501.978427027719, -1390.001808568438, -537.6380400399835, 585.5995642670501, -2067.080355007619, 2019.1188307804955, -1054.2962107491453, 2314.3604948235447, -1260.0642840743988, -498.64856326746315, 1526.8669586801802, 59.95903918048661, -1088.1774345932445, -687.4228634059859, 2296.2654004313986, -453.42126851271723, -1155.4212685127172, -1031.6687937511792, -1262.8927111991445, 2294.5615049503244, -2276.1767286395266, 1601.5968593875423, 674.5798692519711, -356.0, 356.0, -1242.0335346719685, -408.0335346719866, 2905.957010476538, -1255.889941132517, -282.1356056934341, 1830.6994564919855, -1548.563850798466, 2131.6793355032146, -1162.8855838030393, 94.7875858022104, -1063.5813375024386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.385780139273619, "mean_inference_ms": 4.726247373172444, "mean_action_processing_ms": 0.9657154529063035, "mean_env_wait_ms": 19.621058678147104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017969846725463867, "StateBufferConnector_ms": 0.014893054962158203, "ViewRequirementAgentConnector_ms": 0.5986521244049072}, "num_episodes": 19, "episode_return_max": 4.2676973066591017e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.4874212972415535e-13, "episodes_this_iter": 19}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 1040299, "num_agent_steps_trained": 673418, "num_env_steps_sampled": 332288, "num_env_steps_trained": 673418, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 52203, "num_env_steps_sampled_throughput_per_sec": 2559.971618966989, "num_env_steps_trained_throughput_per_sec": 5220.242125973974, "timesteps_total": 332288, "num_env_steps_sampled_lifetime": 332288, "num_agent_steps_sampled_lifetime": 1040299, "num_steps_trained_this_iter": 52203, "agent_timesteps_total": 1040299, "timers": {"training_iteration_time_ms": 11105.646, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.143, "sample_time_ms": 0.105, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 332288, "num_env_steps_trained": 673418, "num_agent_steps_sampled": 1040299, "num_agent_steps_trained": 673418, "num_training_step_calls_since_last_synch_worker_weights": 46010, "num_samples_added_to_queue": 217088, "num_times_learner_queue_full": 28, "num_weight_broadcasts": 14, "total_num_restored_workers": 3}, "done": false, "training_iteration": 14, "trial_id": "de35c_00000", "date": "2024-09-02_13-11-53", "timestamp": 1725250313, "time_this_iter_s": 51.70284581184387, "time_total_s": 679.529128074646, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 679.529128074646, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 52.07123287671233, "ram_util_percent": 63.64383561643836}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 40201.421875, "policy_loss": 8164.15625, "entropy": 12.699054718017578, "entropy_coeff": 0.01, "var_gnorm": 2048.534423828125, "vf_loss": 65114.8359375, "vf_explained_var": 0.060387372970581055}, "model": {}, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 357888, "num_env_steps_trained": 721537, "num_agent_steps_sampled": 1113510, "num_agent_steps_trained": 721537, "num_training_step_calls_since_last_synch_worker_weights": 44141, "num_samples_added_to_queue": 233472, "num_times_learner_queue_full": 30, "num_weight_broadcasts": 15, "total_num_restored_workers": 3, "learner_queue": {"size_count": 57, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 131.184, "learner_load_time_ms": 1074.871, "learner_load_wait_time_ms": 9825.202, "learner_dequeue_time_ms": 81939.139}}, "env_runners": {"episode_reward_max": 4.298783551348606e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.5302425993013457e-13, "episode_len_mean": 1761.23, "episode_media": {}, "episodes_timesteps_total": 176123, "policy_reward_min": {"default_policy": -2398.50620178484}, "policy_reward_max": {"default_policy": 3166.8179879418017}, "policy_reward_mean": {"default_policy": 2.6284396881237627e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.143352327901084e-13, 1.6497914145929826e-13, 0.0, 0.0, 4.014566457044566e-13, 0.0, 0.0, 6.661338147750939e-16, 3.672617765460018e-13, 3.774758283725532e-13, 3.3151259515307174e-13, 2.617905892066119e-13, 3.865796571744795e-13, 3.8413716652030416e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 4.1255887595070817e-13, 4.2454928461665986e-13, 4.1522341120980855e-13, 3.141931159689193e-13, 3.566036355096003e-13, 9.969802761133906e-14, 4.2654768606098514e-13, 2.220446049250313e-16, 3.921307722976053e-13, 2.7067237340361316e-13, 2.220446049250313e-16, 3.5793590313915047e-13, 2.3225865675158275e-13, 0.0, 7.016609515630989e-14, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, -2.220446049250313e-16, 3.8125058665627876e-13, 4.2676973066591017e-13, 4.1167069753100805e-13, 2.220446049250313e-16, 3.894662370385049e-13, 2.220446049250313e-16, 1.6120438317557273e-13, 3.04867242562068e-13, 1.7985612998927536e-14, 4.078959392472825e-13, 1.1524114995609125e-13, 2.220446049250313e-16, 0.0, 4.056754931980322e-13, 3.3217872896784684e-13, 3.999023334699814e-13, 2.666755705149626e-13, 2.220446049250313e-16, 6.061817714453355e-14, 2.220446049250313e-16, 3.54605234065275e-13, 0.0, 0.0, 0.0, 0.0, 3.9901415505028126e-13, -2.220446049250313e-16, -2.220446049250313e-16, -3.3306690738754696e-16, 0.0, 0.0, 3.623767952376511e-13, 0.0, 0.0, 2.220446049250313e-16, -3.3306690738754696e-16, 3.3306690738754696e-16, 3.7414515929867775e-13, 1.1879386363489175e-13, -2.220446049250313e-16, 3.723688024592775e-13, 4.1611158962950867e-13, 0.0, 1.1102230246251565e-16, 3.5371705564557487e-13, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 4.276579090856103e-13, 0.0, 3.936850845320805e-13, 4.298783551348606e-13, 3.5438318946034997e-13, 0.0, 2.220446049250313e-16, 0.0], "episode_lengths": [2048, 1024, 1024, 1024, 2043, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2047, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 1025, 2048, 2048, 2048, 2049, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 1024], "policy_default_policy_reward": [1030.2545801888073, -1831.406563273073, 801.1519830843747, 735.3910524340147, -713.470742217231, -21.92031021678348, 809.3790191817332, 809.3790191817332, -512.6209808182668, -1106.1370575452029, -439.0, 439.0, 1983.434521228281, -131.52186130069836, -1851.9126599274682, -842.0, 842.0, 310.0, -310.0, 1225.2142227662316, -710.2177826491057, -190.9341554530627, -324.0622846640813, -914.9961748553992, -318.90515831513517, 1233.901333170534, -1729.5831867821994, 1876.6613972691116, -147.07821048680253, -1575.433908483566, 1905.697364450923, -330.2634559672906, 939.7449121969286, -1561.2917728598911, 621.5468606629796, 2356.079794913545, -1018.9408716898225, -1337.1389232237207, -1479.9744930233815, 2189.909701334732, -709.9352083112988, -1089.0, 1089.0, 2068.0922594531744, -1009.231865759453, -1314.072807891529, 255.21241419776067, 265.0, -265.0, -131.0, 131.0, -93.3380951166244, 1646.1445866022877, -1552.806491485613, -871.1555544218329, -345.0681092190374, 1216.2236636408702, -1343.5028842543998, 482.95393155041415, 860.5489527040338, -1081.873375215416, -1178.9215357060648, 2260.7949109214906, -1170.9688296449078, 1996.1624432896385, -825.1936136447072, 1276.0263075561734, 417.4174368195804, -799.1866885070979, -894.2570558687125, 193.04015126392835, 1546.4425304549911, -1739.4826817188048, -1240.7774899251192, 3166.8179879418017, -773.0202490083162, -1153.020249008309, -1751.5034969990666, 1248.0434687942386, 503.4600282048253, -802.5661966467372, -891.6616510762431, 1694.2278477229802, 2306.526016182947, -766.1554979850454, 366.62911170578104, -1906.9996299036432, -1231.7800128269498, -154.1492782986678, 1385.929291125618, -1122.8855685242295, 1904.0155108391568, -781.1299423149112, -36.0, 36.0, -1327.866132241394, 1459.1953450499295, 1664.7320408814408, -1796.0612536901099, -615.0, 615.0, 241.0, -241.0, -950.2267109833178, -598.2267109833025, -1395.941118797645, 2944.3945407643223, -1320.0047846798498, 1703.0012247969898, 373.1503432088434, -756.1467833260474, -621.8121921400285, -859.8121921400398, -309.8994532381713, 1791.523837518168, 723.3702371538433, -982.171319068086, 258.8010819142778, -956.0083681642193, 2516.593034242867, -1560.5846660786356, 1961.514211011498, -953.1799410394725, -1008.3342699720242, -1193.6834791575393, -672.3125908633527, -757.2066756502045, 2623.202745671082, 2202.6376233960573, -962.3723291948884, -1240.265294201179, 1309.096403107504, -826.4315780650012, -1613.5493977236936, 1130.8845726812385, -823.0722933011467, 717.0062761231643, 106.06601717798236, 1864.12229202571, -693.671752344008, -1170.4505396816871, -833.6405529398547, -1049.5813375024413, -825.6405529398544, 2708.8624433820887, 1924.03755160861, -400.9295449327751, -1523.1080066757543, 1917.6078507516306, 583.2050029583609, -1618.2991693229285, -882.5136843870046, -1119.2193775424141, -381.8913223506436, -919.9817732353896, 2421.092473128398, -941.0, 941.0, -1439.6694064957544, 2435.982861187613, -996.3134546918528, 1967.8781720421769, -1205.617061923043, -762.2611101191037, -1510.3800846144686, 2151.0188283694997, -640.6387437550165, 287.08535316173936, -705.6925676241794, 418.6072144624378, -725.2074730968402, 2907.4804206443664, -1307.0654744506455, -875.2074730968476, -130.81475451951172, -224.1528496361368, 354.9676041556485, 1617.1811154446307, 65.21756897391248, -516.7515023692303, -1165.6471820493566, -1307.4404384138902, 1683.6212460052038, -376.18080759124564, -209.0, 209.0, -688.0, 688.0, 369.0, -369.0, 656.0, -656.0, -1535.1288219559237, -629.3250352560317, 2164.45385721202, 865.5019936166171, 1434.122390663395, -1328.955785679457, -970.668598600592, 975.4280181821033, 792.5220289497047, -986.975023565953, -780.975023565943, -583.4887079529473, -874.4732436245287, 2661.949677035621, -1203.9877254581554, 0.0, 0.0, 0.0, 0.0, 610.9402589451813, -1520.9866863322604, 910.0464273870928, 592.0, -592.0, 0.0, 0.0, -1218.9787971240012, -1096.5805400557947, -576.5805400557887, 2892.1398772355437, -877.3147695281124, -234.6618489311337, 2501.978427027719, -1390.001808568438, -537.6380400399835, 585.5995642670501, -2067.080355007619, 2019.1188307804955, -1054.2962107491453, 2314.3604948235447, -1260.0642840743988, -498.64856326746315, 1526.8669586801802, 59.95903918048661, -1088.1774345932445, -687.4228634059859, 2296.2654004313986, -453.42126851271723, -1155.4212685127172, -1031.6687937511792, -1262.8927111991445, 2294.5615049503244, -2276.1767286395266, 1601.5968593875423, 674.5798692519711, -356.0, 356.0, -1242.0335346719685, -408.0335346719866, 2905.957010476538, -1255.889941132517, -282.1356056934341, 1830.6994564919855, -1548.563850798466, 2131.6793355032146, -1162.8855838030393, 94.7875858022104, -1063.5813375024386, -454.0, 454.0, -691.0, 691.0, 0.0, 0.0, 543.0, -543.0, 446.0, -446.0, 327.0, -327.0, 0.0, 0.0, -1268.7108479315254, -1093.1963660979138, -477.19636609790257, 2839.1035801273742, 846.4068170803625, 36.06244584051896, -882.4692629208178, 564.0, -564.0, -338.704148188358, -818.1225458328414, 1156.8266940212495, 1417.7490962790532, 980.7571055057485, -2398.50620178484, 1209.8597026101913, 7.071067811864664, -1216.9307704220266, -735.0, 735.0, -1101.0712129982778, 1277.740395370261, -1435.934369128194, 1259.2651867562504, 571.0, -571.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.380744764197543, "mean_inference_ms": 4.730126784207173, "mean_action_processing_ms": 0.9656296586602031, "mean_env_wait_ms": 19.509139479996563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0180356502532959, "StateBufferConnector_ms": 0.014784097671508789, "ViewRequirementAgentConnector_ms": 0.5939345359802246}, "num_episodes": 16, "episode_return_max": 4.298783551348606e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.5302425993013457e-13, "episodes_this_iter": 16}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 1113510, "num_agent_steps_trained": 721537, "num_env_steps_sampled": 357888, "num_env_steps_trained": 721537, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 48119, "num_env_steps_sampled_throughput_per_sec": 2559.9715579331873, "num_env_steps_trained_throughput_per_sec": 4811.846538913556, "timesteps_total": 357888, "num_env_steps_sampled_lifetime": 357888, "num_agent_steps_sampled_lifetime": 1113510, "num_steps_trained_this_iter": 48119, "agent_timesteps_total": 1113510, "timers": {"training_iteration_time_ms": 11105.645, "restore_workers_time_ms": 0.007, "training_step_time_ms": 0.166, "sample_time_ms": 0.117, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 357888, "num_env_steps_trained": 721537, "num_agent_steps_sampled": 1113510, "num_agent_steps_trained": 721537, "num_training_step_calls_since_last_synch_worker_weights": 44141, "num_samples_added_to_queue": 233472, "num_times_learner_queue_full": 30, "num_weight_broadcasts": 15, "total_num_restored_workers": 3}, "done": false, "training_iteration": 15, "trial_id": "de35c_00000", "date": "2024-09-02_13-12-42", "timestamp": 1725250362, "time_this_iter_s": 48.617976665496826, "time_total_s": 728.1471047401428, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 728.1471047401428, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 52.323188405797104, "ram_util_percent": 63.82463768115943}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -13060.56640625, "policy_loss": -40896.96484375, "entropy": 12.909456253051758, "entropy_coeff": 0.01, "var_gnorm": 2048.534423828125, "vf_loss": 56730.3359375, "vf_explained_var": 0.033799946308135986}, "model": {}, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 383488, "num_env_steps_trained": 770681, "num_agent_steps_sampled": 1190302, "num_agent_steps_trained": 770681, "num_training_step_calls_since_last_synch_worker_weights": 44564, "num_samples_added_to_queue": 249856, "num_times_learner_queue_full": 32, "num_weight_broadcasts": 16, "total_num_restored_workers": 3, "learner_queue": {"size_count": 61, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 130.69, "learner_load_time_ms": 1074.871, "learner_load_wait_time_ms": 10140.513, "learner_dequeue_time_ms": 81939.139}}, "env_runners": {"episode_reward_max": 4.298783551348606e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.450373154909812e-13, "episode_len_mean": 1771.51, "episode_media": {}, "episodes_timesteps_total": 177151, "policy_reward_min": {"default_policy": -2398.50620178484}, "policy_reward_max": {"default_policy": 3166.8179879418017}, "policy_reward_mean": {"default_policy": 1.7729103530407496e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8413716652030416e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 4.1255887595070817e-13, 4.2454928461665986e-13, 4.1522341120980855e-13, 3.141931159689193e-13, 3.566036355096003e-13, 9.969802761133906e-14, 4.2654768606098514e-13, 2.220446049250313e-16, 3.921307722976053e-13, 2.7067237340361316e-13, 2.220446049250313e-16, 3.5793590313915047e-13, 2.3225865675158275e-13, 0.0, 7.016609515630989e-14, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, -2.220446049250313e-16, 3.8125058665627876e-13, 4.2676973066591017e-13, 4.1167069753100805e-13, 2.220446049250313e-16, 3.894662370385049e-13, 2.220446049250313e-16, 1.6120438317557273e-13, 3.04867242562068e-13, 1.7985612998927536e-14, 4.078959392472825e-13, 1.1524114995609125e-13, 2.220446049250313e-16, 0.0, 4.056754931980322e-13, 3.3217872896784684e-13, 3.999023334699814e-13, 2.666755705149626e-13, 2.220446049250313e-16, 6.061817714453355e-14, 2.220446049250313e-16, 3.54605234065275e-13, 0.0, 0.0, 0.0, 0.0, 3.9901415505028126e-13, -2.220446049250313e-16, -2.220446049250313e-16, -3.3306690738754696e-16, 0.0, 0.0, 3.623767952376511e-13, 0.0, 0.0, 2.220446049250313e-16, -3.3306690738754696e-16, 3.3306690738754696e-16, 3.7414515929867775e-13, 1.1879386363489175e-13, -2.220446049250313e-16, 3.723688024592775e-13, 4.1611158962950867e-13, 0.0, 1.1102230246251565e-16, 3.5371705564557487e-13, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 4.276579090856103e-13, 0.0, 3.936850845320805e-13, 4.298783551348606e-13, 3.5438318946034997e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 2.220446049250313e-16, 4.1722181265413383e-13, 3.1885605267234496e-13, 4.0811798385220754e-13, -2.220446049250313e-16, 2.220446049250313e-16, 3.519406988061746e-13, 0.0, 0.0, 4.107825191113079e-13, 0.0], "episode_lengths": [2048, 2047, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 1025, 2048, 2048, 2048, 2049, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2047, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 1024], "policy_default_policy_reward": [-1479.9744930233815, 2189.909701334732, -709.9352083112988, -1089.0, 1089.0, 2068.0922594531744, -1009.231865759453, -1314.072807891529, 255.21241419776067, 265.0, -265.0, -131.0, 131.0, -93.3380951166244, 1646.1445866022877, -1552.806491485613, -871.1555544218329, -345.0681092190374, 1216.2236636408702, -1343.5028842543998, 482.95393155041415, 860.5489527040338, -1081.873375215416, -1178.9215357060648, 2260.7949109214906, -1170.9688296449078, 1996.1624432896385, -825.1936136447072, 1276.0263075561734, 417.4174368195804, -799.1866885070979, -894.2570558687125, 193.04015126392835, 1546.4425304549911, -1739.4826817188048, -1240.7774899251192, 3166.8179879418017, -773.0202490083162, -1153.020249008309, -1751.5034969990666, 1248.0434687942386, 503.4600282048253, -802.5661966467372, -891.6616510762431, 1694.2278477229802, 2306.526016182947, -766.1554979850454, 366.62911170578104, -1906.9996299036432, -1231.7800128269498, -154.1492782986678, 1385.929291125618, -1122.8855685242295, 1904.0155108391568, -781.1299423149112, -36.0, 36.0, -1327.866132241394, 1459.1953450499295, 1664.7320408814408, -1796.0612536901099, -615.0, 615.0, 241.0, -241.0, -950.2267109833178, -598.2267109833025, -1395.941118797645, 2944.3945407643223, -1320.0047846798498, 1703.0012247969898, 373.1503432088434, -756.1467833260474, -621.8121921400285, -859.8121921400398, -309.8994532381713, 1791.523837518168, 723.3702371538433, -982.171319068086, 258.8010819142778, -956.0083681642193, 2516.593034242867, -1560.5846660786356, 1961.514211011498, -953.1799410394725, -1008.3342699720242, -1193.6834791575393, -672.3125908633527, -757.2066756502045, 2623.202745671082, 2202.6376233960573, -962.3723291948884, -1240.265294201179, 1309.096403107504, -826.4315780650012, -1613.5493977236936, 1130.8845726812385, -823.0722933011467, 717.0062761231643, 106.06601717798236, 1864.12229202571, -693.671752344008, -1170.4505396816871, -833.6405529398547, -1049.5813375024413, -825.6405529398544, 2708.8624433820887, 1924.03755160861, -400.9295449327751, -1523.1080066757543, 1917.6078507516306, 583.2050029583609, -1618.2991693229285, -882.5136843870046, -1119.2193775424141, -381.8913223506436, -919.9817732353896, 2421.092473128398, -941.0, 941.0, -1439.6694064957544, 2435.982861187613, -996.3134546918528, 1967.8781720421769, -1205.617061923043, -762.2611101191037, -1510.3800846144686, 2151.0188283694997, -640.6387437550165, 287.08535316173936, -705.6925676241794, 418.6072144624378, -725.2074730968402, 2907.4804206443664, -1307.0654744506455, -875.2074730968476, -130.81475451951172, -224.1528496361368, 354.9676041556485, 1617.1811154446307, 65.21756897391248, -516.7515023692303, -1165.6471820493566, -1307.4404384138902, 1683.6212460052038, -376.18080759124564, -209.0, 209.0, -688.0, 688.0, 369.0, -369.0, 656.0, -656.0, -1535.1288219559237, -629.3250352560317, 2164.45385721202, 865.5019936166171, 1434.122390663395, -1328.955785679457, -970.668598600592, 975.4280181821033, 792.5220289497047, -986.975023565953, -780.975023565943, -583.4887079529473, -874.4732436245287, 2661.949677035621, -1203.9877254581554, 0.0, 0.0, 0.0, 0.0, 610.9402589451813, -1520.9866863322604, 910.0464273870928, 592.0, -592.0, 0.0, 0.0, -1218.9787971240012, -1096.5805400557947, -576.5805400557887, 2892.1398772355437, -877.3147695281124, -234.6618489311337, 2501.978427027719, -1390.001808568438, -537.6380400399835, 585.5995642670501, -2067.080355007619, 2019.1188307804955, -1054.2962107491453, 2314.3604948235447, -1260.0642840743988, -498.64856326746315, 1526.8669586801802, 59.95903918048661, -1088.1774345932445, -687.4228634059859, 2296.2654004313986, -453.42126851271723, -1155.4212685127172, -1031.6687937511792, -1262.8927111991445, 2294.5615049503244, -2276.1767286395266, 1601.5968593875423, 674.5798692519711, -356.0, 356.0, -1242.0335346719685, -408.0335346719866, 2905.957010476538, -1255.889941132517, -282.1356056934341, 1830.6994564919855, -1548.563850798466, 2131.6793355032146, -1162.8855838030393, 94.7875858022104, -1063.5813375024386, -454.0, 454.0, -691.0, 691.0, 0.0, 0.0, 543.0, -543.0, 446.0, -446.0, 327.0, -327.0, 0.0, 0.0, -1268.7108479315254, -1093.1963660979138, -477.19636609790257, 2839.1035801273742, 846.4068170803625, 36.06244584051896, -882.4692629208178, 564.0, -564.0, -338.704148188358, -818.1225458328414, 1156.8266940212495, 1417.7490962790532, 980.7571055057485, -2398.50620178484, 1209.8597026101913, 7.071067811864664, -1216.9307704220266, -735.0, 735.0, -1101.0712129982778, 1277.740395370261, -1435.934369128194, 1259.2651867562504, 571.0, -571.0, -449.0, 449.0, 2103.6563240586884, -649.888346239254, -1261.8796315802203, -191.8883462392413, -1211.9462735738266, -708.3207217508907, -1089.548016505644, 3009.8150118303874, -1438.2551929333815, 2547.7057326150702, -1109.4505396816876, 1980.6060941035344, -1065.609919248128, -914.9961748553992, -1462.2968234937205, -367.6955262170071, 1829.9923497107984, -617.9305955702237, -111.84014468548094, -405.4656965084324, 1135.236436764103, 537.6537180435759, 1513.0944381179345, -580.0964031075313, -1470.651753053982, 819.2438661764253, 657.9021997223067, -1477.1460658986357, 0.0, 0.0, -654.0, 654.0, -1275.6206332605032, 2540.634664803202, -1265.0140315426993, -659.0, 659.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.404574087097883, "mean_inference_ms": 4.731091611217576, "mean_action_processing_ms": 0.9678206393335139, "mean_env_wait_ms": 19.46175642937271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018360614776611328, "StateBufferConnector_ms": 0.015031576156616211, "ViewRequirementAgentConnector_ms": 0.6063613891601562}, "num_episodes": 13, "episode_return_max": 4.298783551348606e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.450373154909812e-13, "episodes_this_iter": 13}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 1190302, "num_agent_steps_trained": 770681, "num_env_steps_sampled": 383488, "num_env_steps_trained": 770681, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 49144, "num_env_steps_sampled_throughput_per_sec": 2559.973083779098, "num_env_steps_trained_throughput_per_sec": 4914.348329267187, "timesteps_total": 383488, "num_env_steps_sampled_lifetime": 383488, "num_agent_steps_sampled_lifetime": 1190302, "num_steps_trained_this_iter": 49144, "agent_timesteps_total": 1190302, "timers": {"training_iteration_time_ms": 10000.11, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.155, "sample_time_ms": 0.11, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 383488, "num_env_steps_trained": 770681, "num_agent_steps_sampled": 1190302, "num_agent_steps_trained": 770681, "num_training_step_calls_since_last_synch_worker_weights": 44564, "num_samples_added_to_queue": 249856, "num_times_learner_queue_full": 32, "num_weight_broadcasts": 16, "total_num_restored_workers": 3}, "done": false, "training_iteration": 16, "trial_id": "de35c_00000", "date": "2024-09-02_13-13-29", "timestamp": 1725250409, "time_this_iter_s": 47.37521433830261, "time_total_s": 775.5223190784454, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 775.5223190784454, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 48.23582089552239, "ram_util_percent": 64.07014925373136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 21661.240234375, "policy_loss": -7111.6796875, "entropy": 12.941659927368164, "entropy_coeff": 0.01, "var_gnorm": 2048.534423828125, "vf_loss": 58606.01953125, "vf_explained_var": -0.016342997550964355}, "model": {}, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 409088, "num_env_steps_trained": 817279, "num_agent_steps_sampled": 1262502, "num_agent_steps_trained": 817279, "num_training_step_calls_since_last_synch_worker_weights": 43262, "num_samples_added_to_queue": 266240, "num_times_learner_queue_full": 34, "num_weight_broadcasts": 17, "total_num_restored_workers": 3, "learner_queue": {"size_count": 65, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 136.207, "learner_load_time_ms": 1053.022, "learner_load_wait_time_ms": 9710.107, "learner_dequeue_time_ms": 83048.777}}, "env_runners": {"episode_reward_max": 4.298783551348606e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.326494469822137e-13, "episode_len_mean": 1771.53, "episode_media": {}, "episodes_timesteps_total": 177153, "policy_reward_min": {"default_policy": -2398.50620178484}, "policy_reward_max": {"default_policy": 3009.8150118303874}, "policy_reward_mean": {"default_policy": 1.3034062866545143e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.7067237340361316e-13, 2.220446049250313e-16, 3.5793590313915047e-13, 2.3225865675158275e-13, 0.0, 7.016609515630989e-14, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, -2.220446049250313e-16, 3.8125058665627876e-13, 4.2676973066591017e-13, 4.1167069753100805e-13, 2.220446049250313e-16, 3.894662370385049e-13, 2.220446049250313e-16, 1.6120438317557273e-13, 3.04867242562068e-13, 1.7985612998927536e-14, 4.078959392472825e-13, 1.1524114995609125e-13, 2.220446049250313e-16, 0.0, 4.056754931980322e-13, 3.3217872896784684e-13, 3.999023334699814e-13, 2.666755705149626e-13, 2.220446049250313e-16, 6.061817714453355e-14, 2.220446049250313e-16, 3.54605234065275e-13, 0.0, 0.0, 0.0, 0.0, 3.9901415505028126e-13, -2.220446049250313e-16, -2.220446049250313e-16, -3.3306690738754696e-16, 0.0, 0.0, 3.623767952376511e-13, 0.0, 0.0, 2.220446049250313e-16, -3.3306690738754696e-16, 3.3306690738754696e-16, 3.7414515929867775e-13, 1.1879386363489175e-13, -2.220446049250313e-16, 3.723688024592775e-13, 4.1611158962950867e-13, 0.0, 1.1102230246251565e-16, 3.5371705564557487e-13, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 4.276579090856103e-13, 0.0, 3.936850845320805e-13, 4.298783551348606e-13, 3.5438318946034997e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 2.220446049250313e-16, 4.1722181265413383e-13, 3.1885605267234496e-13, 4.0811798385220754e-13, -2.220446049250313e-16, 2.220446049250313e-16, 3.519406988061746e-13, 0.0, 0.0, 4.107825191113079e-13, 0.0, 0.0, 1.1102230246251565e-16, 8.08242361927114e-14, 3.9812597663058114e-13, 3.1907809727727e-13, 4.0811798385220754e-13, 0.0, 3.788080960021034e-13, -2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 4.0234482412415673e-13, 0.0], "episode_lengths": [2048, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 1025, 2048, 2048, 2048, 2049, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2047, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1025, 2048, 2048, 2048], "policy_default_policy_reward": [-802.5661966467372, -891.6616510762431, 1694.2278477229802, 2306.526016182947, -766.1554979850454, 366.62911170578104, -1906.9996299036432, -1231.7800128269498, -154.1492782986678, 1385.929291125618, -1122.8855685242295, 1904.0155108391568, -781.1299423149112, -36.0, 36.0, -1327.866132241394, 1459.1953450499295, 1664.7320408814408, -1796.0612536901099, -615.0, 615.0, 241.0, -241.0, -950.2267109833178, -598.2267109833025, -1395.941118797645, 2944.3945407643223, -1320.0047846798498, 1703.0012247969898, 373.1503432088434, -756.1467833260474, -621.8121921400285, -859.8121921400398, -309.8994532381713, 1791.523837518168, 723.3702371538433, -982.171319068086, 258.8010819142778, -956.0083681642193, 2516.593034242867, -1560.5846660786356, 1961.514211011498, -953.1799410394725, -1008.3342699720242, -1193.6834791575393, -672.3125908633527, -757.2066756502045, 2623.202745671082, 2202.6376233960573, -962.3723291948884, -1240.265294201179, 1309.096403107504, -826.4315780650012, -1613.5493977236936, 1130.8845726812385, -823.0722933011467, 717.0062761231643, 106.06601717798236, 1864.12229202571, -693.671752344008, -1170.4505396816871, -833.6405529398547, -1049.5813375024413, -825.6405529398544, 2708.8624433820887, 1924.03755160861, -400.9295449327751, -1523.1080066757543, 1917.6078507516306, 583.2050029583609, -1618.2991693229285, -882.5136843870046, -1119.2193775424141, -381.8913223506436, -919.9817732353896, 2421.092473128398, -941.0, 941.0, -1439.6694064957544, 2435.982861187613, -996.3134546918528, 1967.8781720421769, -1205.617061923043, -762.2611101191037, -1510.3800846144686, 2151.0188283694997, -640.6387437550165, 287.08535316173936, -705.6925676241794, 418.6072144624378, -725.2074730968402, 2907.4804206443664, -1307.0654744506455, -875.2074730968476, -130.81475451951172, -224.1528496361368, 354.9676041556485, 1617.1811154446307, 65.21756897391248, -516.7515023692303, -1165.6471820493566, -1307.4404384138902, 1683.6212460052038, -376.18080759124564, -209.0, 209.0, -688.0, 688.0, 369.0, -369.0, 656.0, -656.0, -1535.1288219559237, -629.3250352560317, 2164.45385721202, 865.5019936166171, 1434.122390663395, -1328.955785679457, -970.668598600592, 975.4280181821033, 792.5220289497047, -986.975023565953, -780.975023565943, -583.4887079529473, -874.4732436245287, 2661.949677035621, -1203.9877254581554, 0.0, 0.0, 0.0, 0.0, 610.9402589451813, -1520.9866863322604, 910.0464273870928, 592.0, -592.0, 0.0, 0.0, -1218.9787971240012, -1096.5805400557947, -576.5805400557887, 2892.1398772355437, -877.3147695281124, -234.6618489311337, 2501.978427027719, -1390.001808568438, -537.6380400399835, 585.5995642670501, -2067.080355007619, 2019.1188307804955, -1054.2962107491453, 2314.3604948235447, -1260.0642840743988, -498.64856326746315, 1526.8669586801802, 59.95903918048661, -1088.1774345932445, -687.4228634059859, 2296.2654004313986, -453.42126851271723, -1155.4212685127172, -1031.6687937511792, -1262.8927111991445, 2294.5615049503244, -2276.1767286395266, 1601.5968593875423, 674.5798692519711, -356.0, 356.0, -1242.0335346719685, -408.0335346719866, 2905.957010476538, -1255.889941132517, -282.1356056934341, 1830.6994564919855, -1548.563850798466, 2131.6793355032146, -1162.8855838030393, 94.7875858022104, -1063.5813375024386, -454.0, 454.0, -691.0, 691.0, 0.0, 0.0, 543.0, -543.0, 446.0, -446.0, 327.0, -327.0, 0.0, 0.0, -1268.7108479315254, -1093.1963660979138, -477.19636609790257, 2839.1035801273742, 846.4068170803625, 36.06244584051896, -882.4692629208178, 564.0, -564.0, -338.704148188358, -818.1225458328414, 1156.8266940212495, 1417.7490962790532, 980.7571055057485, -2398.50620178484, 1209.8597026101913, 7.071067811864664, -1216.9307704220266, -735.0, 735.0, -1101.0712129982778, 1277.740395370261, -1435.934369128194, 1259.2651867562504, 571.0, -571.0, -449.0, 449.0, 2103.6563240586884, -649.888346239254, -1261.8796315802203, -191.8883462392413, -1211.9462735738266, -708.3207217508907, -1089.548016505644, 3009.8150118303874, -1438.2551929333815, 2547.7057326150702, -1109.4505396816876, 1980.6060941035344, -1065.609919248128, -914.9961748553992, -1462.2968234937205, -367.6955262170071, 1829.9923497107984, -617.9305955702237, -111.84014468548094, -405.4656965084324, 1135.236436764103, 537.6537180435759, 1513.0944381179345, -580.0964031075313, -1470.651753053982, 819.2438661764253, 657.9021997223067, -1477.1460658986357, 0.0, 0.0, -654.0, 654.0, -1275.6206332605032, 2540.634664803202, -1265.0140315426993, -659.0, 659.0, 891.0, -891.0, -990.0275824492198, -436.02758244919625, 1099.9803920172387, 326.07477288108703, 168.2914139223988, -272.9432175380083, 104.6518036156089, 1619.9816356983927, -2183.545740304062, 563.5641046056822, 1230.365799264613, -345.7752160002233, -884.5905832643768, -608.1118318204364, -648.4169183480693, 1256.5287501685032, 1420.0, -1420.0, -1425.5272708720256, -767.9179643685961, 2193.4452352406643, 384.96588155654285, 966.0337483471518, 424.2256998614372, -1775.2253297651098, -259.0, 259.0, -157.0, 157.0, -6.911941455215475, -1009.2245323185708, 2233.2071030005895, -1217.0706292268083, 1988.384268696587, -1855.4481938334006, -132.93607486307147, 706.0, -706.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.41389669315324, "mean_inference_ms": 4.723054493867359, "mean_action_processing_ms": 0.9642798728301115, "mean_env_wait_ms": 19.382542599146394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018656492233276367, "StateBufferConnector_ms": 0.015191793441772461, "ViewRequirementAgentConnector_ms": 0.6161510944366455}, "num_episodes": 14, "episode_return_max": 4.298783551348606e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.326494469822137e-13, "episodes_this_iter": 14}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 1262502, "num_agent_steps_trained": 817279, "num_env_steps_sampled": 409088, "num_env_steps_trained": 817279, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 46598, "num_env_steps_sampled_throughput_per_sec": 2559.9494028555164, "num_env_steps_trained_throughput_per_sec": 4659.707901338334, "timesteps_total": 409088, "num_env_steps_sampled_lifetime": 409088, "num_agent_steps_sampled_lifetime": 1262502, "num_steps_trained_this_iter": 46598, "agent_timesteps_total": 1262502, "timers": {"training_iteration_time_ms": 10000.119, "restore_workers_time_ms": 0.009, "training_step_time_ms": 0.175, "sample_time_ms": 0.122, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 409088, "num_env_steps_trained": 817279, "num_agent_steps_sampled": 1262502, "num_agent_steps_trained": 817279, "num_training_step_calls_since_last_synch_worker_weights": 43262, "num_samples_added_to_queue": 266240, "num_times_learner_queue_full": 34, "num_weight_broadcasts": 17, "total_num_restored_workers": 3}, "done": false, "training_iteration": 17, "trial_id": "de35c_00000", "date": "2024-09-02_13-14-17", "timestamp": 1725250457, "time_this_iter_s": 48.184751987457275, "time_total_s": 823.7070710659027, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 823.7070710659027, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 53.985507246376805, "ram_util_percent": 63.82753623188406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 43608.109375, "policy_loss": 12503.80859375, "entropy": 12.706090927124023, "entropy_coeff": 0.01, "var_gnorm": 2048.534423828125, "vf_loss": 63249.48046875, "vf_explained_var": 0.16058683395385742}, "model": {}, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 434688, "num_env_steps_trained": 862849, "num_agent_steps_sampled": 1338269, "num_agent_steps_trained": 862849, "num_training_step_calls_since_last_synch_worker_weights": 43534, "num_samples_added_to_queue": 282624, "num_times_learner_queue_full": 37, "num_weight_broadcasts": 18, "total_num_restored_workers": 3, "learner_queue": {"size_count": 69, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 123.17, "learner_load_time_ms": 1053.022, "learner_load_wait_time_ms": 9640.998, "learner_dequeue_time_ms": 83048.777}}, "env_runners": {"episode_reward_max": 4.298783551348606e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.2257084236466653e-13, "episode_len_mean": 1781.79, "episode_media": {}, "episodes_timesteps_total": 178179, "policy_reward_min": {"default_policy": -2398.50620178484}, "policy_reward_max": {"default_policy": 3015.2213997861286}, "policy_reward_mean": {"default_policy": 1.3066199568278884e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.1167069753100805e-13, 2.220446049250313e-16, 3.894662370385049e-13, 2.220446049250313e-16, 1.6120438317557273e-13, 3.04867242562068e-13, 1.7985612998927536e-14, 4.078959392472825e-13, 1.1524114995609125e-13, 2.220446049250313e-16, 0.0, 4.056754931980322e-13, 3.3217872896784684e-13, 3.999023334699814e-13, 2.666755705149626e-13, 2.220446049250313e-16, 6.061817714453355e-14, 2.220446049250313e-16, 3.54605234065275e-13, 0.0, 0.0, 0.0, 0.0, 3.9901415505028126e-13, -2.220446049250313e-16, -2.220446049250313e-16, -3.3306690738754696e-16, 0.0, 0.0, 3.623767952376511e-13, 0.0, 0.0, 2.220446049250313e-16, -3.3306690738754696e-16, 3.3306690738754696e-16, 3.7414515929867775e-13, 1.1879386363489175e-13, -2.220446049250313e-16, 3.723688024592775e-13, 4.1611158962950867e-13, 0.0, 1.1102230246251565e-16, 3.5371705564557487e-13, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 4.276579090856103e-13, 0.0, 3.936850845320805e-13, 4.298783551348606e-13, 3.5438318946034997e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 2.220446049250313e-16, 4.1722181265413383e-13, 3.1885605267234496e-13, 4.0811798385220754e-13, -2.220446049250313e-16, 2.220446049250313e-16, 3.519406988061746e-13, 0.0, 0.0, 4.107825191113079e-13, 0.0, 0.0, 1.1102230246251565e-16, 8.08242361927114e-14, 3.9812597663058114e-13, 3.1907809727727e-13, 4.0811798385220754e-13, 0.0, 3.788080960021034e-13, -2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 4.0234482412415673e-13, 0.0, 2.220446049250313e-16, 3.943512183468556e-13, -2.220446049250313e-16, -2.220446049250313e-16, 0.0, 3.3706371027619753e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 1025, 2048, 2048, 2048, 2049, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2047, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1026, 2048, 2048, 2048], "policy_default_policy_reward": [1961.514211011498, -953.1799410394725, -1008.3342699720242, -1193.6834791575393, -672.3125908633527, -757.2066756502045, 2623.202745671082, 2202.6376233960573, -962.3723291948884, -1240.265294201179, 1309.096403107504, -826.4315780650012, -1613.5493977236936, 1130.8845726812385, -823.0722933011467, 717.0062761231643, 106.06601717798236, 1864.12229202571, -693.671752344008, -1170.4505396816871, -833.6405529398547, -1049.5813375024413, -825.6405529398544, 2708.8624433820887, 1924.03755160861, -400.9295449327751, -1523.1080066757543, 1917.6078507516306, 583.2050029583609, -1618.2991693229285, -882.5136843870046, -1119.2193775424141, -381.8913223506436, -919.9817732353896, 2421.092473128398, -941.0, 941.0, -1439.6694064957544, 2435.982861187613, -996.3134546918528, 1967.8781720421769, -1205.617061923043, -762.2611101191037, -1510.3800846144686, 2151.0188283694997, -640.6387437550165, 287.08535316173936, -705.6925676241794, 418.6072144624378, -725.2074730968402, 2907.4804206443664, -1307.0654744506455, -875.2074730968476, -130.81475451951172, -224.1528496361368, 354.9676041556485, 1617.1811154446307, 65.21756897391248, -516.7515023692303, -1165.6471820493566, -1307.4404384138902, 1683.6212460052038, -376.18080759124564, -209.0, 209.0, -688.0, 688.0, 369.0, -369.0, 656.0, -656.0, -1535.1288219559237, -629.3250352560317, 2164.45385721202, 865.5019936166171, 1434.122390663395, -1328.955785679457, -970.668598600592, 975.4280181821033, 792.5220289497047, -986.975023565953, -780.975023565943, -583.4887079529473, -874.4732436245287, 2661.949677035621, -1203.9877254581554, 0.0, 0.0, 0.0, 0.0, 610.9402589451813, -1520.9866863322604, 910.0464273870928, 592.0, -592.0, 0.0, 0.0, -1218.9787971240012, -1096.5805400557947, -576.5805400557887, 2892.1398772355437, -877.3147695281124, -234.6618489311337, 2501.978427027719, -1390.001808568438, -537.6380400399835, 585.5995642670501, -2067.080355007619, 2019.1188307804955, -1054.2962107491453, 2314.3604948235447, -1260.0642840743988, -498.64856326746315, 1526.8669586801802, 59.95903918048661, -1088.1774345932445, -687.4228634059859, 2296.2654004313986, -453.42126851271723, -1155.4212685127172, -1031.6687937511792, -1262.8927111991445, 2294.5615049503244, -2276.1767286395266, 1601.5968593875423, 674.5798692519711, -356.0, 356.0, -1242.0335346719685, -408.0335346719866, 2905.957010476538, -1255.889941132517, -282.1356056934341, 1830.6994564919855, -1548.563850798466, 2131.6793355032146, -1162.8855838030393, 94.7875858022104, -1063.5813375024386, -454.0, 454.0, -691.0, 691.0, 0.0, 0.0, 543.0, -543.0, 446.0, -446.0, 327.0, -327.0, 0.0, 0.0, -1268.7108479315254, -1093.1963660979138, -477.19636609790257, 2839.1035801273742, 846.4068170803625, 36.06244584051896, -882.4692629208178, 564.0, -564.0, -338.704148188358, -818.1225458328414, 1156.8266940212495, 1417.7490962790532, 980.7571055057485, -2398.50620178484, 1209.8597026101913, 7.071067811864664, -1216.9307704220266, -735.0, 735.0, -1101.0712129982778, 1277.740395370261, -1435.934369128194, 1259.2651867562504, 571.0, -571.0, -449.0, 449.0, 2103.6563240586884, -649.888346239254, -1261.8796315802203, -191.8883462392413, -1211.9462735738266, -708.3207217508907, -1089.548016505644, 3009.8150118303874, -1438.2551929333815, 2547.7057326150702, -1109.4505396816876, 1980.6060941035344, -1065.609919248128, -914.9961748553992, -1462.2968234937205, -367.6955262170071, 1829.9923497107984, -617.9305955702237, -111.84014468548094, -405.4656965084324, 1135.236436764103, 537.6537180435759, 1513.0944381179345, -580.0964031075313, -1470.651753053982, 819.2438661764253, 657.9021997223067, -1477.1460658986357, 0.0, 0.0, -654.0, 654.0, -1275.6206332605032, 2540.634664803202, -1265.0140315426993, -659.0, 659.0, 891.0, -891.0, -990.0275824492198, -436.02758244919625, 1099.9803920172387, 326.07477288108703, 168.2914139223988, -272.9432175380083, 104.6518036156089, 1619.9816356983927, -2183.545740304062, 563.5641046056822, 1230.365799264613, -345.7752160002233, -884.5905832643768, -608.1118318204364, -648.4169183480693, 1256.5287501685032, 1420.0, -1420.0, -1425.5272708720256, -767.9179643685961, 2193.4452352406643, 384.96588155654285, 966.0337483471518, 424.2256998614372, -1775.2253297651098, -259.0, 259.0, -157.0, 157.0, -6.911941455215475, -1009.2245323185708, 2233.2071030005895, -1217.0706292268083, 1988.384268696587, -1855.4481938334006, -132.93607486307147, 706.0, -706.0, 2030.38322009011, -709.4058041842959, -595.4058041842906, -725.5716117216061, -250.31580054003925, 309.71277015970963, -59.396969619642974, 1214.7419902635652, -1247.1446046612896, -317.4746248426167, 349.8772392402758, 3015.2213997861286, -1026.8270726970147, -955.2356393174985, -1033.158687771633, 1523.0, -1523.0, 810.3443712397893, -2015.2543263816542, 1204.909955141886, -1804.0, 1804.0, -321.0, 321.0, -1501.0, 1501.0, 605.0, -605.0, 1140.0, -1140.0, 897.0, -897.0, -1112.0, 1112.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.41426003512156, "mean_inference_ms": 4.720756963740659, "mean_action_processing_ms": 0.9648762156093906, "mean_env_wait_ms": 19.333156364892332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018764495849609375, "StateBufferConnector_ms": 0.01517033576965332, "ViewRequirementAgentConnector_ms": 0.6118357181549072}, "num_episodes": 13, "episode_return_max": 4.298783551348606e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.2257084236466653e-13, "episodes_this_iter": 13}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 1338269, "num_agent_steps_trained": 862849, "num_env_steps_sampled": 434688, "num_env_steps_trained": 862849, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 45570, "num_env_steps_sampled_throughput_per_sec": 2559.955872342689, "num_env_steps_trained_throughput_per_sec": 4556.921449322513, "timesteps_total": 434688, "num_env_steps_sampled_lifetime": 434688, "num_agent_steps_sampled_lifetime": 1338269, "num_steps_trained_this_iter": 45570, "agent_timesteps_total": 1338269, "timers": {"training_iteration_time_ms": 10000.135, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.148, "sample_time_ms": 0.107, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 434688, "num_env_steps_trained": 862849, "num_agent_steps_sampled": 1338269, "num_agent_steps_trained": 862849, "num_training_step_calls_since_last_synch_worker_weights": 43534, "num_samples_added_to_queue": 282624, "num_times_learner_queue_full": 37, "num_weight_broadcasts": 18, "total_num_restored_workers": 3}, "done": false, "training_iteration": 18, "trial_id": "de35c_00000", "date": "2024-09-02_13-15-05", "timestamp": 1725250505, "time_this_iter_s": 47.392268657684326, "time_total_s": 871.099339723587, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 871.099339723587, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 50.30298507462687, "ram_util_percent": 63.98208955223881}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 45532.5, "policy_loss": 20161.17578125, "entropy": 12.797018051147461, "entropy_coeff": 0.01, "var_gnorm": 2048.53466796875, "vf_loss": 51790.984375, "vf_explained_var": 0.16357344388961792}, "model": {}, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 460288, "num_env_steps_trained": 913017, "num_agent_steps_sampled": 1418133, "num_agent_steps_trained": 913017, "num_training_step_calls_since_last_synch_worker_weights": 42604, "num_samples_added_to_queue": 299008, "num_times_learner_queue_full": 39, "num_weight_broadcasts": 19, "total_num_restored_workers": 3, "learner_queue": {"size_count": 73, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 122.574, "learner_load_time_ms": 1042.316, "learner_load_wait_time_ms": 9662.847, "learner_dequeue_time_ms": 83880.947}}, "env_runners": {"episode_reward_max": 4.298783551348606e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.159494722458021e-13, "episode_len_mean": 1761.3, "episode_media": {}, "episodes_timesteps_total": 176130, "policy_reward_min": {"default_policy": -2398.50620178484}, "policy_reward_max": {"default_policy": 3284.4102187679728}, "policy_reward_mean": {"default_policy": 1.833886299523172e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.666755705149626e-13, 2.220446049250313e-16, 6.061817714453355e-14, 2.220446049250313e-16, 3.54605234065275e-13, 0.0, 0.0, 0.0, 0.0, 3.9901415505028126e-13, -2.220446049250313e-16, -2.220446049250313e-16, -3.3306690738754696e-16, 0.0, 0.0, 3.623767952376511e-13, 0.0, 0.0, 2.220446049250313e-16, -3.3306690738754696e-16, 3.3306690738754696e-16, 3.7414515929867775e-13, 1.1879386363489175e-13, -2.220446049250313e-16, 3.723688024592775e-13, 4.1611158962950867e-13, 0.0, 1.1102230246251565e-16, 3.5371705564557487e-13, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 4.276579090856103e-13, 0.0, 3.936850845320805e-13, 4.298783551348606e-13, 3.5438318946034997e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 2.220446049250313e-16, 4.1722181265413383e-13, 3.1885605267234496e-13, 4.0811798385220754e-13, -2.220446049250313e-16, 2.220446049250313e-16, 3.519406988061746e-13, 0.0, 0.0, 4.107825191113079e-13, 0.0, 0.0, 1.1102230246251565e-16, 8.08242361927114e-14, 3.9812597663058114e-13, 3.1907809727727e-13, 4.0811798385220754e-13, 0.0, 3.788080960021034e-13, -2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 4.0234482412415673e-13, 0.0, 2.220446049250313e-16, 3.943512183468556e-13, -2.220446049250313e-16, -2.220446049250313e-16, 0.0, 3.3706371027619753e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 3.781419621873283e-13, 0.0, 3.6770586575585185e-13, 3.3928415632544784e-13, -2.220446049250313e-16, 4.156675004196586e-13, 0.0, 2.220446049250313e-16, 4.2943426592501055e-13, 3.54605234065275e-13, -2.220446049250313e-16, 2.220446049250313e-16], "episode_lengths": [2048, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 1025, 2048, 2048, 2048, 2049, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2047, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1026, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2047, 2048, 2048, 2048], "policy_default_policy_reward": [287.08535316173936, -705.6925676241794, 418.6072144624378, -725.2074730968402, 2907.4804206443664, -1307.0654744506455, -875.2074730968476, -130.81475451951172, -224.1528496361368, 354.9676041556485, 1617.1811154446307, 65.21756897391248, -516.7515023692303, -1165.6471820493566, -1307.4404384138902, 1683.6212460052038, -376.18080759124564, -209.0, 209.0, -688.0, 688.0, 369.0, -369.0, 656.0, -656.0, -1535.1288219559237, -629.3250352560317, 2164.45385721202, 865.5019936166171, 1434.122390663395, -1328.955785679457, -970.668598600592, 975.4280181821033, 792.5220289497047, -986.975023565953, -780.975023565943, -583.4887079529473, -874.4732436245287, 2661.949677035621, -1203.9877254581554, 0.0, 0.0, 0.0, 0.0, 610.9402589451813, -1520.9866863322604, 910.0464273870928, 592.0, -592.0, 0.0, 0.0, -1218.9787971240012, -1096.5805400557947, -576.5805400557887, 2892.1398772355437, -877.3147695281124, -234.6618489311337, 2501.978427027719, -1390.001808568438, -537.6380400399835, 585.5995642670501, -2067.080355007619, 2019.1188307804955, -1054.2962107491453, 2314.3604948235447, -1260.0642840743988, -498.64856326746315, 1526.8669586801802, 59.95903918048661, -1088.1774345932445, -687.4228634059859, 2296.2654004313986, -453.42126851271723, -1155.4212685127172, -1031.6687937511792, -1262.8927111991445, 2294.5615049503244, -2276.1767286395266, 1601.5968593875423, 674.5798692519711, -356.0, 356.0, -1242.0335346719685, -408.0335346719866, 2905.957010476538, -1255.889941132517, -282.1356056934341, 1830.6994564919855, -1548.563850798466, 2131.6793355032146, -1162.8855838030393, 94.7875858022104, -1063.5813375024386, -454.0, 454.0, -691.0, 691.0, 0.0, 0.0, 543.0, -543.0, 446.0, -446.0, 327.0, -327.0, 0.0, 0.0, -1268.7108479315254, -1093.1963660979138, -477.19636609790257, 2839.1035801273742, 846.4068170803625, 36.06244584051896, -882.4692629208178, 564.0, -564.0, -338.704148188358, -818.1225458328414, 1156.8266940212495, 1417.7490962790532, 980.7571055057485, -2398.50620178484, 1209.8597026101913, 7.071067811864664, -1216.9307704220266, -735.0, 735.0, -1101.0712129982778, 1277.740395370261, -1435.934369128194, 1259.2651867562504, 571.0, -571.0, -449.0, 449.0, 2103.6563240586884, -649.888346239254, -1261.8796315802203, -191.8883462392413, -1211.9462735738266, -708.3207217508907, -1089.548016505644, 3009.8150118303874, -1438.2551929333815, 2547.7057326150702, -1109.4505396816876, 1980.6060941035344, -1065.609919248128, -914.9961748553992, -1462.2968234937205, -367.6955262170071, 1829.9923497107984, -617.9305955702237, -111.84014468548094, -405.4656965084324, 1135.236436764103, 537.6537180435759, 1513.0944381179345, -580.0964031075313, -1470.651753053982, 819.2438661764253, 657.9021997223067, -1477.1460658986357, 0.0, 0.0, -654.0, 654.0, -1275.6206332605032, 2540.634664803202, -1265.0140315426993, -659.0, 659.0, 891.0, -891.0, -990.0275824492198, -436.02758244919625, 1099.9803920172387, 326.07477288108703, 168.2914139223988, -272.9432175380083, 104.6518036156089, 1619.9816356983927, -2183.545740304062, 563.5641046056822, 1230.365799264613, -345.7752160002233, -884.5905832643768, -608.1118318204364, -648.4169183480693, 1256.5287501685032, 1420.0, -1420.0, -1425.5272708720256, -767.9179643685961, 2193.4452352406643, 384.96588155654285, 966.0337483471518, 424.2256998614372, -1775.2253297651098, -259.0, 259.0, -157.0, 157.0, -6.911941455215475, -1009.2245323185708, 2233.2071030005895, -1217.0706292268083, 1988.384268696587, -1855.4481938334006, -132.93607486307147, 706.0, -706.0, 2030.38322009011, -709.4058041842959, -595.4058041842906, -725.5716117216061, -250.31580054003925, 309.71277015970963, -59.396969619642974, 1214.7419902635652, -1247.1446046612896, -317.4746248426167, 349.8772392402758, 3015.2213997861286, -1026.8270726970147, -955.2356393174985, -1033.158687771633, 1523.0, -1523.0, 810.3443712397893, -2015.2543263816542, 1204.909955141886, -1804.0, 1804.0, -321.0, 321.0, -1501.0, 1501.0, 605.0, -605.0, 1140.0, -1140.0, 897.0, -897.0, -1112.0, 1112.0, -748.0, 748.0, -1224.6916100450712, 2879.3774815426073, -520.0609034459914, -1134.6249680515052, 1754.3319241238378, -755.1900423072376, -999.141881816599, 1635.0, -1635.0, 1373.201369064285, -849.942350986236, -523.2590180780487, -980.0499987245621, 2110.71374184185, -1130.6637431172805, 2561.427648085885, -149.80921602863074, -1205.8092160286146, -1205.8092160286146, 2341.9376592898166, -712.763635436045, -1629.1740238537202, -7.0, 7.0, -1038.7885969240792, -1092.788596924071, -1152.8330249197832, 3284.4102187679728, 2073.2370824389695, -387.4945160902306, -1685.7425663486354, -1238.1439738576191, 2149.6046148071046, -911.4606409494664, -392.56645694546046, 1254.402244301406, -1157.041665559545, 295.2058782035067, -1490.0884858951129, -684.1075101064665, -646.1075101064646, 2820.303506108117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.431122596345016, "mean_inference_ms": 4.706992307860753, "mean_action_processing_ms": 0.9599425412834883, "mean_env_wait_ms": 19.2653685685874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019082069396972656, "StateBufferConnector_ms": 0.015206098556518555, "ViewRequirementAgentConnector_ms": 0.6176662445068359}, "num_episodes": 14, "episode_return_max": 4.298783551348606e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.159494722458021e-13, "episodes_this_iter": 14}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 1418133, "num_agent_steps_trained": 913017, "num_env_steps_sampled": 460288, "num_env_steps_trained": 913017, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 50168, "num_env_steps_sampled_throughput_per_sec": 2559.999694824255, "num_env_steps_trained_throughput_per_sec": 5016.799401950908, "timesteps_total": 460288, "num_env_steps_sampled_lifetime": 460288, "num_agent_steps_sampled_lifetime": 1418133, "num_steps_trained_this_iter": 50168, "agent_timesteps_total": 1418133, "timers": {"training_iteration_time_ms": 10000.124, "restore_workers_time_ms": 0.007, "training_step_time_ms": 0.164, "sample_time_ms": 0.115, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 460288, "num_env_steps_trained": 913017, "num_agent_steps_sampled": 1418133, "num_agent_steps_trained": 913017, "num_training_step_calls_since_last_synch_worker_weights": 42604, "num_samples_added_to_queue": 299008, "num_times_learner_queue_full": 39, "num_weight_broadcasts": 19, "total_num_restored_workers": 3}, "done": false, "training_iteration": 19, "trial_id": "de35c_00000", "date": "2024-09-02_13-15-54", "timestamp": 1725250554, "time_this_iter_s": 49.0714807510376, "time_total_s": 920.1708204746246, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 920.1708204746246, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 49.18857142857142, "ram_util_percent": 63.885714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 28519.0390625, "policy_loss": -6727.837890625, "entropy": 12.798397064208984, "entropy_coeff": 0.01, "var_gnorm": 2048.53466796875, "vf_loss": 71534.265625, "vf_explained_var": -0.1044158935546875}, "model": {}, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 485888, "num_env_steps_trained": 964314, "num_agent_steps_sampled": 1495442, "num_agent_steps_trained": 964314, "num_training_step_calls_since_last_synch_worker_weights": 43971, "num_samples_added_to_queue": 315392, "num_times_learner_queue_full": 41, "num_weight_broadcasts": 20, "total_num_restored_workers": 3, "learner_queue": {"size_count": 77, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 121.055, "learner_load_time_ms": 1042.316, "learner_load_wait_time_ms": 9765.806, "learner_dequeue_time_ms": 83880.947}}, "env_runners": {"episode_reward_max": 4.298783551348606e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.2182144182304455e-13, "episode_len_mean": 1792.0, "episode_media": {}, "episodes_timesteps_total": 179200, "policy_reward_min": {"default_policy": -2398.50620178484}, "policy_reward_max": {"default_policy": 3284.4102187679728}, "policy_reward_mean": {"default_policy": 1.697407646538017e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.623767952376511e-13, 0.0, 0.0, 2.220446049250313e-16, -3.3306690738754696e-16, 3.3306690738754696e-16, 3.7414515929867775e-13, 1.1879386363489175e-13, -2.220446049250313e-16, 3.723688024592775e-13, 4.1611158962950867e-13, 0.0, 1.1102230246251565e-16, 3.5371705564557487e-13, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 4.276579090856103e-13, 0.0, 3.936850845320805e-13, 4.298783551348606e-13, 3.5438318946034997e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 2.220446049250313e-16, 4.1722181265413383e-13, 3.1885605267234496e-13, 4.0811798385220754e-13, -2.220446049250313e-16, 2.220446049250313e-16, 3.519406988061746e-13, 0.0, 0.0, 4.107825191113079e-13, 0.0, 0.0, 1.1102230246251565e-16, 8.08242361927114e-14, 3.9812597663058114e-13, 3.1907809727727e-13, 4.0811798385220754e-13, 0.0, 3.788080960021034e-13, -2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 4.0234482412415673e-13, 0.0, 2.220446049250313e-16, 3.943512183468556e-13, -2.220446049250313e-16, -2.220446049250313e-16, 0.0, 3.3706371027619753e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 3.781419621873283e-13, 0.0, 3.6770586575585185e-13, 3.3928415632544784e-13, -2.220446049250313e-16, 4.156675004196586e-13, 0.0, 2.220446049250313e-16, 4.2943426592501055e-13, 3.54605234065275e-13, -2.220446049250313e-16, 2.220446049250313e-16, 4.269917752708352e-13, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 3.3306690738754696e-16, 9.248157795127554e-14, 4.0323300254385686e-13, 3.608224830031759e-13, 0.0, 2.353672812205332e-14, 3.601563491884008e-13, 0.0], "episode_lengths": [2048, 2048, 1025, 2048, 2048, 2048, 2049, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2047, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1026, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2047, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2046, 2048, 2048, 1024], "policy_default_policy_reward": [610.9402589451813, -1520.9866863322604, 910.0464273870928, 592.0, -592.0, 0.0, 0.0, -1218.9787971240012, -1096.5805400557947, -576.5805400557887, 2892.1398772355437, -877.3147695281124, -234.6618489311337, 2501.978427027719, -1390.001808568438, -537.6380400399835, 585.5995642670501, -2067.080355007619, 2019.1188307804955, -1054.2962107491453, 2314.3604948235447, -1260.0642840743988, -498.64856326746315, 1526.8669586801802, 59.95903918048661, -1088.1774345932445, -687.4228634059859, 2296.2654004313986, -453.42126851271723, -1155.4212685127172, -1031.6687937511792, -1262.8927111991445, 2294.5615049503244, -2276.1767286395266, 1601.5968593875423, 674.5798692519711, -356.0, 356.0, -1242.0335346719685, -408.0335346719866, 2905.957010476538, -1255.889941132517, -282.1356056934341, 1830.6994564919855, -1548.563850798466, 2131.6793355032146, -1162.8855838030393, 94.7875858022104, -1063.5813375024386, -454.0, 454.0, -691.0, 691.0, 0.0, 0.0, 543.0, -543.0, 446.0, -446.0, 327.0, -327.0, 0.0, 0.0, -1268.7108479315254, -1093.1963660979138, -477.19636609790257, 2839.1035801273742, 846.4068170803625, 36.06244584051896, -882.4692629208178, 564.0, -564.0, -338.704148188358, -818.1225458328414, 1156.8266940212495, 1417.7490962790532, 980.7571055057485, -2398.50620178484, 1209.8597026101913, 7.071067811864664, -1216.9307704220266, -735.0, 735.0, -1101.0712129982778, 1277.740395370261, -1435.934369128194, 1259.2651867562504, 571.0, -571.0, -449.0, 449.0, 2103.6563240586884, -649.888346239254, -1261.8796315802203, -191.8883462392413, -1211.9462735738266, -708.3207217508907, -1089.548016505644, 3009.8150118303874, -1438.2551929333815, 2547.7057326150702, -1109.4505396816876, 1980.6060941035344, -1065.609919248128, -914.9961748553992, -1462.2968234937205, -367.6955262170071, 1829.9923497107984, -617.9305955702237, -111.84014468548094, -405.4656965084324, 1135.236436764103, 537.6537180435759, 1513.0944381179345, -580.0964031075313, -1470.651753053982, 819.2438661764253, 657.9021997223067, -1477.1460658986357, 0.0, 0.0, -654.0, 654.0, -1275.6206332605032, 2540.634664803202, -1265.0140315426993, -659.0, 659.0, 891.0, -891.0, -990.0275824492198, -436.02758244919625, 1099.9803920172387, 326.07477288108703, 168.2914139223988, -272.9432175380083, 104.6518036156089, 1619.9816356983927, -2183.545740304062, 563.5641046056822, 1230.365799264613, -345.7752160002233, -884.5905832643768, -608.1118318204364, -648.4169183480693, 1256.5287501685032, 1420.0, -1420.0, -1425.5272708720256, -767.9179643685961, 2193.4452352406643, 384.96588155654285, 966.0337483471518, 424.2256998614372, -1775.2253297651098, -259.0, 259.0, -157.0, 157.0, -6.911941455215475, -1009.2245323185708, 2233.2071030005895, -1217.0706292268083, 1988.384268696587, -1855.4481938334006, -132.93607486307147, 706.0, -706.0, 2030.38322009011, -709.4058041842959, -595.4058041842906, -725.5716117216061, -250.31580054003925, 309.71277015970963, -59.396969619642974, 1214.7419902635652, -1247.1446046612896, -317.4746248426167, 349.8772392402758, 3015.2213997861286, -1026.8270726970147, -955.2356393174985, -1033.158687771633, 1523.0, -1523.0, 810.3443712397893, -2015.2543263816542, 1204.909955141886, -1804.0, 1804.0, -321.0, 321.0, -1501.0, 1501.0, 605.0, -605.0, 1140.0, -1140.0, 897.0, -897.0, -1112.0, 1112.0, -748.0, 748.0, -1224.6916100450712, 2879.3774815426073, -520.0609034459914, -1134.6249680515052, 1754.3319241238378, -755.1900423072376, -999.141881816599, 1635.0, -1635.0, 1373.201369064285, -849.942350986236, -523.2590180780487, -980.0499987245621, 2110.71374184185, -1130.6637431172805, 2561.427648085885, -149.80921602863074, -1205.8092160286146, -1205.8092160286146, 2341.9376592898166, -712.763635436045, -1629.1740238537202, -7.0, 7.0, -1038.7885969240792, -1092.788596924071, -1152.8330249197832, 3284.4102187679728, 2073.2370824389695, -387.4945160902306, -1685.7425663486354, -1238.1439738576191, 2149.6046148071046, -911.4606409494664, -392.56645694546046, 1254.402244301406, -1157.041665559545, 295.2058782035067, -1490.0884858951129, -684.1075101064665, -646.1075101064646, 2820.303506108117, 2719.5326804433744, -1359.7663402216872, -1359.7663402216872, 728.0, -728.0, -176.0, 176.0, -294.0, 294.0, -762.0, 762.0, -242.87048957088064, -1670.3881611911006, 73.12951042911936, 1840.1291403327984, 892.0, -892.0, 2088.339589540996, -420.9520121214365, -1525.3090309804816, -142.07854643915786, -719.1933899865163, -1033.3498109601219, 2989.1203066613652, -1236.577105714847, -127.98632739476612, -1553.5135982667712, 1681.499925661623, -890.2474375138698, 2168.6964978991386, -1278.4490603852462, -69.0, 69.0, 2571.0089281264645, -801.3169481928587, -1432.1288197161753, -337.56316021742816, -1653.9227611952567, 1786.8588360584192, -132.9360748630714, -821.0, 821.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.444460441394497, "mean_inference_ms": 4.703841247932013, "mean_action_processing_ms": 0.9605740409426761, "mean_env_wait_ms": 19.23172881039738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018743276596069336, "StateBufferConnector_ms": 0.01516413688659668, "ViewRequirementAgentConnector_ms": 0.6158857345581055}, "num_episodes": 15, "episode_return_max": 4.298783551348606e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.2182144182304455e-13, "episodes_this_iter": 15}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 1495442, "num_agent_steps_trained": 964314, "num_env_steps_sampled": 485888, "num_env_steps_trained": 964314, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 51297, "num_env_steps_sampled_throughput_per_sec": 2559.9827882016593, "num_env_steps_trained_throughput_per_sec": 5129.665511186739, "timesteps_total": 485888, "num_env_steps_sampled_lifetime": 485888, "num_agent_steps_sampled_lifetime": 1495442, "num_steps_trained_this_iter": 51297, "agent_timesteps_total": 1495442, "timers": {"training_iteration_time_ms": 10000.119, "restore_workers_time_ms": 0.007, "training_step_time_ms": 0.167, "sample_time_ms": 0.12, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 485888, "num_env_steps_trained": 964314, "num_agent_steps_sampled": 1495442, "num_agent_steps_trained": 964314, "num_training_step_calls_since_last_synch_worker_weights": 43971, "num_samples_added_to_queue": 315392, "num_times_learner_queue_full": 41, "num_weight_broadcasts": 20, "total_num_restored_workers": 3}, "done": false, "training_iteration": 20, "trial_id": "de35c_00000", "date": "2024-09-02_13-16-42", "timestamp": 1725250602, "time_this_iter_s": 48.64228963851929, "time_total_s": 968.8131101131439, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 968.8131101131439, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 50.93478260869565, "ram_util_percent": 63.87536231884056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 5011.904296875, "policy_loss": -17958.5078125, "entropy": 12.75343132019043, "entropy_coeff": 0.01, "var_gnorm": 2048.53466796875, "vf_loss": 46985.5859375, "vf_explained_var": -0.16903364658355713}, "model": {}, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 511488, "num_env_steps_trained": 1012435, "num_agent_steps_sampled": 1575811, "num_agent_steps_trained": 1012435, "num_training_step_calls_since_last_synch_worker_weights": 42627, "num_samples_added_to_queue": 331776, "num_times_learner_queue_full": 43, "num_weight_broadcasts": 21, "total_num_restored_workers": 3, "learner_queue": {"size_count": 81, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 136.152, "learner_load_time_ms": 1044.955, "learner_load_wait_time_ms": 9863.573, "learner_dequeue_time_ms": 89126.313}}, "env_runners": {"episode_reward_max": 4.298783551348606e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 1.2056688980521813e-13, "episode_len_mean": 1761.26, "episode_media": {}, "episodes_timesteps_total": 176126, "policy_reward_min": {"default_policy": -2398.50620178484}, "policy_reward_max": {"default_policy": 3284.4102187679728}, "policy_reward_mean": {"default_policy": 2.318102349640756e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 4.276579090856103e-13, 0.0, 3.936850845320805e-13, 4.298783551348606e-13, 3.5438318946034997e-13, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 2.220446049250313e-16, 4.1722181265413383e-13, 3.1885605267234496e-13, 4.0811798385220754e-13, -2.220446049250313e-16, 2.220446049250313e-16, 3.519406988061746e-13, 0.0, 0.0, 4.107825191113079e-13, 0.0, 0.0, 1.1102230246251565e-16, 8.08242361927114e-14, 3.9812597663058114e-13, 3.1907809727727e-13, 4.0811798385220754e-13, 0.0, 3.788080960021034e-13, -2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 4.0234482412415673e-13, 0.0, 2.220446049250313e-16, 3.943512183468556e-13, -2.220446049250313e-16, -2.220446049250313e-16, 0.0, 3.3706371027619753e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 3.781419621873283e-13, 0.0, 3.6770586575585185e-13, 3.3928415632544784e-13, -2.220446049250313e-16, 4.156675004196586e-13, 0.0, 2.220446049250313e-16, 4.2943426592501055e-13, 3.54605234065275e-13, -2.220446049250313e-16, 2.220446049250313e-16, 4.269917752708352e-13, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 3.3306690738754696e-16, 9.248157795127554e-14, 4.0323300254385686e-13, 3.608224830031759e-13, 0.0, 2.353672812205332e-14, 3.601563491884008e-13, 0.0, 0.0, 0.0, 4.249933738265099e-13, 1.7719159473017498e-13, 0.0, 2.220446049250313e-16, 1.1102230246251565e-16, 2.220446049250313e-14, 0.0, 4.118927421359331e-13, 4.2943426592501055e-13, 2.220446049250313e-16, -2.220446049250313e-16, 4.0611958240788226e-13], "episode_lengths": [2048, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 2048, 2048, 2047, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1026, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2047, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2046, 2048, 2048, 1024, 1024, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048], "policy_default_policy_reward": [2131.6793355032146, -1162.8855838030393, 94.7875858022104, -1063.5813375024386, -454.0, 454.0, -691.0, 691.0, 0.0, 0.0, 543.0, -543.0, 446.0, -446.0, 327.0, -327.0, 0.0, 0.0, -1268.7108479315254, -1093.1963660979138, -477.19636609790257, 2839.1035801273742, 846.4068170803625, 36.06244584051896, -882.4692629208178, 564.0, -564.0, -338.704148188358, -818.1225458328414, 1156.8266940212495, 1417.7490962790532, 980.7571055057485, -2398.50620178484, 1209.8597026101913, 7.071067811864664, -1216.9307704220266, -735.0, 735.0, -1101.0712129982778, 1277.740395370261, -1435.934369128194, 1259.2651867562504, 571.0, -571.0, -449.0, 449.0, 2103.6563240586884, -649.888346239254, -1261.8796315802203, -191.8883462392413, -1211.9462735738266, -708.3207217508907, -1089.548016505644, 3009.8150118303874, -1438.2551929333815, 2547.7057326150702, -1109.4505396816876, 1980.6060941035344, -1065.609919248128, -914.9961748553992, -1462.2968234937205, -367.6955262170071, 1829.9923497107984, -617.9305955702237, -111.84014468548094, -405.4656965084324, 1135.236436764103, 537.6537180435759, 1513.0944381179345, -580.0964031075313, -1470.651753053982, 819.2438661764253, 657.9021997223067, -1477.1460658986357, 0.0, 0.0, -654.0, 654.0, -1275.6206332605032, 2540.634664803202, -1265.0140315426993, -659.0, 659.0, 891.0, -891.0, -990.0275824492198, -436.02758244919625, 1099.9803920172387, 326.07477288108703, 168.2914139223988, -272.9432175380083, 104.6518036156089, 1619.9816356983927, -2183.545740304062, 563.5641046056822, 1230.365799264613, -345.7752160002233, -884.5905832643768, -608.1118318204364, -648.4169183480693, 1256.5287501685032, 1420.0, -1420.0, -1425.5272708720256, -767.9179643685961, 2193.4452352406643, 384.96588155654285, 966.0337483471518, 424.2256998614372, -1775.2253297651098, -259.0, 259.0, -157.0, 157.0, -6.911941455215475, -1009.2245323185708, 2233.2071030005895, -1217.0706292268083, 1988.384268696587, -1855.4481938334006, -132.93607486307147, 706.0, -706.0, 2030.38322009011, -709.4058041842959, -595.4058041842906, -725.5716117216061, -250.31580054003925, 309.71277015970963, -59.396969619642974, 1214.7419902635652, -1247.1446046612896, -317.4746248426167, 349.8772392402758, 3015.2213997861286, -1026.8270726970147, -955.2356393174985, -1033.158687771633, 1523.0, -1523.0, 810.3443712397893, -2015.2543263816542, 1204.909955141886, -1804.0, 1804.0, -321.0, 321.0, -1501.0, 1501.0, 605.0, -605.0, 1140.0, -1140.0, 897.0, -897.0, -1112.0, 1112.0, -748.0, 748.0, -1224.6916100450712, 2879.3774815426073, -520.0609034459914, -1134.6249680515052, 1754.3319241238378, -755.1900423072376, -999.141881816599, 1635.0, -1635.0, 1373.201369064285, -849.942350986236, -523.2590180780487, -980.0499987245621, 2110.71374184185, -1130.6637431172805, 2561.427648085885, -149.80921602863074, -1205.8092160286146, -1205.8092160286146, 2341.9376592898166, -712.763635436045, -1629.1740238537202, -7.0, 7.0, -1038.7885969240792, -1092.788596924071, -1152.8330249197832, 3284.4102187679728, 2073.2370824389695, -387.4945160902306, -1685.7425663486354, -1238.1439738576191, 2149.6046148071046, -911.4606409494664, -392.56645694546046, 1254.402244301406, -1157.041665559545, 295.2058782035067, -1490.0884858951129, -684.1075101064665, -646.1075101064646, 2820.303506108117, 2719.5326804433744, -1359.7663402216872, -1359.7663402216872, 728.0, -728.0, -176.0, 176.0, -294.0, 294.0, -762.0, 762.0, -242.87048957088064, -1670.3881611911006, 73.12951042911936, 1840.1291403327984, 892.0, -892.0, 2088.339589540996, -420.9520121214365, -1525.3090309804816, -142.07854643915786, -719.1933899865163, -1033.3498109601219, 2989.1203066613652, -1236.577105714847, -127.98632739476612, -1553.5135982667712, 1681.499925661623, -890.2474375138698, 2168.6964978991386, -1278.4490603852462, -69.0, 69.0, 2571.0089281264645, -801.3169481928587, -1432.1288197161753, -337.56316021742816, -1653.9227611952567, 1786.8588360584192, -132.9360748630714, -821.0, 821.0, 0.0, 0.0, 1872.0, -1872.0, 2534.2707037725136, -1262.892711199145, -1271.3779925733684, 843.5783899555573, 5.656854249492364, -849.2352442050492, -723.923262129352, 2681.6365024008146, -1003.8566201357589, -953.8566201357565, -1589.6273603913378, 1581.544456622775, -374.5182553916913, 382.6011591603401, 469.45001850479014, -1237.3258765270002, 1669.3453280886424, -901.4694700664877, 70.71067811865473, 70.71067811865473, -141.42135623730942, 0.0, 0.0, -1600.88975260628, -275.06453788156966, 1875.954290487925, 1902.1172413918264, -707.1067811865531, -1195.0104602052468, -1855.5452540693022, 2445.597229181223, -164.02598755590378, -426.0259875559007, 3098.003033365568, -1032.2437702050406, -1163.879631580252, -901.8796315802671, -1014.6982310027032, -1239.5581874199713, 2254.256418422677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.43919816146028, "mean_inference_ms": 4.692217714546357, "mean_action_processing_ms": 0.95652762879622, "mean_env_wait_ms": 19.171598025748448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01836371421813965, "StateBufferConnector_ms": 0.014975547790527344, "ViewRequirementAgentConnector_ms": 0.6126925945281982}, "num_episodes": 14, "episode_return_max": 4.298783551348606e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 1.2056688980521813e-13, "episodes_this_iter": 14}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 1575811, "num_agent_steps_trained": 1012435, "num_env_steps_sampled": 511488, "num_env_steps_trained": 1012435, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 48121, "num_env_steps_sampled_throughput_per_sec": 2559.984680267459, "num_env_steps_trained_throughput_per_sec": 4812.071203091813, "timesteps_total": 511488, "num_env_steps_sampled_lifetime": 511488, "num_agent_steps_sampled_lifetime": 1575811, "num_steps_trained_this_iter": 48121, "agent_timesteps_total": 1575811, "timers": {"training_iteration_time_ms": 10000.107, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.153, "sample_time_ms": 0.108, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 511488, "num_env_steps_trained": 1012435, "num_agent_steps_sampled": 1575811, "num_agent_steps_trained": 1012435, "num_training_step_calls_since_last_synch_worker_weights": 42627, "num_samples_added_to_queue": 331776, "num_times_learner_queue_full": 43, "num_weight_broadcasts": 21, "total_num_restored_workers": 3}, "done": false, "training_iteration": 21, "trial_id": "de35c_00000", "date": "2024-09-02_13-17-30", "timestamp": 1725250650, "time_this_iter_s": 47.282851457595825, "time_total_s": 1016.0959615707397, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1016.0959615707397, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 51.55820895522388, "ram_util_percent": 63.762686567164174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -6429.779296875, "policy_loss": -7334.3388671875, "entropy": 12.766485214233398, "entropy_coeff": 0.01, "var_gnorm": 2048.53466796875, "vf_loss": 2854.94921875, "vf_explained_var": 0.5425741672515869}, "model": {}, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 537088, "num_env_steps_trained": 1064651, "num_agent_steps_sampled": 1654448, "num_agent_steps_trained": 1064651, "num_training_step_calls_since_last_synch_worker_weights": 42423, "num_samples_added_to_queue": 348160, "num_times_learner_queue_full": 46, "num_weight_broadcasts": 22, "total_num_restored_workers": 3, "learner_queue": {"size_count": 85, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 149.675, "learner_load_time_ms": 1044.955, "learner_load_wait_time_ms": 9716.664, "learner_dequeue_time_ms": 89126.313}}, "env_runners": {"episode_reward_max": 4.2943426592501055e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 1.2669754134719825e-13, "episode_len_mean": 1812.47, "episode_media": {}, "episodes_timesteps_total": 181247, "policy_reward_min": {"default_policy": -2183.545740304062}, "policy_reward_max": {"default_policy": 3284.4102187679728}, "policy_reward_mean": {"default_policy": 2.3581228607823862e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 2.220446049250313e-16, 4.1722181265413383e-13, 3.1885605267234496e-13, 4.0811798385220754e-13, -2.220446049250313e-16, 2.220446049250313e-16, 3.519406988061746e-13, 0.0, 0.0, 4.107825191113079e-13, 0.0, 0.0, 1.1102230246251565e-16, 8.08242361927114e-14, 3.9812597663058114e-13, 3.1907809727727e-13, 4.0811798385220754e-13, 0.0, 3.788080960021034e-13, -2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 4.0234482412415673e-13, 0.0, 2.220446049250313e-16, 3.943512183468556e-13, -2.220446049250313e-16, -2.220446049250313e-16, 0.0, 3.3706371027619753e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 3.781419621873283e-13, 0.0, 3.6770586575585185e-13, 3.3928415632544784e-13, -2.220446049250313e-16, 4.156675004196586e-13, 0.0, 2.220446049250313e-16, 4.2943426592501055e-13, 3.54605234065275e-13, -2.220446049250313e-16, 2.220446049250313e-16, 4.269917752708352e-13, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 3.3306690738754696e-16, 9.248157795127554e-14, 4.0323300254385686e-13, 3.608224830031759e-13, 0.0, 2.353672812205332e-14, 3.601563491884008e-13, 0.0, 0.0, 0.0, 4.249933738265099e-13, 1.7719159473017498e-13, 0.0, 2.220446049250313e-16, 1.1102230246251565e-16, 2.220446049250313e-14, 0.0, 4.118927421359331e-13, 4.2943426592501055e-13, 2.220446049250313e-16, -2.220446049250313e-16, 4.0611958240788226e-13, 3.0242475190789264e-13, 3.3795188869589765e-13, 3.794742298168785e-13, 3.6770586575585185e-13, 4.276579090856103e-13, 0.0, 4.0323300254385686e-13, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 2.220446049250313e-16, 0.0, 3.3306690738754696e-16], "episode_lengths": [1024, 2048, 1024, 1024, 2048, 2048, 2047, 2048, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1026, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2047, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2046, 2048, 2048, 1024, 1024, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 1024, 2048], "policy_default_policy_reward": [-735.0, 735.0, -1101.0712129982778, 1277.740395370261, -1435.934369128194, 1259.2651867562504, 571.0, -571.0, -449.0, 449.0, 2103.6563240586884, -649.888346239254, -1261.8796315802203, -191.8883462392413, -1211.9462735738266, -708.3207217508907, -1089.548016505644, 3009.8150118303874, -1438.2551929333815, 2547.7057326150702, -1109.4505396816876, 1980.6060941035344, -1065.609919248128, -914.9961748553992, -1462.2968234937205, -367.6955262170071, 1829.9923497107984, -617.9305955702237, -111.84014468548094, -405.4656965084324, 1135.236436764103, 537.6537180435759, 1513.0944381179345, -580.0964031075313, -1470.651753053982, 819.2438661764253, 657.9021997223067, -1477.1460658986357, 0.0, 0.0, -654.0, 654.0, -1275.6206332605032, 2540.634664803202, -1265.0140315426993, -659.0, 659.0, 891.0, -891.0, -990.0275824492198, -436.02758244919625, 1099.9803920172387, 326.07477288108703, 168.2914139223988, -272.9432175380083, 104.6518036156089, 1619.9816356983927, -2183.545740304062, 563.5641046056822, 1230.365799264613, -345.7752160002233, -884.5905832643768, -608.1118318204364, -648.4169183480693, 1256.5287501685032, 1420.0, -1420.0, -1425.5272708720256, -767.9179643685961, 2193.4452352406643, 384.96588155654285, 966.0337483471518, 424.2256998614372, -1775.2253297651098, -259.0, 259.0, -157.0, 157.0, -6.911941455215475, -1009.2245323185708, 2233.2071030005895, -1217.0706292268083, 1988.384268696587, -1855.4481938334006, -132.93607486307147, 706.0, -706.0, 2030.38322009011, -709.4058041842959, -595.4058041842906, -725.5716117216061, -250.31580054003925, 309.71277015970963, -59.396969619642974, 1214.7419902635652, -1247.1446046612896, -317.4746248426167, 349.8772392402758, 3015.2213997861286, -1026.8270726970147, -955.2356393174985, -1033.158687771633, 1523.0, -1523.0, 810.3443712397893, -2015.2543263816542, 1204.909955141886, -1804.0, 1804.0, -321.0, 321.0, -1501.0, 1501.0, 605.0, -605.0, 1140.0, -1140.0, 897.0, -897.0, -1112.0, 1112.0, -748.0, 748.0, -1224.6916100450712, 2879.3774815426073, -520.0609034459914, -1134.6249680515052, 1754.3319241238378, -755.1900423072376, -999.141881816599, 1635.0, -1635.0, 1373.201369064285, -849.942350986236, -523.2590180780487, -980.0499987245621, 2110.71374184185, -1130.6637431172805, 2561.427648085885, -149.80921602863074, -1205.8092160286146, -1205.8092160286146, 2341.9376592898166, -712.763635436045, -1629.1740238537202, -7.0, 7.0, -1038.7885969240792, -1092.788596924071, -1152.8330249197832, 3284.4102187679728, 2073.2370824389695, -387.4945160902306, -1685.7425663486354, -1238.1439738576191, 2149.6046148071046, -911.4606409494664, -392.56645694546046, 1254.402244301406, -1157.041665559545, 295.2058782035067, -1490.0884858951129, -684.1075101064665, -646.1075101064646, 2820.303506108117, 2719.5326804433744, -1359.7663402216872, -1359.7663402216872, 728.0, -728.0, -176.0, 176.0, -294.0, 294.0, -762.0, 762.0, -242.87048957088064, -1670.3881611911006, 73.12951042911936, 1840.1291403327984, 892.0, -892.0, 2088.339589540996, -420.9520121214365, -1525.3090309804816, -142.07854643915786, -719.1933899865163, -1033.3498109601219, 2989.1203066613652, -1236.577105714847, -127.98632739476612, -1553.5135982667712, 1681.499925661623, -890.2474375138698, 2168.6964978991386, -1278.4490603852462, -69.0, 69.0, 2571.0089281264645, -801.3169481928587, -1432.1288197161753, -337.56316021742816, -1653.9227611952567, 1786.8588360584192, -132.9360748630714, -821.0, 821.0, 0.0, 0.0, 1872.0, -1872.0, 2534.2707037725136, -1262.892711199145, -1271.3779925733684, 843.5783899555573, 5.656854249492364, -849.2352442050492, -723.923262129352, 2681.6365024008146, -1003.8566201357589, -953.8566201357565, -1589.6273603913378, 1581.544456622775, -374.5182553916913, 382.6011591603401, 469.45001850479014, -1237.3258765270002, 1669.3453280886424, -901.4694700664877, 70.71067811865473, 70.71067811865473, -141.42135623730942, 0.0, 0.0, -1600.88975260628, -275.06453788156966, 1875.954290487925, 1902.1172413918264, -707.1067811865531, -1195.0104602052468, -1855.5452540693022, 2445.597229181223, -164.02598755590378, -426.0259875559007, 3098.003033365568, -1032.2437702050406, -1163.879631580252, -901.8796315802671, -1014.6982310027032, -1239.5581874199713, 2254.256418422677, 567.4915574974029, -1694.9349545041578, 1127.443397006764, -722.6631303726567, 700.742820155873, 21.920310216782354, 1839.1847378662012, -1658.8725086636096, -180.31222920257045, -1228.9515857021954, -1055.0033175303317, 2283.9549032325276, -1152.584053334081, 1577.5552288271738, -424.97117549311724, -530.0, 530.0, 2387.899600066935, -1464.4181438372798, -923.4814562296378, 977.0, -977.0, -485.0, 485.0, 0.0, 0.0, -416.5827187205274, -1400.915928688386, 2768.081366129505, -950.5827187205472, -164.7889670203185, 1037.742574035026, -1765.3030787576504, 892.3494717429703, 190.0, -190.0, -560.53154105538, -391.8564064605253, -109.19477120461544, 1061.5827187205377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.404861893258358, "mean_inference_ms": 4.684764150630965, "mean_action_processing_ms": 0.9574839318185879, "mean_env_wait_ms": 19.129215095842607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018680572509765625, "StateBufferConnector_ms": 0.015059232711791992, "ViewRequirementAgentConnector_ms": 0.6210224628448486}, "num_episodes": 14, "episode_return_max": 4.2943426592501055e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 1.2669754134719825e-13, "episodes_this_iter": 14}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 1654448, "num_agent_steps_trained": 1064651, "num_env_steps_sampled": 537088, "num_env_steps_trained": 1064651, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 52216, "num_env_steps_sampled_throughput_per_sec": 2559.9727175759135, "num_env_steps_trained_throughput_per_sec": 5221.544352380621, "timesteps_total": 537088, "num_env_steps_sampled_lifetime": 537088, "num_agent_steps_sampled_lifetime": 1654448, "num_steps_trained_this_iter": 52216, "agent_timesteps_total": 1654448, "timers": {"training_iteration_time_ms": 10000.11, "restore_workers_time_ms": 0.007, "training_step_time_ms": 0.165, "sample_time_ms": 0.113, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 537088, "num_env_steps_trained": 1064651, "num_agent_steps_sampled": 1654448, "num_agent_steps_trained": 1064651, "num_training_step_calls_since_last_synch_worker_weights": 42423, "num_samples_added_to_queue": 348160, "num_times_learner_queue_full": 46, "num_weight_broadcasts": 22, "total_num_restored_workers": 3}, "done": false, "training_iteration": 22, "trial_id": "de35c_00000", "date": "2024-09-02_13-18-20", "timestamp": 1725250700, "time_this_iter_s": 49.90693473815918, "time_total_s": 1066.002896308899, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1066.002896308899, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 47.05352112676054, "ram_util_percent": 63.991549295774654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 30215.53515625, "policy_loss": 3698.92578125, "entropy": 12.837103843688965, "entropy_coeff": 0.01, "var_gnorm": 2048.53466796875, "vf_loss": 54084.8359375, "vf_explained_var": -0.18114197254180908}, "model": {}, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 562688, "num_env_steps_trained": 1116652, "num_agent_steps_sampled": 1737170, "num_agent_steps_trained": 1116652, "num_training_step_calls_since_last_synch_worker_weights": 42919, "num_samples_added_to_queue": 364544, "num_times_learner_queue_full": 48, "num_weight_broadcasts": 23, "total_num_restored_workers": 3, "learner_queue": {"size_count": 89, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 144.236, "learner_load_time_ms": 1038.508, "learner_load_wait_time_ms": 9801.828, "learner_dequeue_time_ms": 88761.227}}, "env_runners": {"episode_reward_max": 4.2943426592501055e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 1.2067347121558215e-13, "episode_len_mean": 1812.48, "episode_media": {}, "episodes_timesteps_total": 181248, "policy_reward_min": {"default_policy": -2183.545740304062}, "policy_reward_max": {"default_policy": 3284.4102187679728}, "policy_reward_mean": {"default_policy": 1.3937307887237023e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1102230246251565e-16, 8.08242361927114e-14, 3.9812597663058114e-13, 3.1907809727727e-13, 4.0811798385220754e-13, 0.0, 3.788080960021034e-13, -2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 4.0234482412415673e-13, 0.0, 2.220446049250313e-16, 3.943512183468556e-13, -2.220446049250313e-16, -2.220446049250313e-16, 0.0, 3.3706371027619753e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 3.781419621873283e-13, 0.0, 3.6770586575585185e-13, 3.3928415632544784e-13, -2.220446049250313e-16, 4.156675004196586e-13, 0.0, 2.220446049250313e-16, 4.2943426592501055e-13, 3.54605234065275e-13, -2.220446049250313e-16, 2.220446049250313e-16, 4.269917752708352e-13, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 3.3306690738754696e-16, 9.248157795127554e-14, 4.0323300254385686e-13, 3.608224830031759e-13, 0.0, 2.353672812205332e-14, 3.601563491884008e-13, 0.0, 0.0, 0.0, 4.249933738265099e-13, 1.7719159473017498e-13, 0.0, 2.220446049250313e-16, 1.1102230246251565e-16, 2.220446049250313e-14, 0.0, 4.118927421359331e-13, 4.2943426592501055e-13, 2.220446049250313e-16, -2.220446049250313e-16, 4.0611958240788226e-13, 3.0242475190789264e-13, 3.3795188869589765e-13, 3.794742298168785e-13, 3.6770586575585185e-13, 4.276579090856103e-13, 0.0, 4.0323300254385686e-13, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 2.220446049250313e-16, 0.0, 3.3306690738754696e-16, 4.0034642267983145e-13, 1.9229062786507711e-13, 1.1390888232654106e-13, 0.0, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 2.220446049250313e-16, 4.1677772344428377e-13, 0.0, 0.0, 0.0, -2.220446049250313e-16, 1.8118839761882555e-13, 0.0, 0.0], "episode_lengths": [2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1026, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2047, 2048, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2046, 2048, 2048, 1024, 1024, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 1024, 2048, 2048, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 1024, 2048, 1024, 2048, 1024], "policy_default_policy_reward": [-990.0275824492198, -436.02758244919625, 1099.9803920172387, 326.07477288108703, 168.2914139223988, -272.9432175380083, 104.6518036156089, 1619.9816356983927, -2183.545740304062, 563.5641046056822, 1230.365799264613, -345.7752160002233, -884.5905832643768, -608.1118318204364, -648.4169183480693, 1256.5287501685032, 1420.0, -1420.0, -1425.5272708720256, -767.9179643685961, 2193.4452352406643, 384.96588155654285, 966.0337483471518, 424.2256998614372, -1775.2253297651098, -259.0, 259.0, -157.0, 157.0, -6.911941455215475, -1009.2245323185708, 2233.2071030005895, -1217.0706292268083, 1988.384268696587, -1855.4481938334006, -132.93607486307147, 706.0, -706.0, 2030.38322009011, -709.4058041842959, -595.4058041842906, -725.5716117216061, -250.31580054003925, 309.71277015970963, -59.396969619642974, 1214.7419902635652, -1247.1446046612896, -317.4746248426167, 349.8772392402758, 3015.2213997861286, -1026.8270726970147, -955.2356393174985, -1033.158687771633, 1523.0, -1523.0, 810.3443712397893, -2015.2543263816542, 1204.909955141886, -1804.0, 1804.0, -321.0, 321.0, -1501.0, 1501.0, 605.0, -605.0, 1140.0, -1140.0, 897.0, -897.0, -1112.0, 1112.0, -748.0, 748.0, -1224.6916100450712, 2879.3774815426073, -520.0609034459914, -1134.6249680515052, 1754.3319241238378, -755.1900423072376, -999.141881816599, 1635.0, -1635.0, 1373.201369064285, -849.942350986236, -523.2590180780487, -980.0499987245621, 2110.71374184185, -1130.6637431172805, 2561.427648085885, -149.80921602863074, -1205.8092160286146, -1205.8092160286146, 2341.9376592898166, -712.763635436045, -1629.1740238537202, -7.0, 7.0, -1038.7885969240792, -1092.788596924071, -1152.8330249197832, 3284.4102187679728, 2073.2370824389695, -387.4945160902306, -1685.7425663486354, -1238.1439738576191, 2149.6046148071046, -911.4606409494664, -392.56645694546046, 1254.402244301406, -1157.041665559545, 295.2058782035067, -1490.0884858951129, -684.1075101064665, -646.1075101064646, 2820.303506108117, 2719.5326804433744, -1359.7663402216872, -1359.7663402216872, 728.0, -728.0, -176.0, 176.0, -294.0, 294.0, -762.0, 762.0, -242.87048957088064, -1670.3881611911006, 73.12951042911936, 1840.1291403327984, 892.0, -892.0, 2088.339589540996, -420.9520121214365, -1525.3090309804816, -142.07854643915786, -719.1933899865163, -1033.3498109601219, 2989.1203066613652, -1236.577105714847, -127.98632739476612, -1553.5135982667712, 1681.499925661623, -890.2474375138698, 2168.6964978991386, -1278.4490603852462, -69.0, 69.0, 2571.0089281264645, -801.3169481928587, -1432.1288197161753, -337.56316021742816, -1653.9227611952567, 1786.8588360584192, -132.9360748630714, -821.0, 821.0, 0.0, 0.0, 1872.0, -1872.0, 2534.2707037725136, -1262.892711199145, -1271.3779925733684, 843.5783899555573, 5.656854249492364, -849.2352442050492, -723.923262129352, 2681.6365024008146, -1003.8566201357589, -953.8566201357565, -1589.6273603913378, 1581.544456622775, -374.5182553916913, 382.6011591603401, 469.45001850479014, -1237.3258765270002, 1669.3453280886424, -901.4694700664877, 70.71067811865473, 70.71067811865473, -141.42135623730942, 0.0, 0.0, -1600.88975260628, -275.06453788156966, 1875.954290487925, 1902.1172413918264, -707.1067811865531, -1195.0104602052468, -1855.5452540693022, 2445.597229181223, -164.02598755590378, -426.0259875559007, 3098.003033365568, -1032.2437702050406, -1163.879631580252, -901.8796315802671, -1014.6982310027032, -1239.5581874199713, 2254.256418422677, 567.4915574974029, -1694.9349545041578, 1127.443397006764, -722.6631303726567, 700.742820155873, 21.920310216782354, 1839.1847378662012, -1658.8725086636096, -180.31222920257045, -1228.9515857021954, -1055.0033175303317, 2283.9549032325276, -1152.584053334081, 1577.5552288271738, -424.97117549311724, -530.0, 530.0, 2387.899600066935, -1464.4181438372798, -923.4814562296378, 977.0, -977.0, -485.0, 485.0, 0.0, 0.0, -416.5827187205274, -1400.915928688386, 2768.081366129505, -950.5827187205472, -164.7889670203185, 1037.742574035026, -1765.3030787576504, 892.3494717429703, 190.0, -190.0, -560.53154105538, -391.8564064605253, -109.19477120461544, 1061.5827187205377, 581.2417741353461, -1692.8136341604998, 1111.571860025261, -345.0681092190374, -69.29646455628156, 414.3645737753194, 2764.862380976078, -1347.4274169300456, -990.0075471160995, -427.4274169300823, -211.0, 211.0, -1387.8693220279204, 1448.0752002314682, -534.707074373511, 474.501196169937, -454.65967026639464, -734.0972005541822, -1099.5672543921103, 2288.324125212631, -83.0, 83.0, -533.5848973852713, 1975.3290663135888, -1540.0069633445892, 98.2627944162786, -577.4532082914056, -1379.7642042614077, -959.4532082914221, 2916.6706208442865, 1187.9393923933908, 782.7672067735133, -1970.706599166869, 0.0, 0.0, 0.0, 191.0, -191.0, 179.0, -179.0, -442.5819212738826, 687.3784354102546, 400.3494717429469, -645.1459858793986, -1127.1282092113602, 593.2625894155175, 533.865619795847, 1697.0, -1697.0, 141.0, -141.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.437181065845655, "mean_inference_ms": 4.67205479061069, "mean_action_processing_ms": 0.952338543846002, "mean_env_wait_ms": 19.072645788454984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018414735794067383, "StateBufferConnector_ms": 0.014858245849609375, "ViewRequirementAgentConnector_ms": 0.610753059387207}, "num_episodes": 17, "episode_return_max": 4.2943426592501055e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 1.2067347121558215e-13, "episodes_this_iter": 17}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 2, "num_agent_steps_sampled": 1737170, "num_agent_steps_trained": 1116652, "num_env_steps_sampled": 562688, "num_env_steps_trained": 1116652, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 52001, "num_env_steps_sampled_throughput_per_sec": 2559.999755859398, "num_env_steps_trained_throughput_per_sec": 5200.099504079866, "timesteps_total": 562688, "num_env_steps_sampled_lifetime": 562688, "num_agent_steps_sampled_lifetime": 1737170, "num_steps_trained_this_iter": 52001, "agent_timesteps_total": 1737170, "timers": {"training_iteration_time_ms": 10000.103, "restore_workers_time_ms": 0.008, "training_step_time_ms": 0.183, "sample_time_ms": 0.126, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 562688, "num_env_steps_trained": 1116652, "num_agent_steps_sampled": 1737170, "num_agent_steps_trained": 1116652, "num_training_step_calls_since_last_synch_worker_weights": 42919, "num_samples_added_to_queue": 364544, "num_times_learner_queue_full": 48, "num_weight_broadcasts": 23, "total_num_restored_workers": 3}, "done": false, "training_iteration": 23, "trial_id": "de35c_00000", "date": "2024-09-02_13-19-10", "timestamp": 1725250750, "time_this_iter_s": 50.15556240081787, "time_total_s": 1116.1584587097168, "pid": 206549, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x734b0e962a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1116.1584587097168, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 52.7830985915493, "ram_util_percent": 63.683098591549296}}
