{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 43534, "learner_queue": {"size_count": 0, "size_mean": NaN, "size_std": NaN, "size_quantiles": 1.0}, "timing_breakdown": {"learner_grad_time_ms": 0.0, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 0.0, "learner_dequeue_time_ms": 0.0}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 0, "num_env_steps_sampled_lifetime": 0, "num_agent_steps_sampled_lifetime": 0, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 0, "timers": {"training_iteration_time_ms": 10000.154, "restore_workers_time_ms": 0.008, "training_step_time_ms": 0.158, "sample_time_ms": 0.137, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 43534}, "done": false, "training_iteration": 1, "trial_id": "567b5_00000", "date": "2024-09-01_20-58-44", "timestamp": 1725191924, "time_this_iter_s": 70.01404309272766, "time_total_s": 70.01404309272766, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.01404309272766, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 80.693, "ram_util_percent": 54.275000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 10727, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25947, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 114, "num_weight_broadcasts": 4, "num_samples_added_to_queue": 10727, "learner_queue": {"size_count": 2, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 339.957, "learner_load_time_ms": 1347.098, "learner_load_wait_time_ms": 40613.794, "learner_dequeue_time_ms": 79549.485}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25947, "num_agent_steps_trained": 0, "num_env_steps_sampled": 10727, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 10727, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 1072.6227430032106, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 10727, "num_env_steps_sampled_lifetime": 10727, "num_agent_steps_sampled_lifetime": 25947, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 25947, "timers": {"training_iteration_time_ms": 10000.444, "restore_workers_time_ms": 0.026, "training_step_time_ms": 9.932, "sample_time_ms": 9.833, "synch_weights_time_ms": 0.025}, "counters": {"num_env_steps_sampled": 10727, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25947, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 114, "num_weight_broadcasts": 4, "num_samples_added_to_queue": 10727}, "done": false, "training_iteration": 2, "trial_id": "567b5_00000", "date": "2024-09-01_20-59-54", "timestamp": 1725191994, "time_this_iter_s": 70.1823947429657, "time_total_s": 140.19643783569336, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 140.19643783569336, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 77.40299999999999, "ram_util_percent": 57.397000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -5890.09814453125, "policy_loss": -7500.5107421875, "entropy": 11.707243919372559, "entropy_coeff": 0.01, "var_gnorm": 2047.2242431640625, "vf_loss": 4088.566650390625, "vf_explained_var": -0.00409090518951416}, "model": {}, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 85734, "num_env_steps_trained": 95538, "num_agent_steps_sampled": 248308, "num_agent_steps_trained": 95538, "num_training_step_calls_since_last_synch_worker_weights": 40468, "num_weight_broadcasts": 5, "num_samples_added_to_queue": 34194, "num_times_learner_queue_full": 9, "learner_queue": {"size_count": 6, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 208.2, "learner_load_time_ms": 1347.098, "learner_load_wait_time_ms": 24537.047, "learner_dequeue_time_ms": 79549.485}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248308, "num_agent_steps_trained": 95538, "num_env_steps_sampled": 85734, "num_env_steps_trained": 95538, "num_env_steps_sampled_this_iter": 75007, "num_env_steps_trained_this_iter": 95538, "num_env_steps_sampled_throughput_per_sec": 7500.6787192161655, "num_env_steps_trained_throughput_per_sec": 9553.772894216194, "timesteps_total": 85734, "num_env_steps_sampled_lifetime": 85734, "num_agent_steps_sampled_lifetime": 248308, "num_steps_trained_this_iter": 95538, "agent_timesteps_total": 248308, "timers": {"training_iteration_time_ms": 10000.312, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.132, "sample_time_ms": 0.096, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 85734, "num_env_steps_trained": 95538, "num_agent_steps_sampled": 248308, "num_agent_steps_trained": 95538, "num_training_step_calls_since_last_synch_worker_weights": 40468, "num_weight_broadcasts": 5, "num_samples_added_to_queue": 34194, "num_times_learner_queue_full": 9}, "done": false, "training_iteration": 3, "trial_id": "567b5_00000", "date": "2024-09-01_21-01-04", "timestamp": 1725192064, "time_this_iter_s": 70.02013325691223, "time_total_s": 210.2165710926056, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 210.2165710926056, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 78.75757575757575, "ram_util_percent": 59.183838383838385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -595.9638061523438, "policy_loss": -524.2061767578125, "entropy": 11.752052307128906, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 717.6751708984375, "vf_explained_var": 0.15157997608184814}, "model": {}, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 144301, "num_env_steps_trained": 141165, "num_agent_steps_sampled": 426154, "num_agent_steps_trained": 141165, "num_training_step_calls_since_last_synch_worker_weights": 25355, "num_weight_broadcasts": 6, "num_samples_added_to_queue": 55996, "num_times_learner_queue_full": 16, "learner_queue": {"size_count": 10, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 220.782, "learner_load_time_ms": 1534.871, "learner_load_wait_time_ms": 21944.756, "learner_dequeue_time_ms": 104772.822}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 426154, "num_agent_steps_trained": 141165, "num_env_steps_sampled": 144301, "num_env_steps_trained": 141165, "num_env_steps_sampled_this_iter": 58567, "num_env_steps_trained_this_iter": 45627, "num_env_steps_sampled_throughput_per_sec": 5852.020257867119, "num_env_steps_trained_throughput_per_sec": 4559.0542166357, "timesteps_total": 144301, "num_env_steps_sampled_lifetime": 144301, "num_agent_steps_sampled_lifetime": 426154, "num_steps_trained_this_iter": 45627, "agent_timesteps_total": 426154, "timers": {"training_iteration_time_ms": 10002.237, "restore_workers_time_ms": 0.013, "training_step_time_ms": 2.928, "sample_time_ms": 2.815, "synch_weights_time_ms": 0.03}, "counters": {"num_env_steps_sampled": 144301, "num_env_steps_trained": 141165, "num_agent_steps_sampled": 426154, "num_agent_steps_trained": 141165, "num_training_step_calls_since_last_synch_worker_weights": 25355, "num_weight_broadcasts": 6, "num_samples_added_to_queue": 55996, "num_times_learner_queue_full": 16}, "done": false, "training_iteration": 4, "trial_id": "567b5_00000", "date": "2024-09-01_21-02-14", "timestamp": 1725192134, "time_this_iter_s": 70.16323685646057, "time_total_s": 280.37980794906616, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 280.37980794906616, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 85.92300000000002, "ram_util_percent": 60.14099999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -49246.421875, "policy_loss": -62913.96875, "entropy": 11.757407188415527, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 28265.103515625, "vf_explained_var": 0.0005345344543457031}, "model": {}, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 190188, "num_env_steps_trained": 207407, "num_agent_steps_sampled": 538050, "num_agent_steps_trained": 207407, "num_training_step_calls_since_last_synch_worker_weights": 6863, "num_weight_broadcasts": 9, "num_samples_added_to_queue": 94021, "num_times_learner_queue_full": 17, "learner_queue": {"size_count": 16, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 234.329, "learner_load_time_ms": 1534.871, "learner_load_wait_time_ms": 14298.849, "learner_dequeue_time_ms": 104772.822}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 538050, "num_agent_steps_trained": 207407, "num_env_steps_sampled": 190188, "num_env_steps_trained": 207407, "num_env_steps_sampled_this_iter": 45887, "num_env_steps_trained_this_iter": 66242, "num_env_steps_sampled_throughput_per_sec": 4588.675712632938, "num_env_steps_trained_throughput_per_sec": 6624.164939007366, "timesteps_total": 190188, "num_env_steps_sampled_lifetime": 190188, "num_agent_steps_sampled_lifetime": 538050, "num_steps_trained_this_iter": 66242, "agent_timesteps_total": 538050, "timers": {"training_iteration_time_ms": 10001.814, "restore_workers_time_ms": 0.012, "training_step_time_ms": 0.359, "sample_time_ms": 0.275, "synch_weights_time_ms": 0.019}, "counters": {"num_env_steps_sampled": 190188, "num_env_steps_trained": 207407, "num_agent_steps_sampled": 538050, "num_agent_steps_trained": 207407, "num_training_step_calls_since_last_synch_worker_weights": 6863, "num_weight_broadcasts": 9, "num_samples_added_to_queue": 94021, "num_times_learner_queue_full": 17}, "done": false, "training_iteration": 5, "trial_id": "567b5_00000", "date": "2024-09-01_21-03-24", "timestamp": 1725192204, "time_this_iter_s": 70.08522605895996, "time_total_s": 350.4650340080261, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 350.4650340080261, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 84.983, "ram_util_percent": 63.97300000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 69311.65625, "policy_loss": 64352.54296875, "entropy": 11.33163833618164, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 10846.517578125, "vf_explained_var": 0.00036597251892089844}, "model": {}, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 244408, "num_env_steps_trained": 301888, "num_agent_steps_sampled": 681012, "num_agent_steps_trained": 301888, "num_training_step_calls_since_last_synch_worker_weights": 26603, "num_weight_broadcasts": 10, "num_samples_added_to_queue": 119319, "num_times_learner_queue_full": 21, "learner_queue": {"size_count": 20, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 223.744, "learner_load_time_ms": 1847.523, "learner_load_wait_time_ms": 13734.651, "learner_dequeue_time_ms": 113020.761}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 681012, "num_agent_steps_trained": 301888, "num_env_steps_sampled": 244408, "num_env_steps_trained": 301888, "num_env_steps_sampled_this_iter": 54220, "num_env_steps_trained_this_iter": 94481, "num_env_steps_sampled_throughput_per_sec": 5421.918819307839, "num_env_steps_trained_throughput_per_sec": 9447.958538676206, "timesteps_total": 244408, "num_env_steps_sampled_lifetime": 244408, "num_agent_steps_sampled_lifetime": 681012, "num_steps_trained_this_iter": 94481, "agent_timesteps_total": 681012, "timers": {"training_iteration_time_ms": 10001.539, "restore_workers_time_ms": 0.015, "training_step_time_ms": 0.437, "sample_time_ms": 0.337, "synch_weights_time_ms": 0.025}, "counters": {"num_env_steps_sampled": 244408, "num_env_steps_trained": 301888, "num_agent_steps_sampled": 681012, "num_agent_steps_trained": 301888, "num_training_step_calls_since_last_synch_worker_weights": 26603, "num_weight_broadcasts": 10, "num_samples_added_to_queue": 119319, "num_times_learner_queue_full": 21}, "done": false, "training_iteration": 6, "trial_id": "567b5_00000", "date": "2024-09-01_21-04-34", "timestamp": 1725192274, "time_this_iter_s": 70.02977871894836, "time_total_s": 420.4948127269745, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 420.4948127269745, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 86.06060606060605, "ram_util_percent": 65.05959595959597}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -133257.96875, "policy_loss": -143564.109375, "entropy": 13.18839168548584, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 21571.06640625, "vf_explained_var": 0.038888633251190186}, "model": {}, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 18.56885068407756}}, "num_env_steps_sampled": 307613, "num_env_steps_trained": 348535, "num_agent_steps_sampled": 859392, "num_agent_steps_trained": 348535, "num_training_step_calls_since_last_synch_worker_weights": 28194, "num_weight_broadcasts": 12, "num_samples_added_to_queue": 150856, "num_times_learner_queue_full": 26, "learner_queue": {"size_count": 24, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 190.421, "learner_load_time_ms": 1847.523, "learner_load_wait_time_ms": 14122.308, "learner_dequeue_time_ms": 113020.761}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 859392, "num_agent_steps_trained": 348535, "num_env_steps_sampled": 307613, "num_env_steps_trained": 348535, "num_env_steps_sampled_this_iter": 63205, "num_env_steps_trained_this_iter": 46647, "num_env_steps_sampled_throughput_per_sec": 6320.4258601779175, "num_env_steps_trained_throughput_per_sec": 4664.6452828054635, "timesteps_total": 307613, "num_env_steps_sampled_lifetime": 307613, "num_agent_steps_sampled_lifetime": 859392, "num_steps_trained_this_iter": 46647, "agent_timesteps_total": 859392, "timers": {"training_iteration_time_ms": 10001.339, "restore_workers_time_ms": 0.011, "training_step_time_ms": 0.289, "sample_time_ms": 0.219, "synch_weights_time_ms": 0.016}, "counters": {"num_env_steps_sampled": 307613, "num_env_steps_trained": 348535, "num_agent_steps_sampled": 859392, "num_agent_steps_trained": 348535, "num_training_step_calls_since_last_synch_worker_weights": 28194, "num_weight_broadcasts": 12, "num_samples_added_to_queue": 150856, "num_times_learner_queue_full": 26}, "done": false, "training_iteration": 7, "trial_id": "567b5_00000", "date": "2024-09-01_21-05-44", "timestamp": 1725192344, "time_this_iter_s": 70.03364396095276, "time_total_s": 490.52845668792725, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 490.52845668792725, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 86.012, "ram_util_percent": 66.186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -99381.96875, "policy_loss": -110276.609375, "entropy": 11.428291320800781, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 22660.79296875, "vf_explained_var": -0.010191679000854492}, "model": {}, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 21.045974854569337}}, "num_env_steps_sampled": 363801, "num_env_steps_trained": 446746, "num_agent_steps_sampled": 996462, "num_agent_steps_trained": 446746, "num_training_step_calls_since_last_synch_worker_weights": 6226, "num_weight_broadcasts": 15, "num_samples_added_to_queue": 192338, "num_times_learner_queue_full": 29, "learner_queue": {"size_count": 30, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 207.699, "learner_load_time_ms": 2198.267, "learner_load_wait_time_ms": 14087.374, "learner_dequeue_time_ms": 118370.491}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996462, "num_agent_steps_trained": 446746, "num_env_steps_sampled": 363801, "num_env_steps_trained": 446746, "num_env_steps_sampled_this_iter": 56188, "num_env_steps_trained_this_iter": 98211, "num_env_steps_sampled_throughput_per_sec": 5618.712121888352, "num_env_steps_trained_throughput_per_sec": 9820.946397856784, "timesteps_total": 363801, "num_env_steps_sampled_lifetime": 363801, "num_agent_steps_sampled_lifetime": 996462, "num_steps_trained_this_iter": 98211, "agent_timesteps_total": 996462, "timers": {"training_iteration_time_ms": 10001.193, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.231, "sample_time_ms": 0.158, "synch_weights_time_ms": 0.019}, "counters": {"num_env_steps_sampled": 363801, "num_env_steps_trained": 446746, "num_agent_steps_sampled": 996462, "num_agent_steps_trained": 446746, "num_training_step_calls_since_last_synch_worker_weights": 6226, "num_weight_broadcasts": 15, "num_samples_added_to_queue": 192338, "num_times_learner_queue_full": 29}, "done": false, "training_iteration": 8, "trial_id": "567b5_00000", "date": "2024-09-01_21-06-54", "timestamp": 1725192414, "time_this_iter_s": 70.03017115592957, "time_total_s": 560.5586278438568, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 560.5586278438568, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 84.72828282828281, "ram_util_percent": 66.61111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -81307.5625, "policy_loss": -87056.53125, "entropy": 11.273616790771484, "entropy_coeff": 0.01, "var_gnorm": 2047.2242431640625, "vf_loss": 12421.462890625, "vf_explained_var": -0.002833724021911621}, "model": {}, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 449447, "num_env_steps_trained": 551508, "num_agent_steps_sampled": 1225310, "num_agent_steps_trained": 551508, "num_training_step_calls_since_last_synch_worker_weights": 6573, "num_weight_broadcasts": 17, "num_samples_added_to_queue": 250145, "num_times_learner_queue_full": 33, "learner_queue": {"size_count": 35, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 203.269, "learner_load_time_ms": 2478.627, "learner_load_wait_time_ms": 7976.991, "learner_dequeue_time_ms": 106875.239}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1225310, "num_agent_steps_trained": 551508, "num_env_steps_sampled": 449447, "num_env_steps_trained": 551508, "num_env_steps_sampled_this_iter": 85646, "num_env_steps_trained_this_iter": 104762, "num_env_steps_sampled_throughput_per_sec": 8564.444405492855, "num_env_steps_trained_throughput_per_sec": 10476.009677138949, "timesteps_total": 449447, "num_env_steps_sampled_lifetime": 449447, "num_agent_steps_sampled_lifetime": 1225310, "num_steps_trained_this_iter": 104762, "agent_timesteps_total": 1225310, "timers": {"training_iteration_time_ms": 10001.083, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.23, "sample_time_ms": 0.159, "synch_weights_time_ms": 0.016}, "counters": {"num_env_steps_sampled": 449447, "num_env_steps_trained": 551508, "num_agent_steps_sampled": 1225310, "num_agent_steps_trained": 551508, "num_training_step_calls_since_last_synch_worker_weights": 6573, "num_weight_broadcasts": 17, "num_samples_added_to_queue": 250145, "num_times_learner_queue_full": 33}, "done": false, "training_iteration": 9, "trial_id": "567b5_00000", "date": "2024-09-01_21-08-05", "timestamp": 1725192485, "time_this_iter_s": 70.24278807640076, "time_total_s": 630.8014159202576, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 630.8014159202576, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 86.31212121212121, "ram_util_percent": 67.03737373737374}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -30800.287109375, "policy_loss": -31896.55078125, "entropy": 12.16572093963623, "entropy_coeff": 0.01, "var_gnorm": 2047.2242431640625, "vf_loss": 3176.97509765625, "vf_explained_var": 0.04701930284500122}, "model": {}, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 590836, "num_env_steps_trained": 728168, "num_agent_steps_sampled": 1597011, "num_agent_steps_trained": 728168, "num_training_step_calls_since_last_synch_worker_weights": 433, "num_weight_broadcasts": 26, "num_samples_added_to_queue": 366760, "num_times_learner_queue_full": 37, "learner_queue": {"size_count": 46, "size_mean": 0.043478260869565216, "size_std": 0.20393111999232302, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 190.112, "learner_load_time_ms": 2215.078, "learner_load_wait_time_ms": 1749.781, "learner_dequeue_time_ms": 99431.096}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1597011, "num_agent_steps_trained": 728168, "num_env_steps_sampled": 590836, "num_env_steps_trained": 728168, "num_env_steps_sampled_this_iter": 141389, "num_env_steps_trained_this_iter": 176660, "num_env_steps_sampled_throughput_per_sec": 14138.52751691565, "num_env_steps_trained_throughput_per_sec": 17665.534597021826, "timesteps_total": 590836, "num_env_steps_sampled_lifetime": 590836, "num_agent_steps_sampled_lifetime": 1597011, "num_steps_trained_this_iter": 176660, "agent_timesteps_total": 1597011, "timers": {"training_iteration_time_ms": 10001.003, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.49, "sample_time_ms": 0.417, "synch_weights_time_ms": 0.016}, "counters": {"num_env_steps_sampled": 590836, "num_env_steps_trained": 728168, "num_agent_steps_sampled": 1597011, "num_agent_steps_trained": 728168, "num_training_step_calls_since_last_synch_worker_weights": 433, "num_weight_broadcasts": 26, "num_samples_added_to_queue": 366760, "num_times_learner_queue_full": 37}, "done": false, "training_iteration": 10, "trial_id": "567b5_00000", "date": "2024-09-01_21-09-15", "timestamp": 1725192555, "time_this_iter_s": 70.1951642036438, "time_total_s": 700.9965801239014, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 700.9965801239014, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 87.1484848484849, "ram_util_percent": 67.70303030303033}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -33331.2890625, "policy_loss": -33597.97265625, "entropy": 13.160244941711426, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 1611.4564208984375, "vf_explained_var": 0.003204524517059326}, "model": {}, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}}, "num_env_steps_sampled": 637053, "num_env_steps_trained": 973591, "num_agent_steps_sampled": 1726136, "num_agent_steps_trained": 973591, "num_training_step_calls_since_last_synch_worker_weights": 27776, "num_weight_broadcasts": 27, "num_samples_added_to_queue": 403900, "num_times_learner_queue_full": 38, "learner_queue": {"size_count": 50, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 207.694, "learner_load_time_ms": 2086.776, "learner_load_wait_time_ms": 6615.896, "learner_dequeue_time_ms": 92837.053}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1726136, "num_agent_steps_trained": 973591, "num_env_steps_sampled": 637053, "num_env_steps_trained": 973591, "num_env_steps_sampled_this_iter": 46217, "num_env_steps_trained_this_iter": 245423, "num_env_steps_sampled_throughput_per_sec": 4621.419473505508, "num_env_steps_trained_throughput_per_sec": 24540.81033918563, "timesteps_total": 637053, "num_env_steps_sampled_lifetime": 637053, "num_agent_steps_sampled_lifetime": 1726136, "num_steps_trained_this_iter": 245423, "agent_timesteps_total": 1726136, "timers": {"training_iteration_time_ms": 10001.05, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10.075, "sample_time_ms": 9.866, "synch_weights_time_ms": 0.059}, "counters": {"num_env_steps_sampled": 637053, "num_env_steps_trained": 973591, "num_agent_steps_sampled": 1726136, "num_agent_steps_trained": 973591, "num_training_step_calls_since_last_synch_worker_weights": 27776, "num_weight_broadcasts": 27, "num_samples_added_to_queue": 403900, "num_times_learner_queue_full": 38}, "done": false, "training_iteration": 11, "trial_id": "567b5_00000", "date": "2024-09-01_21-10-25", "timestamp": 1725192625, "time_this_iter_s": 70.3868191242218, "time_total_s": 771.3833992481232, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 771.3833992481232, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 86.49199999999999, "ram_util_percent": 67.161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 90805.2890625, "policy_loss": 81638.1640625, "entropy": 13.32656478881836, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 19368.384765625, "vf_explained_var": -0.11884212493896484}, "model": {}, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 39.083876932559455}}, "num_env_steps_sampled": 739424, "num_env_steps_trained": 1121668, "num_agent_steps_sampled": 1980724, "num_agent_steps_trained": 1121668, "num_training_step_calls_since_last_synch_worker_weights": 5245, "num_weight_broadcasts": 29, "num_samples_added_to_queue": 449026, "num_times_learner_queue_full": 46, "learner_queue": {"size_count": 55, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 203.311, "learner_load_time_ms": 2086.776, "learner_load_wait_time_ms": 12695.353, "learner_dequeue_time_ms": 92837.053}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1980724, "num_agent_steps_trained": 1121668, "num_env_steps_sampled": 739424, "num_env_steps_trained": 1121668, "num_env_steps_sampled_this_iter": 102371, "num_env_steps_trained_this_iter": 148077, "num_env_steps_sampled_throughput_per_sec": 10236.22971508112, "num_env_steps_trained_throughput_per_sec": 14806.441155405993, "timesteps_total": 739424, "num_env_steps_sampled_lifetime": 739424, "num_agent_steps_sampled_lifetime": 1980724, "num_steps_trained_this_iter": 148077, "agent_timesteps_total": 1980724, "timers": {"training_iteration_time_ms": 10001.064, "restore_workers_time_ms": 0.011, "training_step_time_ms": 0.7, "sample_time_ms": 0.586, "synch_weights_time_ms": 0.025}, "counters": {"num_env_steps_sampled": 739424, "num_env_steps_trained": 1121668, "num_agent_steps_sampled": 1980724, "num_agent_steps_trained": 1121668, "num_training_step_calls_since_last_synch_worker_weights": 5245, "num_weight_broadcasts": 29, "num_samples_added_to_queue": 449026, "num_times_learner_queue_full": 46}, "done": false, "training_iteration": 12, "trial_id": "567b5_00000", "date": "2024-09-01_21-11-35", "timestamp": 1725192695, "time_this_iter_s": 70.0309407711029, "time_total_s": 841.4143400192261, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 841.4143400192261, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 86.32525252525254, "ram_util_percent": 66.99595959595959}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -12343.400390625, "policy_loss": -11988.720703125, "entropy": 13.471587181091309, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 394.2322998046875, "vf_explained_var": -0.0037468671798706055}, "model": {}, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 830788, "num_env_steps_trained": 1217296, "num_agent_steps_sampled": 2242390, "num_agent_steps_trained": 1217296, "num_training_step_calls_since_last_synch_worker_weights": 19475, "num_weight_broadcasts": 30, "num_samples_added_to_queue": 481447, "num_times_learner_queue_full": 53, "learner_queue": {"size_count": 59, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 201.439, "learner_load_time_ms": 1989.688, "learner_load_wait_time_ms": 13784.091, "learner_dequeue_time_ms": 97404.418}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2242390, "num_agent_steps_trained": 1217296, "num_env_steps_sampled": 830788, "num_env_steps_trained": 1217296, "num_env_steps_sampled_this_iter": 91364, "num_env_steps_trained_this_iter": 95628, "num_env_steps_sampled_throughput_per_sec": 9136.33356271418, "num_env_steps_trained_throughput_per_sec": 9562.730462055422, "timesteps_total": 830788, "num_env_steps_sampled_lifetime": 830788, "num_agent_steps_sampled_lifetime": 2242390, "num_steps_trained_this_iter": 95628, "agent_timesteps_total": 2242390, "timers": {"training_iteration_time_ms": 10001.068, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.221, "sample_time_ms": 0.148, "synch_weights_time_ms": 0.016}, "counters": {"num_env_steps_sampled": 830788, "num_env_steps_trained": 1217296, "num_agent_steps_sampled": 2242390, "num_agent_steps_trained": 1217296, "num_training_step_calls_since_last_synch_worker_weights": 19475, "num_weight_broadcasts": 30, "num_samples_added_to_queue": 481447, "num_times_learner_queue_full": 53}, "done": false, "training_iteration": 13, "trial_id": "567b5_00000", "date": "2024-09-01_21-12-45", "timestamp": 1725192765, "time_this_iter_s": 70.02302527427673, "time_total_s": 911.4373652935028, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 911.4373652935028, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 86.318, "ram_util_percent": 66.809}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 19698.123046875, "policy_loss": -2978.31201171875, "entropy": 11.642610549926758, "entropy_coeff": 0.01, "var_gnorm": 2047.2242431640625, "vf_loss": 46249.1171875, "vf_explained_var": -0.02266716957092285}, "model": {}, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 37.48921579078279}}, "num_env_steps_sampled": 899689, "num_env_steps_trained": 1314921, "num_agent_steps_sampled": 2426825, "num_agent_steps_trained": 1314921, "num_training_step_calls_since_last_synch_worker_weights": 28177, "num_weight_broadcasts": 31, "num_samples_added_to_queue": 518025, "num_times_learner_queue_full": 58, "learner_queue": {"size_count": 63, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 192.934, "learner_load_time_ms": 1989.688, "learner_load_wait_time_ms": 13945.73, "learner_dequeue_time_ms": 97404.418}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2426825, "num_agent_steps_trained": 1314921, "num_env_steps_sampled": 899689, "num_env_steps_trained": 1314921, "num_env_steps_sampled_this_iter": 68901, "num_env_steps_trained_this_iter": 97625, "num_env_steps_sampled_throughput_per_sec": 6889.85885599135, "num_env_steps_trained_throughput_per_sec": 9762.15832594818, "timesteps_total": 899689, "num_env_steps_sampled_lifetime": 899689, "num_agent_steps_sampled_lifetime": 2426825, "num_steps_trained_this_iter": 97625, "agent_timesteps_total": 2426825, "timers": {"training_iteration_time_ms": 10000.304, "restore_workers_time_ms": 0.011, "training_step_time_ms": 0.68, "sample_time_ms": 0.602, "synch_weights_time_ms": 0.018}, "counters": {"num_env_steps_sampled": 899689, "num_env_steps_trained": 1314921, "num_agent_steps_sampled": 2426825, "num_agent_steps_trained": 1314921, "num_training_step_calls_since_last_synch_worker_weights": 28177, "num_weight_broadcasts": 31, "num_samples_added_to_queue": 518025, "num_times_learner_queue_full": 58}, "done": false, "training_iteration": 14, "trial_id": "567b5_00000", "date": "2024-09-01_21-13-55", "timestamp": 1725192835, "time_this_iter_s": 70.02854442596436, "time_total_s": 981.4659097194672, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 981.4659097194672, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 84.90000000000002, "ram_util_percent": 66.66363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 160145.265625, "policy_loss": 143279.8125, "entropy": 13.095819473266602, "entropy_coeff": 0.01, "var_gnorm": 2047.2242431640625, "vf_loss": 34803.71875, "vf_explained_var": -0.0003949403762817383}, "model": {}, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 967181, "num_env_steps_trained": 1431614, "num_agent_steps_sampled": 2599413, "num_agent_steps_trained": 1431614, "num_training_step_calls_since_last_synch_worker_weights": 171, "num_weight_broadcasts": 34, "num_samples_added_to_queue": 552765, "num_times_learner_queue_full": 63, "learner_queue": {"size_count": 68, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 195.537, "learner_load_time_ms": 2259.883, "learner_load_wait_time_ms": 14002.624, "learner_dequeue_time_ms": 100953.125}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2599413, "num_agent_steps_trained": 1431614, "num_env_steps_sampled": 967181, "num_env_steps_trained": 1431614, "num_env_steps_sampled_this_iter": 67492, "num_env_steps_trained_this_iter": 116693, "num_env_steps_sampled_throughput_per_sec": 6749.074811644472, "num_env_steps_trained_throughput_per_sec": 11669.083550572339, "timesteps_total": 967181, "num_env_steps_sampled_lifetime": 967181, "num_agent_steps_sampled_lifetime": 2599413, "num_steps_trained_this_iter": 116693, "agent_timesteps_total": 2599413, "timers": {"training_iteration_time_ms": 10000.313, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.603, "sample_time_ms": 0.423, "synch_weights_time_ms": 0.084}, "counters": {"num_env_steps_sampled": 967181, "num_env_steps_trained": 1431614, "num_agent_steps_sampled": 2599413, "num_agent_steps_trained": 1431614, "num_training_step_calls_since_last_synch_worker_weights": 171, "num_weight_broadcasts": 34, "num_samples_added_to_queue": 552765, "num_times_learner_queue_full": 63}, "done": false, "training_iteration": 15, "trial_id": "567b5_00000", "date": "2024-09-01_21-15-06", "timestamp": 1725192906, "time_this_iter_s": 70.14766693115234, "time_total_s": 1051.6135766506195, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1051.6135766506195, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 87.52727272727272, "ram_util_percent": 66.58989898989898}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -82642.9921875, "policy_loss": -106547.703125, "entropy": 12.36218547821045, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 48790.23046875, "vf_explained_var": -0.018442869186401367}, "model": {}, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 31.692922374429223}}, "num_env_steps_sampled": 1069518, "num_env_steps_trained": 1494820, "num_agent_steps_sampled": 2895623, "num_agent_steps_trained": 1494820, "num_training_step_calls_since_last_synch_worker_weights": 5729, "num_weight_broadcasts": 37, "num_samples_added_to_queue": 603510, "num_times_learner_queue_full": 71, "learner_queue": {"size_count": 74, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 243.75, "learner_load_time_ms": 2187.14, "learner_load_wait_time_ms": 8152.005, "learner_dequeue_time_ms": 97140.703}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2895623, "num_agent_steps_trained": 1494820, "num_env_steps_sampled": 1069518, "num_env_steps_trained": 1494820, "num_env_steps_sampled_this_iter": 102337, "num_env_steps_trained_this_iter": 63206, "num_env_steps_sampled_throughput_per_sec": 10233.00857786394, "num_env_steps_trained_throughput_per_sec": 6320.172959657486, "timesteps_total": 1069518, "num_env_steps_sampled_lifetime": 1069518, "num_agent_steps_sampled_lifetime": 2895623, "num_steps_trained_this_iter": 63206, "agent_timesteps_total": 2895623, "timers": {"training_iteration_time_ms": 10000.366, "restore_workers_time_ms": 0.012, "training_step_time_ms": 0.705, "sample_time_ms": 0.603, "synch_weights_time_ms": 0.034}, "counters": {"num_env_steps_sampled": 1069518, "num_env_steps_trained": 1494820, "num_agent_steps_sampled": 2895623, "num_agent_steps_trained": 1494820, "num_training_step_calls_since_last_synch_worker_weights": 5729, "num_weight_broadcasts": 37, "num_samples_added_to_queue": 603510, "num_times_learner_queue_full": 71}, "done": false, "training_iteration": 16, "trial_id": "567b5_00000", "date": "2024-09-01_21-16-16", "timestamp": 1725192976, "time_this_iter_s": 70.09018683433533, "time_total_s": 1121.7037634849548, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1121.7037634849548, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 89.45400000000001, "ram_util_percent": 66.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 18862.2734375, "policy_loss": 18031.23828125, "entropy": 14.942353248596191, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 2782.451171875, "vf_explained_var": 0.05441230535507202}, "model": {}, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 26.7336943145459}}, "num_env_steps_sampled": 1141388, "num_env_steps_trained": 1668568, "num_agent_steps_sampled": 3086684, "num_agent_steps_trained": 1668568, "num_training_step_calls_since_last_synch_worker_weights": 11566, "num_weight_broadcasts": 39, "num_samples_added_to_queue": 651549, "num_times_learner_queue_full": 75, "learner_queue": {"size_count": 79, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 272.531, "learner_load_time_ms": 2187.14, "learner_load_wait_time_ms": 7926.306, "learner_dequeue_time_ms": 97140.703}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3086684, "num_agent_steps_trained": 1668568, "num_env_steps_sampled": 1141388, "num_env_steps_trained": 1668568, "num_env_steps_sampled_this_iter": 71870, "num_env_steps_trained_this_iter": 173748, "num_env_steps_sampled_throughput_per_sec": 7186.906614682555, "num_env_steps_trained_throughput_per_sec": 17374.574238039022, "timesteps_total": 1141388, "num_env_steps_sampled_lifetime": 1141388, "num_agent_steps_sampled_lifetime": 3086684, "num_steps_trained_this_iter": 173748, "agent_timesteps_total": 3086684, "timers": {"training_iteration_time_ms": 10000.368, "restore_workers_time_ms": 0.014, "training_step_time_ms": 0.501, "sample_time_ms": 0.401, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 1141388, "num_env_steps_trained": 1668568, "num_agent_steps_sampled": 3086684, "num_agent_steps_trained": 1668568, "num_training_step_calls_since_last_synch_worker_weights": 11566, "num_weight_broadcasts": 39, "num_samples_added_to_queue": 651549, "num_times_learner_queue_full": 75}, "done": false, "training_iteration": 17, "trial_id": "567b5_00000", "date": "2024-09-01_21-17-26", "timestamp": 1725193046, "time_this_iter_s": 70.2229380607605, "time_total_s": 1191.9267015457153, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1191.9267015457153, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 87.03939393939393, "ram_util_percent": 66.54343434343434}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -53488.328125, "policy_loss": -57181.53125, "entropy": 10.660161972045898, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 8259.685546875, "vf_explained_var": -0.0011637210845947266}, "model": {}, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 1235450, "num_env_steps_trained": 1778400, "num_agent_steps_sampled": 3308558, "num_agent_steps_trained": 1778400, "num_training_step_calls_since_last_synch_worker_weights": 14628, "num_weight_broadcasts": 42, "num_samples_added_to_queue": 701059, "num_times_learner_queue_full": 82, "learner_queue": {"size_count": 85, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 224.49, "learner_load_time_ms": 2519.565, "learner_load_wait_time_ms": 7854.393, "learner_dequeue_time_ms": 101612.398}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3308558, "num_agent_steps_trained": 1778400, "num_env_steps_sampled": 1235450, "num_env_steps_trained": 1778400, "num_env_steps_sampled_this_iter": 94062, "num_env_steps_trained_this_iter": 109832, "num_env_steps_sampled_throughput_per_sec": 9405.520088937052, "num_env_steps_trained_throughput_per_sec": 10982.406098191983, "timesteps_total": 1235450, "num_env_steps_sampled_lifetime": 1235450, "num_agent_steps_sampled_lifetime": 3308558, "num_steps_trained_this_iter": 109832, "agent_timesteps_total": 3308558, "timers": {"training_iteration_time_ms": 10000.425, "restore_workers_time_ms": 0.013, "training_step_time_ms": 0.534, "sample_time_ms": 0.442, "synch_weights_time_ms": 0.023}, "counters": {"num_env_steps_sampled": 1235450, "num_env_steps_trained": 1778400, "num_agent_steps_sampled": 3308558, "num_agent_steps_trained": 1778400, "num_training_step_calls_since_last_synch_worker_weights": 14628, "num_weight_broadcasts": 42, "num_samples_added_to_queue": 701059, "num_times_learner_queue_full": 82}, "done": false, "training_iteration": 18, "trial_id": "567b5_00000", "date": "2024-09-01_21-18-36", "timestamp": 1725193116, "time_this_iter_s": 70.03315997123718, "time_total_s": 1261.9598615169525, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1261.9598615169525, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 86.26599999999999, "ram_util_percent": 66.584}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 44990.7734375, "policy_loss": 37625.25, "entropy": 10.534414291381836, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 15549.3603515625, "vf_explained_var": 0.0343477725982666}, "model": {}, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 1284818, "num_env_steps_trained": 1914976, "num_agent_steps_sampled": 3439999, "num_agent_steps_trained": 1914976, "num_training_step_calls_since_last_synch_worker_weights": 8308, "num_weight_broadcasts": 44, "num_samples_added_to_queue": 733175, "num_times_learner_queue_full": 85, "learner_queue": {"size_count": 90, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 189.641, "learner_load_time_ms": 2541.367, "learner_load_wait_time_ms": 7415.2, "learner_dequeue_time_ms": 94599.412}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3439999, "num_agent_steps_trained": 1914976, "num_env_steps_sampled": 1284818, "num_env_steps_trained": 1914976, "num_env_steps_sampled_this_iter": 49368, "num_env_steps_trained_this_iter": 136576, "num_env_steps_sampled_throughput_per_sec": 4936.604856995275, "num_env_steps_trained_throughput_per_sec": 13657.060139138444, "timesteps_total": 1284818, "num_env_steps_sampled_lifetime": 1284818, "num_agent_steps_sampled_lifetime": 3439999, "num_steps_trained_this_iter": 136576, "agent_timesteps_total": 3439999, "timers": {"training_iteration_time_ms": 10000.445, "restore_workers_time_ms": 0.014, "training_step_time_ms": 0.667, "sample_time_ms": 0.58, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 1284818, "num_env_steps_trained": 1914976, "num_agent_steps_sampled": 3439999, "num_agent_steps_trained": 1914976, "num_training_step_calls_since_last_synch_worker_weights": 8308, "num_weight_broadcasts": 44, "num_samples_added_to_queue": 733175, "num_times_learner_queue_full": 85}, "done": false, "training_iteration": 19, "trial_id": "567b5_00000", "date": "2024-09-01_21-19-46", "timestamp": 1725193186, "time_this_iter_s": 70.02265667915344, "time_total_s": 1331.982518196106, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1331.982518196106, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 85.97171717171717, "ram_util_percent": 66.42525252525253}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 50488.15625, "policy_loss": 35598.8828125, "entropy": 10.852787017822266, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 30667.611328125, "vf_explained_var": -0.0004329681396484375}, "model": {}, "num_grad_updates_lifetime": 92.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 1344569, "num_env_steps_trained": 1994654, "num_agent_steps_sampled": 3591366, "num_agent_steps_trained": 1994654, "num_training_step_calls_since_last_synch_worker_weights": 23515, "num_weight_broadcasts": 46, "num_samples_added_to_queue": 770185, "num_times_learner_queue_full": 88, "learner_queue": {"size_count": 95, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 219.495, "learner_load_time_ms": 2541.367, "learner_load_wait_time_ms": 13535.838, "learner_dequeue_time_ms": 94599.412}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3591366, "num_agent_steps_trained": 1994654, "num_env_steps_sampled": 1344569, "num_env_steps_trained": 1994654, "num_env_steps_sampled_this_iter": 59751, "num_env_steps_trained_this_iter": 79678, "num_env_steps_sampled_throughput_per_sec": 5974.991734273003, "num_env_steps_trained_throughput_per_sec": 7967.655627577854, "timesteps_total": 1344569, "num_env_steps_sampled_lifetime": 1344569, "num_agent_steps_sampled_lifetime": 3591366, "num_steps_trained_this_iter": 79678, "agent_timesteps_total": 3591366, "timers": {"training_iteration_time_ms": 10000.436, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.236, "sample_time_ms": 0.167, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 1344569, "num_env_steps_trained": 1994654, "num_agent_steps_sampled": 3591366, "num_agent_steps_trained": 1994654, "num_training_step_calls_since_last_synch_worker_weights": 23515, "num_weight_broadcasts": 46, "num_samples_added_to_queue": 770185, "num_times_learner_queue_full": 88}, "done": false, "training_iteration": 20, "trial_id": "567b5_00000", "date": "2024-09-01_21-20-56", "timestamp": 1725193256, "time_this_iter_s": 70.0227403640747, "time_total_s": 1402.0052585601807, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1402.0052585601807, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 85.69, "ram_util_percent": 66.403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 5356.17138671875, "policy_loss": 5233.41796875, "entropy": 10.46060562133789, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 1102.4398193359375, "vf_explained_var": 9.644031524658203e-05}, "model": {}, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 1409889, "num_env_steps_trained": 2086711, "num_agent_steps_sampled": 3767270, "num_agent_steps_trained": 2086711, "num_training_step_calls_since_last_synch_worker_weights": 3300, "num_weight_broadcasts": 49, "num_samples_added_to_queue": 819139, "num_times_learner_queue_full": 91, "learner_queue": {"size_count": 101, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 219.917, "learner_load_time_ms": 2733.342, "learner_load_wait_time_ms": 8181.526, "learner_dequeue_time_ms": 94668.478}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3767270, "num_agent_steps_trained": 2086711, "num_env_steps_sampled": 1409889, "num_env_steps_trained": 2086711, "num_env_steps_sampled_this_iter": 65320, "num_env_steps_trained_this_iter": 92057, "num_env_steps_sampled_throughput_per_sec": 6531.974303823468, "num_env_steps_trained_throughput_per_sec": 9205.663785778888, "timesteps_total": 1409889, "num_env_steps_sampled_lifetime": 1409889, "num_agent_steps_sampled_lifetime": 3767270, "num_steps_trained_this_iter": 92057, "agent_timesteps_total": 3767270, "timers": {"training_iteration_time_ms": 10000.38, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.272, "sample_time_ms": 0.197, "synch_weights_time_ms": 0.017}, "counters": {"num_env_steps_sampled": 1409889, "num_env_steps_trained": 2086711, "num_agent_steps_sampled": 3767270, "num_agent_steps_trained": 2086711, "num_training_step_calls_since_last_synch_worker_weights": 3300, "num_weight_broadcasts": 49, "num_samples_added_to_queue": 819139, "num_times_learner_queue_full": 91}, "done": false, "training_iteration": 21, "trial_id": "567b5_00000", "date": "2024-09-01_21-22-06", "timestamp": 1725193326, "time_this_iter_s": 70.0218243598938, "time_total_s": 1472.0270829200745, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1472.0270829200745, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 87.19494949494948, "ram_util_percent": 66.91818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -110811.5703125, "policy_loss": -119001.3125, "entropy": 13.039437294006348, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 17401.0, "vf_explained_var": 0.026386916637420654}, "model": {}, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 1525627, "num_env_steps_trained": 2234369, "num_agent_steps_sampled": 4038305, "num_agent_steps_trained": 2234369, "num_training_step_calls_since_last_synch_worker_weights": 11115, "num_weight_broadcasts": 52, "num_samples_added_to_queue": 893890, "num_times_learner_queue_full": 96, "learner_queue": {"size_count": 107, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 188.995, "learner_load_time_ms": 2649.977, "learner_load_wait_time_ms": 7893.673, "learner_dequeue_time_ms": 87817.357}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4038305, "num_agent_steps_trained": 2234369, "num_env_steps_sampled": 1525627, "num_env_steps_trained": 2234369, "num_env_steps_sampled_this_iter": 115738, "num_env_steps_trained_this_iter": 147658, "num_env_steps_sampled_throughput_per_sec": 11573.748951159574, "num_env_steps_trained_throughput_per_sec": 14765.73487212774, "timesteps_total": 1525627, "num_env_steps_sampled_lifetime": 1525627, "num_agent_steps_sampled_lifetime": 4038305, "num_steps_trained_this_iter": 147658, "agent_timesteps_total": 4038305, "timers": {"training_iteration_time_ms": 10000.298, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.395, "sample_time_ms": 0.323, "synch_weights_time_ms": 0.018}, "counters": {"num_env_steps_sampled": 1525627, "num_env_steps_trained": 2234369, "num_agent_steps_sampled": 4038305, "num_agent_steps_trained": 2234369, "num_training_step_calls_since_last_synch_worker_weights": 11115, "num_weight_broadcasts": 52, "num_samples_added_to_queue": 893890, "num_times_learner_queue_full": 96}, "done": false, "training_iteration": 22, "trial_id": "567b5_00000", "date": "2024-09-01_21-23-16", "timestamp": 1725193396, "time_this_iter_s": 70.02950096130371, "time_total_s": 1542.0565838813782, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1542.0565838813782, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 85.97878787878787, "ram_util_percent": 67.44848484848485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -42155.21484375, "policy_loss": -47153.31640625, "entropy": 11.124998092651367, "entropy_coeff": 0.01, "var_gnorm": 2047.2242431640625, "vf_loss": 10891.541015625, "vf_explained_var": -0.007071733474731445}, "model": {}, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 1621503, "num_env_steps_trained": 2364029, "num_agent_steps_sampled": 4291531, "num_agent_steps_trained": 2364029, "num_training_step_calls_since_last_synch_worker_weights": 16494, "num_weight_broadcasts": 54, "num_samples_added_to_queue": 950690, "num_times_learner_queue_full": 102, "learner_queue": {"size_count": 112, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 203.423, "learner_load_time_ms": 2423.036, "learner_load_wait_time_ms": 7587.488, "learner_dequeue_time_ms": 87582.775}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4291531, "num_agent_steps_trained": 2364029, "num_env_steps_sampled": 1621503, "num_env_steps_trained": 2364029, "num_env_steps_sampled_this_iter": 95876, "num_env_steps_trained_this_iter": 129660, "num_env_steps_sampled_throughput_per_sec": 9586.952230486364, "num_env_steps_trained_throughput_per_sec": 12965.123974768054, "timesteps_total": 1621503, "num_env_steps_sampled_lifetime": 1621503, "num_agent_steps_sampled_lifetime": 4291531, "num_steps_trained_this_iter": 129660, "agent_timesteps_total": 4291531, "timers": {"training_iteration_time_ms": 10000.359, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.517, "sample_time_ms": 0.441, "synch_weights_time_ms": 0.017}, "counters": {"num_env_steps_sampled": 1621503, "num_env_steps_trained": 2364029, "num_agent_steps_sampled": 4291531, "num_agent_steps_trained": 2364029, "num_training_step_calls_since_last_synch_worker_weights": 16494, "num_weight_broadcasts": 54, "num_samples_added_to_queue": 950690, "num_times_learner_queue_full": 102}, "done": false, "training_iteration": 23, "trial_id": "567b5_00000", "date": "2024-09-01_21-24-26", "timestamp": 1725193466, "time_this_iter_s": 70.026771068573, "time_total_s": 1612.0833549499512, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1612.0833549499512, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 85.435, "ram_util_percent": 67.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -39578.9609375, "policy_loss": -40818.57421875, "entropy": 10.761346817016602, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 3360.79638671875, "vf_explained_var": 4.589557647705078e-06}, "model": {}, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 1683368, "num_env_steps_trained": 2499819, "num_agent_steps_sampled": 4446483, "num_agent_steps_trained": 2499819, "num_training_step_calls_since_last_synch_worker_weights": 5772, "num_weight_broadcasts": 56, "num_samples_added_to_queue": 994963, "num_times_learner_queue_full": 105, "learner_queue": {"size_count": 117, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 208.932, "learner_load_time_ms": 2423.036, "learner_load_wait_time_ms": 13387.294, "learner_dequeue_time_ms": 87582.775}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4446483, "num_agent_steps_trained": 2499819, "num_env_steps_sampled": 1683368, "num_env_steps_trained": 2499819, "num_env_steps_sampled_this_iter": 61865, "num_env_steps_trained_this_iter": 135790, "num_env_steps_sampled_throughput_per_sec": 6186.410175232965, "num_env_steps_trained_throughput_per_sec": 13578.802839972268, "timesteps_total": 1683368, "num_env_steps_sampled_lifetime": 1683368, "num_agent_steps_sampled_lifetime": 4446483, "num_steps_trained_this_iter": 135790, "agent_timesteps_total": 4446483, "timers": {"training_iteration_time_ms": 10000.343, "restore_workers_time_ms": 0.009, "training_step_time_ms": 0.201, "sample_time_ms": 0.141, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 1683368, "num_env_steps_trained": 2499819, "num_agent_steps_sampled": 4446483, "num_agent_steps_trained": 2499819, "num_training_step_calls_since_last_synch_worker_weights": 5772, "num_weight_broadcasts": 56, "num_samples_added_to_queue": 994963, "num_times_learner_queue_full": 105}, "done": false, "training_iteration": 24, "trial_id": "567b5_00000", "date": "2024-09-01_21-25-36", "timestamp": 1725193536, "time_this_iter_s": 70.01993155479431, "time_total_s": 1682.1032865047455, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1682.1032865047455, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 85.26262626262626, "ram_util_percent": 67.27878787878788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 24184.724609375, "policy_loss": -1225.039306640625, "entropy": 13.8102445602417, "entropy_coeff": 0.01, "var_gnorm": 2047.2242431640625, "vf_loss": 51916.890625, "vf_explained_var": -0.06441640853881836}, "model": {}, "num_grad_updates_lifetime": 119.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 1709415, "num_env_steps_trained": 2634874, "num_agent_steps_sampled": 4523688, "num_agent_steps_trained": 2634874, "num_training_step_calls_since_last_synch_worker_weights": 26347, "num_weight_broadcasts": 57, "num_samples_added_to_queue": 1017209, "num_times_learner_queue_full": 105, "learner_queue": {"size_count": 121, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 221.166, "learner_load_time_ms": 2576.789, "learner_load_wait_time_ms": 13482.857, "learner_dequeue_time_ms": 93889.072}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4523688, "num_agent_steps_trained": 2634874, "num_env_steps_sampled": 1709415, "num_env_steps_trained": 2634874, "num_env_steps_sampled_this_iter": 26047, "num_env_steps_trained_this_iter": 135055, "num_env_steps_sampled_throughput_per_sec": 2604.689753393905, "num_env_steps_trained_throughput_per_sec": 13505.446870834025, "timesteps_total": 1709415, "num_env_steps_sampled_lifetime": 1709415, "num_agent_steps_sampled_lifetime": 4523688, "num_steps_trained_this_iter": 135055, "agent_timesteps_total": 4523688, "timers": {"training_iteration_time_ms": 10000.327, "restore_workers_time_ms": 0.011, "training_step_time_ms": 0.277, "sample_time_ms": 0.201, "synch_weights_time_ms": 0.017}, "counters": {"num_env_steps_sampled": 1709415, "num_env_steps_trained": 2634874, "num_agent_steps_sampled": 4523688, "num_agent_steps_trained": 2634874, "num_training_step_calls_since_last_synch_worker_weights": 26347, "num_weight_broadcasts": 57, "num_samples_added_to_queue": 1017209, "num_times_learner_queue_full": 105}, "done": false, "training_iteration": 25, "trial_id": "567b5_00000", "date": "2024-09-01_21-26-46", "timestamp": 1725193606, "time_this_iter_s": 70.02159142494202, "time_total_s": 1752.1248779296875, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1752.1248779296875, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 86.20700000000001, "ram_util_percent": 67.591}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -115813.78125, "policy_loss": -128712.3125, "entropy": 10.673394203186035, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 26608.453125, "vf_explained_var": 0.012204587459564209}, "model": {}, "num_grad_updates_lifetime": 122.0, "diff_num_grad_updates_vs_sampler_policy": 45.813312930374906}}, "num_env_steps_sampled": 1795159, "num_env_steps_trained": 2693967, "num_agent_steps_sampled": 4738463, "num_agent_steps_trained": 2693967, "num_training_step_calls_since_last_synch_worker_weights": 3402, "num_weight_broadcasts": 60, "num_samples_added_to_queue": 1073279, "num_times_learner_queue_full": 109, "learner_queue": {"size_count": 127, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 205.339, "learner_load_time_ms": 2576.789, "learner_load_wait_time_ms": 14018.872, "learner_dequeue_time_ms": 93889.072}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4738463, "num_agent_steps_trained": 2693967, "num_env_steps_sampled": 1795159, "num_env_steps_trained": 2693967, "num_env_steps_sampled_this_iter": 85744, "num_env_steps_trained_this_iter": 59093, "num_env_steps_sampled_throughput_per_sec": 8574.383645661077, "num_env_steps_trained_throughput_per_sec": 5909.288728926222, "timesteps_total": 1795159, "num_env_steps_sampled_lifetime": 1795159, "num_agent_steps_sampled_lifetime": 4738463, "num_steps_trained_this_iter": 59093, "agent_timesteps_total": 4738463, "timers": {"training_iteration_time_ms": 10000.262, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.313, "sample_time_ms": 0.245, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 1795159, "num_env_steps_trained": 2693967, "num_agent_steps_sampled": 4738463, "num_agent_steps_trained": 2693967, "num_training_step_calls_since_last_synch_worker_weights": 3402, "num_weight_broadcasts": 60, "num_samples_added_to_queue": 1073279, "num_times_learner_queue_full": 109}, "done": false, "training_iteration": 26, "trial_id": "567b5_00000", "date": "2024-09-01_21-27-56", "timestamp": 1725193676, "time_this_iter_s": 70.01887369155884, "time_total_s": 1822.1437516212463, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1822.1437516212463, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 85.47373737373736, "ram_util_percent": 68.70808080808082}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -219053.828125, "policy_loss": -241458.140625, "entropy": 15.557506561279297, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 45983.83984375, "vf_explained_var": 0.025924086570739746}, "model": {}, "num_grad_updates_lifetime": 127.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 1889116, "num_env_steps_trained": 2802899, "num_agent_steps_sampled": 4954521, "num_agent_steps_trained": 2802899, "num_training_step_calls_since_last_synch_worker_weights": 20802, "num_weight_broadcasts": 61, "num_samples_added_to_queue": 1140505, "num_times_learner_queue_full": 111, "learner_queue": {"size_count": 131, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 171.975, "learner_load_time_ms": 3302.287, "learner_load_wait_time_ms": 14395.851, "learner_dequeue_time_ms": 101671.784}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4954521, "num_agent_steps_trained": 2802899, "num_env_steps_sampled": 1889116, "num_env_steps_trained": 2802899, "num_env_steps_sampled_this_iter": 93957, "num_env_steps_trained_this_iter": 108932, "num_env_steps_sampled_throughput_per_sec": 9389.46789577602, "num_env_steps_trained_throughput_per_sec": 10885.974614160452, "timesteps_total": 1889116, "num_env_steps_sampled_lifetime": 1889116, "num_agent_steps_sampled_lifetime": 4954521, "num_steps_trained_this_iter": 108932, "agent_timesteps_total": 4954521, "timers": {"training_iteration_time_ms": 10000.912, "restore_workers_time_ms": 0.028, "training_step_time_ms": 33.439, "sample_time_ms": 33.241, "synch_weights_time_ms": 0.06}, "counters": {"num_env_steps_sampled": 1889116, "num_env_steps_trained": 2802899, "num_agent_steps_sampled": 4954521, "num_agent_steps_trained": 2802899, "num_training_step_calls_since_last_synch_worker_weights": 20802, "num_weight_broadcasts": 61, "num_samples_added_to_queue": 1140505, "num_times_learner_queue_full": 111}, "done": false, "training_iteration": 27, "trial_id": "567b5_00000", "date": "2024-09-01_21-29-07", "timestamp": 1725193747, "time_this_iter_s": 70.19277286529541, "time_total_s": 1892.3365244865417, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1892.3365244865417, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 86.10900000000001, "ram_util_percent": 68.67799999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 44060.05078125, "policy_loss": 42230.7109375, "entropy": 10.57687759399414, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 4525.14404296875, "vf_explained_var": 0.0002980828285217285}, "model": {}, "num_grad_updates_lifetime": 132.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 1960775, "num_env_steps_trained": 2969205, "num_agent_steps_sampled": 5128958, "num_agent_steps_trained": 2969205, "num_training_step_calls_since_last_synch_worker_weights": 23305, "num_weight_broadcasts": 63, "num_samples_added_to_queue": 1179004, "num_times_learner_queue_full": 115, "learner_queue": {"size_count": 135, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 189.807, "learner_load_time_ms": 3302.287, "learner_load_wait_time_ms": 13857.739, "learner_dequeue_time_ms": 101671.784}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5128958, "num_agent_steps_trained": 2969205, "num_env_steps_sampled": 1960775, "num_env_steps_trained": 2969205, "num_env_steps_sampled_this_iter": 71659, "num_env_steps_trained_this_iter": 166306, "num_env_steps_sampled_throughput_per_sec": 7016.593889943646, "num_env_steps_trained_throughput_per_sec": 16284.090811495667, "timesteps_total": 1960775, "num_env_steps_sampled_lifetime": 1960775, "num_agent_steps_sampled_lifetime": 5128958, "num_steps_trained_this_iter": 166306, "agent_timesteps_total": 5128958, "timers": {"training_iteration_time_ms": 10022.12, "restore_workers_time_ms": 0.031, "training_step_time_ms": 34.731, "sample_time_ms": 34.515, "synch_weights_time_ms": 0.062}, "counters": {"num_env_steps_sampled": 1960775, "num_env_steps_trained": 2969205, "num_agent_steps_sampled": 5128958, "num_agent_steps_trained": 2969205, "num_training_step_calls_since_last_synch_worker_weights": 23305, "num_weight_broadcasts": 63, "num_samples_added_to_queue": 1179004, "num_times_learner_queue_full": 115}, "done": false, "training_iteration": 28, "trial_id": "567b5_00000", "date": "2024-09-01_21-30-17", "timestamp": 1725193817, "time_this_iter_s": 70.25503158569336, "time_total_s": 1962.591556072235, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1962.591556072235, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 85.88300000000001, "ram_util_percent": 68.80900000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -59360.9296875, "policy_loss": -75835.140625, "entropy": 14.242921829223633, "entropy_coeff": 0.01, "var_gnorm": 2047.2242431640625, "vf_loss": 34045.984375, "vf_explained_var": 0.01479184627532959}, "model": {}, "num_grad_updates_lifetime": 135.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 2084328, "num_env_steps_trained": 3041865, "num_agent_steps_sampled": 5429460, "num_agent_steps_trained": 3041865, "num_training_step_calls_since_last_synch_worker_weights": 12606, "num_weight_broadcasts": 66, "num_samples_added_to_queue": 1249411, "num_times_learner_queue_full": 121, "learner_queue": {"size_count": 141, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 216.675, "learner_load_time_ms": 4166.758, "learner_load_wait_time_ms": 13973.855, "learner_dequeue_time_ms": 101883.371}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5429460, "num_agent_steps_trained": 3041865, "num_env_steps_sampled": 2084328, "num_env_steps_trained": 3041865, "num_env_steps_sampled_this_iter": 123553, "num_env_steps_trained_this_iter": 72660, "num_env_steps_sampled_throughput_per_sec": 12355.043726538608, "num_env_steps_trained_throughput_per_sec": 7265.849288728686, "timesteps_total": 2084328, "num_env_steps_sampled_lifetime": 2084328, "num_agent_steps_sampled_lifetime": 5429460, "num_steps_trained_this_iter": 72660, "agent_timesteps_total": 5429460, "timers": {"training_iteration_time_ms": 10022.101, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.268, "sample_time_ms": 0.199, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 2084328, "num_env_steps_trained": 3041865, "num_agent_steps_sampled": 5429460, "num_agent_steps_trained": 3041865, "num_training_step_calls_since_last_synch_worker_weights": 12606, "num_weight_broadcasts": 66, "num_samples_added_to_queue": 1249411, "num_times_learner_queue_full": 121}, "done": false, "training_iteration": 29, "trial_id": "567b5_00000", "date": "2024-09-01_21-31-27", "timestamp": 1725193887, "time_this_iter_s": 70.0633556842804, "time_total_s": 2032.6549117565155, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2032.6549117565155, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 85.90505050505051, "ram_util_percent": 69.51919191919193}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 78321.8203125, "policy_loss": 60329.7578125, "entropy": 15.587848663330078, "entropy_coeff": 0.01, "var_gnorm": 2047.2242431640625, "vf_loss": 37261.078125, "vf_explained_var": -0.00030803680419921875}, "model": {}, "num_grad_updates_lifetime": 141.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 2189387, "num_env_steps_trained": 3209840, "num_agent_steps_sampled": 5712536, "num_agent_steps_trained": 3209840, "num_training_step_calls_since_last_synch_worker_weights": 3127, "num_weight_broadcasts": 73, "num_samples_added_to_queue": 1343285, "num_times_learner_queue_full": 123, "learner_queue": {"size_count": 151, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 222.273, "learner_load_time_ms": 3838.157, "learner_load_wait_time_ms": 7578.434, "learner_dequeue_time_ms": 88752.294}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5712536, "num_agent_steps_trained": 3209840, "num_env_steps_sampled": 2189387, "num_env_steps_trained": 3209840, "num_env_steps_sampled_this_iter": 105059, "num_env_steps_trained_this_iter": 167975, "num_env_steps_sampled_throughput_per_sec": 10505.476204639954, "num_env_steps_trained_throughput_per_sec": 16796.822409069155, "timesteps_total": 2189387, "num_env_steps_sampled_lifetime": 2189387, "num_agent_steps_sampled_lifetime": 5712536, "num_steps_trained_this_iter": 167975, "agent_timesteps_total": 5712536, "timers": {"training_iteration_time_ms": 10022.125, "restore_workers_time_ms": 0.012, "training_step_time_ms": 0.555, "sample_time_ms": 0.457, "synch_weights_time_ms": 0.022}, "counters": {"num_env_steps_sampled": 2189387, "num_env_steps_trained": 3209840, "num_agent_steps_sampled": 5712536, "num_agent_steps_trained": 3209840, "num_training_step_calls_since_last_synch_worker_weights": 3127, "num_weight_broadcasts": 73, "num_samples_added_to_queue": 1343285, "num_times_learner_queue_full": 123}, "done": false, "training_iteration": 30, "trial_id": "567b5_00000", "date": "2024-09-01_21-32-37", "timestamp": 1725193957, "time_this_iter_s": 70.13659429550171, "time_total_s": 2102.791506052017, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2102.791506052017, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 89.47575757575758, "ram_util_percent": 69.82626262626263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -47609.2421875, "policy_loss": -49140.4140625, "entropy": 10.729015350341797, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 3941.267578125, "vf_explained_var": 0.0012879371643066406}, "model": {}, "num_grad_updates_lifetime": 152.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 2309135, "num_env_steps_trained": 3480392, "num_agent_steps_sampled": 6025923, "num_agent_steps_trained": 3480392, "num_training_step_calls_since_last_synch_worker_weights": 9021, "num_weight_broadcasts": 76, "num_samples_added_to_queue": 1429696, "num_times_learner_queue_full": 128, "learner_queue": {"size_count": 156, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 222.905, "learner_load_time_ms": 3838.157, "learner_load_wait_time_ms": 7282.926, "learner_dequeue_time_ms": 88752.294}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6025923, "num_agent_steps_trained": 3480392, "num_env_steps_sampled": 2309135, "num_env_steps_trained": 3480392, "num_env_steps_sampled_this_iter": 119748, "num_env_steps_trained_this_iter": 270552, "num_env_steps_sampled_throughput_per_sec": 11974.640977787385, "num_env_steps_trained_throughput_per_sec": 27054.840714018876, "timesteps_total": 2309135, "num_env_steps_sampled_lifetime": 2309135, "num_agent_steps_sampled_lifetime": 6025923, "num_steps_trained_this_iter": 270552, "agent_timesteps_total": 6025923, "timers": {"training_iteration_time_ms": 10022.135, "restore_workers_time_ms": 0.009, "training_step_time_ms": 0.21, "sample_time_ms": 0.145, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 2309135, "num_env_steps_trained": 3480392, "num_agent_steps_sampled": 6025923, "num_agent_steps_trained": 3480392, "num_training_step_calls_since_last_synch_worker_weights": 9021, "num_weight_broadcasts": 76, "num_samples_added_to_queue": 1429696, "num_times_learner_queue_full": 128}, "done": false, "training_iteration": 31, "trial_id": "567b5_00000", "date": "2024-09-01_21-33-47", "timestamp": 1725194027, "time_this_iter_s": 70.15741539001465, "time_total_s": 2172.948921442032, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2172.948921442032, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 88.22900000000001, "ram_util_percent": 69.428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 17050.2421875, "policy_loss": 16938.296875, "entropy": 10.408918380737305, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 1076.588623046875, "vf_explained_var": -0.0015866756439208984}, "model": {}, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 2348394, "num_env_steps_trained": 3698494, "num_agent_steps_sampled": 6140377, "num_agent_steps_trained": 3698494, "num_training_step_calls_since_last_synch_worker_weights": 17338, "num_weight_broadcasts": 78, "num_samples_added_to_queue": 1468955, "num_times_learner_queue_full": 128, "learner_queue": {"size_count": 161, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 234.012, "learner_load_time_ms": 3736.413, "learner_load_wait_time_ms": 12526.281, "learner_dequeue_time_ms": 87687.182}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6140377, "num_agent_steps_trained": 3698494, "num_env_steps_sampled": 2348394, "num_env_steps_trained": 3698494, "num_env_steps_sampled_this_iter": 39259, "num_env_steps_trained_this_iter": 218102, "num_env_steps_sampled_throughput_per_sec": 3925.8611560730988, "num_env_steps_trained_throughput_per_sec": 21809.98420392407, "timesteps_total": 2348394, "num_env_steps_sampled_lifetime": 2348394, "num_agent_steps_sampled_lifetime": 6140377, "num_steps_trained_this_iter": 218102, "agent_timesteps_total": 6140377, "timers": {"training_iteration_time_ms": 10022.141, "restore_workers_time_ms": 0.012, "training_step_time_ms": 0.361, "sample_time_ms": 0.278, "synch_weights_time_ms": 0.019}, "counters": {"num_env_steps_sampled": 2348394, "num_env_steps_trained": 3698494, "num_agent_steps_sampled": 6140377, "num_agent_steps_trained": 3698494, "num_training_step_calls_since_last_synch_worker_weights": 17338, "num_weight_broadcasts": 78, "num_samples_added_to_queue": 1468955, "num_times_learner_queue_full": 128}, "done": false, "training_iteration": 32, "trial_id": "567b5_00000", "date": "2024-09-01_21-34-57", "timestamp": 1725194097, "time_this_iter_s": 70.25442886352539, "time_total_s": 2243.2033503055573, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2243.2033503055573, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 86.69999999999999, "ram_util_percent": 68.5909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 111602.0625, "policy_loss": 104360.5234375, "entropy": 12.83404541015625, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 15534.435546875, "vf_explained_var": 0.00035947561264038086}, "model": {}, "num_grad_updates_lifetime": 162.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 2484721, "num_env_steps_trained": 3800396, "num_agent_steps_sampled": 6503205, "num_agent_steps_trained": 3800396, "num_training_step_calls_since_last_synch_worker_weights": 11123, "num_weight_broadcasts": 81, "num_samples_added_to_queue": 1534277, "num_times_learner_queue_full": 137, "learner_queue": {"size_count": 167, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 177.804, "learner_load_time_ms": 3672.435, "learner_load_wait_time_ms": 8170.349, "learner_dequeue_time_ms": 88438.558}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6503205, "num_agent_steps_trained": 3800396, "num_env_steps_sampled": 2484721, "num_env_steps_trained": 3800396, "num_env_steps_sampled_this_iter": 136327, "num_env_steps_trained_this_iter": 101902, "num_env_steps_sampled_throughput_per_sec": 13632.42080589599, "num_env_steps_trained_throughput_per_sec": 10189.991307388947, "timesteps_total": 2484721, "num_env_steps_sampled_lifetime": 2484721, "num_agent_steps_sampled_lifetime": 6503205, "num_steps_trained_this_iter": 101902, "agent_timesteps_total": 6503205, "timers": {"training_iteration_time_ms": 10022.094, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.314, "sample_time_ms": 0.248, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 2484721, "num_env_steps_trained": 3800396, "num_agent_steps_sampled": 6503205, "num_agent_steps_trained": 3800396, "num_training_step_calls_since_last_synch_worker_weights": 11123, "num_weight_broadcasts": 81, "num_samples_added_to_queue": 1534277, "num_times_learner_queue_full": 137}, "done": false, "training_iteration": 33, "trial_id": "567b5_00000", "date": "2024-09-01_21-36-08", "timestamp": 1725194168, "time_this_iter_s": 70.2261393070221, "time_total_s": 2313.4294896125793, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2313.4294896125793, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 84.068, "ram_util_percent": 68.40500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 151647.390625, "policy_loss": 128792.90625, "entropy": 12.932010650634766, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 46768.35546875, "vf_explained_var": 0.0005303025245666504}, "model": {}, "num_grad_updates_lifetime": 169.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 2523046, "num_env_steps_trained": 3977529, "num_agent_steps_sampled": 6607704, "num_agent_steps_trained": 3977529, "num_training_step_calls_since_last_synch_worker_weights": 6396, "num_weight_broadcasts": 83, "num_samples_added_to_queue": 1561955, "num_times_learner_queue_full": 138, "learner_queue": {"size_count": 171, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 175.392, "learner_load_time_ms": 3672.435, "learner_load_wait_time_ms": 13645.79, "learner_dequeue_time_ms": 88438.558}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6607704, "num_agent_steps_trained": 3977529, "num_env_steps_sampled": 2523046, "num_env_steps_trained": 3977529, "num_env_steps_sampled_this_iter": 38325, "num_env_steps_trained_this_iter": 177133, "num_env_steps_sampled_throughput_per_sec": 3832.451024204517, "num_env_steps_trained_throughput_per_sec": 17713.0736404545, "timesteps_total": 2523046, "num_env_steps_sampled_lifetime": 2523046, "num_agent_steps_sampled_lifetime": 6607704, "num_steps_trained_this_iter": 177133, "agent_timesteps_total": 6607704, "timers": {"training_iteration_time_ms": 10022.089, "restore_workers_time_ms": 0.009, "training_step_time_ms": 0.221, "sample_time_ms": 0.156, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 2523046, "num_env_steps_trained": 3977529, "num_agent_steps_sampled": 6607704, "num_agent_steps_trained": 3977529, "num_training_step_calls_since_last_synch_worker_weights": 6396, "num_weight_broadcasts": 83, "num_samples_added_to_queue": 1561955, "num_times_learner_queue_full": 138}, "done": false, "training_iteration": 34, "trial_id": "567b5_00000", "date": "2024-09-01_21-37-18", "timestamp": 1725194238, "time_this_iter_s": 70.0351448059082, "time_total_s": 2383.4646344184875, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2383.4646344184875, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 90.02020202020203, "ram_util_percent": 69.6939393939394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 40667.1953125, "policy_loss": 37701.23828125, "entropy": 11.034687995910645, "entropy_coeff": 0.01, "var_gnorm": 2047.2239990234375, "vf_loss": 6769.44873046875, "vf_explained_var": -0.006878256797790527}, "model": {}, "num_grad_updates_lifetime": 171.0, "diff_num_grad_updates_vs_sampler_policy": 18.398785302156085}}, "num_env_steps_sampled": 2613314, "num_env_steps_trained": 4013668, "num_agent_steps_sampled": 6852688, "num_agent_steps_trained": 4013668, "num_training_step_calls_since_last_synch_worker_weights": 6239, "num_weight_broadcasts": 85, "num_samples_added_to_queue": 1616222, "num_times_learner_queue_full": 143, "learner_queue": {"size_count": 176, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 200.728, "learner_load_time_ms": 3317.649, "learner_load_wait_time_ms": 14238.521, "learner_dequeue_time_ms": 88711.482}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6852688, "num_agent_steps_trained": 4013668, "num_env_steps_sampled": 2613314, "num_env_steps_trained": 4013668, "num_env_steps_sampled_this_iter": 90268, "num_env_steps_trained_this_iter": 36139, "num_env_steps_sampled_throughput_per_sec": 9026.579409315716, "num_env_steps_trained_throughput_per_sec": 3613.8116860156497, "timesteps_total": 2613314, "num_env_steps_sampled_lifetime": 2613314, "num_agent_steps_sampled_lifetime": 6852688, "num_steps_trained_this_iter": 36139, "agent_timesteps_total": 6852688, "timers": {"training_iteration_time_ms": 10022.109, "restore_workers_time_ms": 0.013, "training_step_time_ms": 0.624, "sample_time_ms": 0.538, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 2613314, "num_env_steps_trained": 4013668, "num_agent_steps_sampled": 6852688, "num_agent_steps_trained": 4013668, "num_training_step_calls_since_last_synch_worker_weights": 6239, "num_weight_broadcasts": 85, "num_samples_added_to_queue": 1616222, "num_times_learner_queue_full": 143}, "done": false, "training_iteration": 35, "trial_id": "567b5_00000", "date": "2024-09-01_21-38-28", "timestamp": 1725194308, "time_this_iter_s": 70.03117203712463, "time_total_s": 2453.495806455612, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2453.495806455612, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 98.76666666666668, "ram_util_percent": 75.26363636363638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 273584.03125, "policy_loss": 209775.9375, "entropy": 10.54128360748291, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 128479.703125, "vf_explained_var": -0.00021708011627197266}, "model": {}, "num_grad_updates_lifetime": 178.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 2665849, "num_env_steps_trained": 4200378, "num_agent_steps_sampled": 7001740, "num_agent_steps_trained": 4200378, "num_training_step_calls_since_last_synch_worker_weights": 860, "num_weight_broadcasts": 88, "num_samples_added_to_queue": 1655247, "num_times_learner_queue_full": 145, "learner_queue": {"size_count": 182, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 275.128, "learner_load_time_ms": 3182.697, "learner_load_wait_time_ms": 7281.466, "learner_dequeue_time_ms": 88471.622}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7001740, "num_agent_steps_trained": 4200378, "num_env_steps_sampled": 2665849, "num_env_steps_trained": 4200378, "num_env_steps_sampled_this_iter": 52535, "num_env_steps_trained_this_iter": 186710, "num_env_steps_sampled_throughput_per_sec": 5253.375751763683, "num_env_steps_trained_throughput_per_sec": 18670.558420325448, "timesteps_total": 2665849, "num_env_steps_sampled_lifetime": 2665849, "num_agent_steps_sampled_lifetime": 7001740, "num_steps_trained_this_iter": 186710, "agent_timesteps_total": 7001740, "timers": {"training_iteration_time_ms": 10022.13, "restore_workers_time_ms": 0.013, "training_step_time_ms": 0.603, "sample_time_ms": 0.512, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 2665849, "num_env_steps_trained": 4200378, "num_agent_steps_sampled": 7001740, "num_agent_steps_trained": 4200378, "num_training_step_calls_since_last_synch_worker_weights": 860, "num_weight_broadcasts": 88, "num_samples_added_to_queue": 1655247, "num_times_learner_queue_full": 145}, "done": false, "training_iteration": 36, "trial_id": "567b5_00000", "date": "2024-09-01_21-39-38", "timestamp": 1725194378, "time_this_iter_s": 70.04808044433594, "time_total_s": 2523.543886899948, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2523.543886899948, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 99.06099999999998, "ram_util_percent": 75.19500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 38683.90625, "policy_loss": 37398.03515625, "entropy": 11.409418106079102, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 3506.4013671875, "vf_explained_var": 0.0010207295417785645}, "model": {}, "num_grad_updates_lifetime": 183.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 2759175, "num_env_steps_trained": 4299395, "num_agent_steps_sampled": 7258852, "num_agent_steps_trained": 4299395, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 91, "num_samples_added_to_queue": 1719348, "num_times_learner_queue_full": 149, "learner_queue": {"size_count": 188, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "timing_breakdown": {"learner_grad_time_ms": 263.332, "learner_load_time_ms": 3182.697, "learner_load_wait_time_ms": 8071.442, "learner_dequeue_time_ms": 88471.622}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 59, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7258852, "num_agent_steps_trained": 4299395, "num_env_steps_sampled": 2759175, "num_env_steps_trained": 4299395, "num_env_steps_sampled_this_iter": 93326, "num_env_steps_trained_this_iter": 99017, "num_env_steps_sampled_throughput_per_sec": 9165.42828054333, "num_env_steps_trained_throughput_per_sec": 9724.33418398473, "timesteps_total": 2759175, "num_env_steps_sampled_lifetime": 2759175, "num_agent_steps_sampled_lifetime": 7258852, "num_steps_trained_this_iter": 99017, "agent_timesteps_total": 7258852, "timers": {"training_iteration_time_ms": 10039.705, "restore_workers_time_ms": 0.226, "training_step_time_ms": 24.495, "sample_time_ms": 3.223, "synch_weights_time_ms": 3.228}, "counters": {"num_env_steps_sampled": 2759175, "num_env_steps_trained": 4299395, "num_agent_steps_sampled": 7258852, "num_agent_steps_trained": 4299395, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 91, "num_samples_added_to_queue": 1719348, "num_times_learner_queue_full": 149}, "done": false, "training_iteration": 37, "trial_id": "567b5_00000", "date": "2024-09-01_21-40-48", "timestamp": 1725194448, "time_this_iter_s": 70.22054862976074, "time_total_s": 2593.764435529709, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2593.764435529709, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 98.87070707070706, "ram_util_percent": 75.66161616161617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -80345.328125, "policy_loss": -82562.3515625, "entropy": 16.94561767578125, "entropy_coeff": 0.01, "var_gnorm": 2047.2239990234375, "vf_loss": 5822.2314453125, "vf_explained_var": -0.0007524490356445312}, "model": {}, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 2806676, "num_env_steps_trained": 4501191, "num_agent_steps_sampled": 7365133, "num_agent_steps_trained": 4501191, "num_training_step_calls_since_last_synch_worker_weights": 5862, "num_weight_broadcasts": 93, "num_samples_added_to_queue": 1749558, "num_times_learner_queue_full": 151, "learner_queue": {"size_count": 192, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 261.519, "learner_load_time_ms": 3399.326, "learner_load_wait_time_ms": 13216.093, "learner_dequeue_time_ms": 95014.358}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7365133, "num_agent_steps_trained": 4501191, "num_env_steps_sampled": 2806676, "num_env_steps_trained": 4501191, "num_env_steps_sampled_this_iter": 47501, "num_env_steps_trained_this_iter": 201796, "num_env_steps_sampled_throughput_per_sec": 4749.6718357751115, "num_env_steps_trained_throughput_per_sec": 20177.78105244257, "timesteps_total": 2806676, "num_env_steps_sampled_lifetime": 2806676, "num_agent_steps_sampled_lifetime": 7365133, "num_steps_trained_this_iter": 201796, "agent_timesteps_total": 7365133, "timers": {"training_iteration_time_ms": 10018.517, "restore_workers_time_ms": 0.011, "training_step_time_ms": 0.463, "sample_time_ms": 0.376, "synch_weights_time_ms": 0.018}, "counters": {"num_env_steps_sampled": 2806676, "num_env_steps_trained": 4501191, "num_agent_steps_sampled": 7365133, "num_agent_steps_trained": 4501191, "num_training_step_calls_since_last_synch_worker_weights": 5862, "num_weight_broadcasts": 93, "num_samples_added_to_queue": 1749558, "num_times_learner_queue_full": 151}, "done": false, "training_iteration": 38, "trial_id": "567b5_00000", "date": "2024-09-01_21-41-58", "timestamp": 1725194518, "time_this_iter_s": 70.22717189788818, "time_total_s": 2663.991607427597, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2663.991607427597, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 98.68282828282825, "ram_util_percent": 75.4919191919192}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -24733.98828125, "policy_loss": -25351.84765625, "entropy": 13.186721801757812, "entropy_coeff": 0.01, "var_gnorm": 2047.2239990234375, "vf_loss": 2315.975341796875, "vf_explained_var": 0.005027651786804199}, "model": {}, "num_grad_updates_lifetime": 195.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 2849117, "num_env_steps_trained": 4569116, "num_agent_steps_sampled": 7480120, "num_agent_steps_trained": 4569116, "num_training_step_calls_since_last_synch_worker_weights": 13882, "num_weight_broadcasts": 94, "num_samples_added_to_queue": 1776327, "num_times_learner_queue_full": 153, "learner_queue": {"size_count": 196, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 268.771, "learner_load_time_ms": 3399.326, "learner_load_wait_time_ms": 13252.504, "learner_dequeue_time_ms": 95014.358}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7480120, "num_agent_steps_trained": 4569116, "num_env_steps_sampled": 2849117, "num_env_steps_trained": 4569116, "num_env_steps_sampled_this_iter": 42441, "num_env_steps_trained_this_iter": 67925, "num_env_steps_sampled_throughput_per_sec": 4244.035645898085, "num_env_steps_trained_throughput_per_sec": 6792.397004020344, "timesteps_total": 2849117, "num_env_steps_sampled_lifetime": 2849117, "num_agent_steps_sampled_lifetime": 7480120, "num_steps_trained_this_iter": 67925, "agent_timesteps_total": 7480120, "timers": {"training_iteration_time_ms": 10018.512, "restore_workers_time_ms": 0.011, "training_step_time_ms": 0.445, "sample_time_ms": 0.333, "synch_weights_time_ms": 0.017}, "counters": {"num_env_steps_sampled": 2849117, "num_env_steps_trained": 4569116, "num_agent_steps_sampled": 7480120, "num_agent_steps_trained": 4569116, "num_training_step_calls_since_last_synch_worker_weights": 13882, "num_weight_broadcasts": 94, "num_samples_added_to_queue": 1776327, "num_times_learner_queue_full": 153}, "done": false, "training_iteration": 39, "trial_id": "567b5_00000", "date": "2024-09-01_21-43-08", "timestamp": 1725194588, "time_this_iter_s": 70.03884148597717, "time_total_s": 2734.030448913574, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2734.030448913574, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 98.86100000000002, "ram_util_percent": 75.49000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -31742.9453125, "policy_loss": -33460.796875, "entropy": 15.51286506652832, "entropy_coeff": 0.01, "var_gnorm": 2047.2239990234375, "vf_loss": 4612.5087890625, "vf_explained_var": 0.061406493186950684}, "model": {}, "num_grad_updates_lifetime": 196.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 2962765, "num_env_steps_trained": 4585285, "num_agent_steps_sampled": 7763641, "num_agent_steps_trained": 4585285, "num_training_step_calls_since_last_synch_worker_weights": 6377, "num_weight_broadcasts": 99, "num_samples_added_to_queue": 1863353, "num_times_learner_queue_full": 158, "learner_queue": {"size_count": 203, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 205.613, "learner_load_time_ms": 3274.737, "learner_load_wait_time_ms": 8874.675, "learner_dequeue_time_ms": 95970.454}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7763641, "num_agent_steps_trained": 4585285, "num_env_steps_sampled": 2962765, "num_env_steps_trained": 4585285, "num_env_steps_sampled_this_iter": 113648, "num_env_steps_trained_this_iter": 16169, "num_env_steps_sampled_throughput_per_sec": 11360.415424993043, "num_env_steps_trained_throughput_per_sec": 1616.2761949767046, "timesteps_total": 2962765, "num_env_steps_sampled_lifetime": 2962765, "num_agent_steps_sampled_lifetime": 7763641, "num_steps_trained_this_iter": 16169, "agent_timesteps_total": 7763641, "timers": {"training_iteration_time_ms": 10018.857, "restore_workers_time_ms": 0.022, "training_step_time_ms": 32.404, "sample_time_ms": 32.235, "synch_weights_time_ms": 0.047}, "counters": {"num_env_steps_sampled": 2962765, "num_env_steps_trained": 4585285, "num_agent_steps_sampled": 7763641, "num_agent_steps_trained": 4585285, "num_training_step_calls_since_last_synch_worker_weights": 6377, "num_weight_broadcasts": 99, "num_samples_added_to_queue": 1863353, "num_times_learner_queue_full": 158}, "done": false, "training_iteration": 40, "trial_id": "567b5_00000", "date": "2024-09-01_21-44-19", "timestamp": 1725194659, "time_this_iter_s": 70.31037282943726, "time_total_s": 2804.3408217430115, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2804.3408217430115, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 86.8020202020202, "ram_util_percent": 68.80303030303028}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 36701.578125, "policy_loss": 33989.28515625, "entropy": 10.195510864257812, "entropy_coeff": 0.01, "var_gnorm": 2047.22412109375, "vf_loss": 6259.8037109375, "vf_explained_var": -0.000789642333984375}, "model": {}, "num_grad_updates_lifetime": 205.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}}, "num_env_steps_sampled": 3010224, "num_env_steps_trained": 4862494, "num_agent_steps_sampled": 7887236, "num_agent_steps_trained": 4862494, "num_training_step_calls_since_last_synch_worker_weights": 13117, "num_weight_broadcasts": 102, "num_samples_added_to_queue": 1905534, "num_times_learner_queue_full": 159, "learner_queue": {"size_count": 209, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 257.942, "learner_load_time_ms": 2512.628, "learner_load_wait_time_ms": 6734.898, "learner_dequeue_time_ms": 88424.05}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7887236, "num_agent_steps_trained": 4862494, "num_env_steps_sampled": 3010224, "num_env_steps_trained": 4862494, "num_env_steps_sampled_this_iter": 47459, "num_env_steps_trained_this_iter": 277209, "num_env_steps_sampled_throughput_per_sec": 4745.852929620296, "num_env_steps_trained_throughput_per_sec": 27720.625060939183, "timesteps_total": 3010224, "num_env_steps_sampled_lifetime": 3010224, "num_agent_steps_sampled_lifetime": 7887236, "num_steps_trained_this_iter": 277209, "agent_timesteps_total": 7887236, "timers": {"training_iteration_time_ms": 10018.853, "restore_workers_time_ms": 0.011, "training_step_time_ms": 0.445, "sample_time_ms": 0.368, "synch_weights_time_ms": 0.018}, "counters": {"num_env_steps_sampled": 3010224, "num_env_steps_trained": 4862494, "num_agent_steps_sampled": 7887236, "num_agent_steps_trained": 4862494, "num_training_step_calls_since_last_synch_worker_weights": 13117, "num_weight_broadcasts": 102, "num_samples_added_to_queue": 1905534, "num_times_learner_queue_full": 159}, "done": false, "training_iteration": 41, "trial_id": "567b5_00000", "date": "2024-09-01_21-45-29", "timestamp": 1725194729, "time_this_iter_s": 70.18262124061584, "time_total_s": 2874.5234429836273, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2874.5234429836273, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 86.67979797979797, "ram_util_percent": 68.81313131313131}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -21808.48828125, "policy_loss": -24510.771484375, "entropy": 10.362709045410156, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 6253.48046875, "vf_explained_var": -0.001025080680847168}, "model": {}, "num_grad_updates_lifetime": 210.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 3071165, "num_env_steps_trained": 4941884, "num_agent_steps_sampled": 8046750, "num_agent_steps_trained": 4941884, "num_training_step_calls_since_last_synch_worker_weights": 9472, "num_weight_broadcasts": 105, "num_samples_added_to_queue": 1952880, "num_times_learner_queue_full": 161, "learner_queue": {"size_count": 215, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 225.02, "learner_load_time_ms": 2512.628, "learner_load_wait_time_ms": 7443.565, "learner_dequeue_time_ms": 88424.05}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8046750, "num_agent_steps_trained": 4941884, "num_env_steps_sampled": 3071165, "num_env_steps_trained": 4941884, "num_env_steps_sampled_this_iter": 60941, "num_env_steps_trained_this_iter": 79390, "num_env_steps_sampled_throughput_per_sec": 6094.067890047939, "num_env_steps_trained_throughput_per_sec": 7938.95816922771, "timesteps_total": 3071165, "num_env_steps_sampled_lifetime": 3071165, "num_agent_steps_sampled_lifetime": 8046750, "num_steps_trained_this_iter": 79390, "agent_timesteps_total": 8046750, "timers": {"training_iteration_time_ms": 10018.848, "restore_workers_time_ms": 0.009, "training_step_time_ms": 0.273, "sample_time_ms": 0.156, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 3071165, "num_env_steps_trained": 4941884, "num_agent_steps_sampled": 8046750, "num_agent_steps_trained": 4941884, "num_training_step_calls_since_last_synch_worker_weights": 9472, "num_weight_broadcasts": 105, "num_samples_added_to_queue": 1952880, "num_times_learner_queue_full": 161}, "done": false, "training_iteration": 42, "trial_id": "567b5_00000", "date": "2024-09-01_21-46-39", "timestamp": 1725194799, "time_this_iter_s": 70.02827191352844, "time_total_s": 2944.5517148971558, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2944.5517148971558, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 87.48699999999997, "ram_util_percent": 68.91199999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 76632.140625, "policy_loss": 70981.890625, "entropy": 10.739160537719727, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 12180.2431640625, "vf_explained_var": -0.0005282163619995117}, "model": {}, "num_grad_updates_lifetime": 216.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 3187043, "num_env_steps_trained": 5100233, "num_agent_steps_sampled": 8327802, "num_agent_steps_trained": 5100233, "num_training_step_calls_since_last_synch_worker_weights": 10690, "num_weight_broadcasts": 107, "num_samples_added_to_queue": 2007900, "num_times_learner_queue_full": 170, "learner_queue": {"size_count": 220, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 217.067, "learner_load_time_ms": 1633.719, "learner_load_wait_time_ms": 8019.628, "learner_dequeue_time_ms": 88091.192}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8327802, "num_agent_steps_trained": 5100233, "num_env_steps_sampled": 3187043, "num_env_steps_trained": 5100233, "num_env_steps_sampled_this_iter": 115878, "num_env_steps_trained_this_iter": 158349, "num_env_steps_sampled_throughput_per_sec": 11587.635618896646, "num_env_steps_trained_throughput_per_sec": 15834.675370792254, "timesteps_total": 3187043, "num_env_steps_sampled_lifetime": 3187043, "num_agent_steps_sampled_lifetime": 8327802, "num_steps_trained_this_iter": 158349, "agent_timesteps_total": 8327802, "timers": {"training_iteration_time_ms": 10018.841, "restore_workers_time_ms": 0.009, "training_step_time_ms": 0.244, "sample_time_ms": 0.18, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 3187043, "num_env_steps_trained": 5100233, "num_agent_steps_sampled": 8327802, "num_agent_steps_trained": 5100233, "num_training_step_calls_since_last_synch_worker_weights": 10690, "num_weight_broadcasts": 107, "num_samples_added_to_queue": 2007900, "num_times_learner_queue_full": 170}, "done": false, "training_iteration": 43, "trial_id": "567b5_00000", "date": "2024-09-01_21-47-49", "timestamp": 1725194869, "time_this_iter_s": 70.02862501144409, "time_total_s": 3014.5803399086, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3014.5803399086, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 85.30404040404042, "ram_util_percent": 68.77373737373739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -32059.78125, "policy_loss": -32634.009765625, "entropy": 11.103866577148438, "entropy_coeff": 0.01, "var_gnorm": 2047.224365234375, "vf_loss": 2058.0869140625, "vf_explained_var": 0.0004184842109680176}, "model": {}, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 3213518, "num_env_steps_trained": 5205031, "num_agent_steps_sampled": 8405652, "num_agent_steps_trained": 5205031, "num_training_step_calls_since_last_synch_worker_weights": 23073, "num_weight_broadcasts": 108, "num_samples_added_to_queue": 2034375, "num_times_learner_queue_full": 170, "learner_queue": {"size_count": 223, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 204.205, "learner_load_time_ms": 1633.719, "learner_load_wait_time_ms": 13731.486, "learner_dequeue_time_ms": 88091.192}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8405652, "num_agent_steps_trained": 5205031, "num_env_steps_sampled": 3213518, "num_env_steps_trained": 5205031, "num_env_steps_sampled_this_iter": 26475, "num_env_steps_trained_this_iter": 104798, "num_env_steps_sampled_throughput_per_sec": 2647.481253101059, "num_env_steps_trained_throughput_per_sec": 10479.725792728414, "timesteps_total": 3213518, "num_env_steps_sampled_lifetime": 3213518, "num_agent_steps_sampled_lifetime": 8405652, "num_steps_trained_this_iter": 104798, "agent_timesteps_total": 8405652, "timers": {"training_iteration_time_ms": 10018.835, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.227, "sample_time_ms": 0.16, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 3213518, "num_env_steps_trained": 5205031, "num_agent_steps_sampled": 8405652, "num_agent_steps_trained": 5205031, "num_training_step_calls_since_last_synch_worker_weights": 23073, "num_weight_broadcasts": 108, "num_samples_added_to_queue": 2034375, "num_times_learner_queue_full": 170}, "done": false, "training_iteration": 44, "trial_id": "567b5_00000", "date": "2024-09-01_21-48-59", "timestamp": 1725194939, "time_this_iter_s": 70.08488750457764, "time_total_s": 3084.6652274131775, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3084.6652274131775, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 87.76800000000001, "ram_util_percent": 69.527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 61.9706916809082, "policy_loss": 668.0008544921875, "entropy": 14.811517715454102, "entropy_coeff": 0.01, "var_gnorm": 2047.2244873046875, "vf_loss": 1.2991740703582764, "vf_explained_var": 0.1742364764213562}, "model": {}, "num_grad_updates_lifetime": 224.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 3352934, "num_env_steps_trained": 5301826, "num_agent_steps_sampled": 8762480, "num_agent_steps_trained": 5301826, "num_training_step_calls_since_last_synch_worker_weights": 21676, "num_weight_broadcasts": 110, "num_samples_added_to_queue": 2104041, "num_times_learner_queue_full": 179, "learner_queue": {"size_count": 228, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 214.531, "learner_load_time_ms": 1638.359, "learner_load_wait_time_ms": 14331.57, "learner_dequeue_time_ms": 94883.132}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8762480, "num_agent_steps_trained": 5301826, "num_env_steps_sampled": 3352934, "num_env_steps_trained": 5301826, "num_env_steps_sampled_this_iter": 139416, "num_env_steps_trained_this_iter": 96795, "num_env_steps_sampled_throughput_per_sec": 13941.28655983863, "num_env_steps_trained_throughput_per_sec": 9679.282381933066, "timesteps_total": 3352934, "num_env_steps_sampled_lifetime": 3352934, "num_agent_steps_sampled_lifetime": 8762480, "num_steps_trained_this_iter": 96795, "agent_timesteps_total": 8762480, "timers": {"training_iteration_time_ms": 10018.834, "restore_workers_time_ms": 0.012, "training_step_time_ms": 0.402, "sample_time_ms": 0.318, "synch_weights_time_ms": 0.023}, "counters": {"num_env_steps_sampled": 3352934, "num_env_steps_trained": 5301826, "num_agent_steps_sampled": 8762480, "num_agent_steps_trained": 5301826, "num_training_step_calls_since_last_synch_worker_weights": 21676, "num_weight_broadcasts": 110, "num_samples_added_to_queue": 2104041, "num_times_learner_queue_full": 179}, "done": false, "training_iteration": 45, "trial_id": "567b5_00000", "date": "2024-09-01_21-50-09", "timestamp": 1725195009, "time_this_iter_s": 70.04132270812988, "time_total_s": 3154.7065501213074, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3154.7065501213074, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 85.53939393939393, "ram_util_percent": 69.97474747474749}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 11909.0, "policy_loss": 12489.88671875, "entropy": 17.84625816345215, "entropy_coeff": 0.01, "var_gnorm": 2047.224609375, "vf_loss": 300.1920471191406, "vf_explained_var": 0.007496893405914307}, "model": {}, "num_grad_updates_lifetime": 229.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 3421762, "num_env_steps_trained": 5464299, "num_agent_steps_sampled": 8913074, "num_agent_steps_trained": 5464299, "num_training_step_calls_since_last_synch_worker_weights": 19965, "num_weight_broadcasts": 111, "num_samples_added_to_queue": 2163435, "num_times_learner_queue_full": 180, "learner_queue": {"size_count": 232, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 283.943, "learner_load_time_ms": 1638.359, "learner_load_wait_time_ms": 14331.671, "learner_dequeue_time_ms": 94883.132}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8913074, "num_agent_steps_trained": 5464299, "num_env_steps_sampled": 3421762, "num_env_steps_trained": 5464299, "num_env_steps_sampled_this_iter": 68828, "num_env_steps_trained_this_iter": 162473, "num_env_steps_sampled_throughput_per_sec": 6882.779487718678, "num_env_steps_trained_throughput_per_sec": 16247.251579417052, "timesteps_total": 3421762, "num_env_steps_sampled_lifetime": 3421762, "num_agent_steps_sampled_lifetime": 8913074, "num_steps_trained_this_iter": 162473, "agent_timesteps_total": 8913074, "timers": {"training_iteration_time_ms": 10018.813, "restore_workers_time_ms": 0.009, "training_step_time_ms": 0.311, "sample_time_ms": 0.25, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 3421762, "num_env_steps_trained": 5464299, "num_agent_steps_sampled": 8913074, "num_agent_steps_trained": 5464299, "num_training_step_calls_since_last_synch_worker_weights": 19965, "num_weight_broadcasts": 111, "num_samples_added_to_queue": 2163435, "num_times_learner_queue_full": 180}, "done": false, "training_iteration": 46, "trial_id": "567b5_00000", "date": "2024-09-01_21-51-20", "timestamp": 1725195080, "time_this_iter_s": 70.39028477668762, "time_total_s": 3225.096834897995, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3225.096834897995, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 89.005, "ram_util_percent": 71.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -30043.921875, "policy_loss": -31426.15234375, "entropy": 16.334115982055664, "entropy_coeff": 0.01, "var_gnorm": 2047.224609375, "vf_loss": 4078.380615234375, "vf_explained_var": 0.08988958597183228}, "model": {}, "num_grad_updates_lifetime": 232.0, "diff_num_grad_updates_vs_sampler_policy": 21.263770947621566}}, "num_env_steps_sampled": 3516700, "num_env_steps_trained": 5534866, "num_agent_steps_sampled": 9170242, "num_agent_steps_trained": 5534866, "num_training_step_calls_since_last_synch_worker_weights": 3967, "num_weight_broadcasts": 114, "num_samples_added_to_queue": 2223498, "num_times_learner_queue_full": 184, "learner_queue": {"size_count": 238, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 266.503, "learner_load_time_ms": 1770.652, "learner_load_wait_time_ms": 14171.278, "learner_dequeue_time_ms": 107881.862}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9170242, "num_agent_steps_trained": 5534866, "num_env_steps_sampled": 3516700, "num_env_steps_trained": 5534866, "num_env_steps_sampled_this_iter": 94938, "num_env_steps_trained_this_iter": 70567, "num_env_steps_sampled_throughput_per_sec": 9493.4887791855, "num_env_steps_trained_throughput_per_sec": 7056.468670930325, "timesteps_total": 3516700, "num_env_steps_sampled_lifetime": 3516700, "num_agent_steps_sampled_lifetime": 9170242, "num_steps_trained_this_iter": 70567, "agent_timesteps_total": 9170242, "timers": {"training_iteration_time_ms": 10000.607, "restore_workers_time_ms": 0.011, "training_step_time_ms": 0.592, "sample_time_ms": 0.514, "synch_weights_time_ms": 0.018}, "counters": {"num_env_steps_sampled": 3516700, "num_env_steps_trained": 5534866, "num_agent_steps_sampled": 9170242, "num_agent_steps_trained": 5534866, "num_training_step_calls_since_last_synch_worker_weights": 3967, "num_weight_broadcasts": 114, "num_samples_added_to_queue": 2223498, "num_times_learner_queue_full": 184}, "done": false, "training_iteration": 47, "trial_id": "567b5_00000", "date": "2024-09-01_21-52-30", "timestamp": 1725195150, "time_this_iter_s": 70.71808362007141, "time_total_s": 3295.8149185180664, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3295.8149185180664, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 96.918, "ram_util_percent": 80.68400000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -775.8470458984375, "policy_loss": -368.0958557128906, "entropy": 14.186786651611328, "entropy_coeff": 0.01, "var_gnorm": 2047.2249755859375, "vf_loss": 247.93923950195312, "vf_explained_var": 0.6376221776008606}, "model": {}, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 3621457, "num_env_steps_trained": 5729274, "num_agent_steps_sampled": 9440681, "num_agent_steps_trained": 5729274, "num_training_step_calls_since_last_synch_worker_weights": 1606, "num_weight_broadcasts": 117, "num_samples_added_to_queue": 2291564, "num_times_learner_queue_full": 188, "learner_queue": {"size_count": 244, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 247.898, "learner_load_time_ms": 1755.141, "learner_load_wait_time_ms": 7939.723, "learner_dequeue_time_ms": 102429.279}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9440681, "num_agent_steps_trained": 5729274, "num_env_steps_sampled": 3621457, "num_env_steps_trained": 5729274, "num_env_steps_sampled_this_iter": 104757, "num_env_steps_trained_this_iter": 194408, "num_env_steps_sampled_throughput_per_sec": 10475.588358402343, "num_env_steps_trained_throughput_per_sec": 19440.592815566335, "timesteps_total": 3621457, "num_env_steps_sampled_lifetime": 3621457, "num_agent_steps_sampled_lifetime": 9440681, "num_steps_trained_this_iter": 194408, "agent_timesteps_total": 9440681, "timers": {"training_iteration_time_ms": 10000.528, "restore_workers_time_ms": 0.012, "training_step_time_ms": 0.742, "sample_time_ms": 0.655, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 3621457, "num_env_steps_trained": 5729274, "num_agent_steps_sampled": 9440681, "num_agent_steps_trained": 5729274, "num_training_step_calls_since_last_synch_worker_weights": 1606, "num_weight_broadcasts": 117, "num_samples_added_to_queue": 2291564, "num_times_learner_queue_full": 188}, "done": false, "training_iteration": 48, "trial_id": "567b5_00000", "date": "2024-09-01_21-53-41", "timestamp": 1725195221, "time_this_iter_s": 70.3127007484436, "time_total_s": 3366.12761926651, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3366.12761926651, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 98.9141414141414, "ram_util_percent": 84.83939393939393}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 2320.937255859375, "policy_loss": 2843.23681640625, "entropy": 17.040197372436523, "entropy_coeff": 0.01, "var_gnorm": 2047.224853515625, "vf_loss": 351.3338623046875, "vf_explained_var": -0.010881900787353516}, "model": {}, "num_grad_updates_lifetime": 246.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 3678817, "num_env_steps_trained": 5922847, "num_agent_steps_sampled": 9581054, "num_agent_steps_trained": 5922847, "num_training_step_calls_since_last_synch_worker_weights": 4572, "num_weight_broadcasts": 120, "num_samples_added_to_queue": 2337790, "num_times_learner_queue_full": 190, "learner_queue": {"size_count": 249, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 274.12, "learner_load_time_ms": 1755.141, "learner_load_wait_time_ms": 7474.536, "learner_dequeue_time_ms": 102429.279}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9581054, "num_agent_steps_trained": 5922847, "num_env_steps_sampled": 3678817, "num_env_steps_trained": 5922847, "num_env_steps_sampled_this_iter": 57360, "num_env_steps_trained_this_iter": 193573, "num_env_steps_sampled_throughput_per_sec": 5735.657717912962, "num_env_steps_trained_throughput_per_sec": 19356.144899399682, "timesteps_total": 3678817, "num_env_steps_sampled_lifetime": 3678817, "num_agent_steps_sampled_lifetime": 9581054, "num_steps_trained_this_iter": 193573, "agent_timesteps_total": 9581054, "timers": {"training_iteration_time_ms": 10000.572, "restore_workers_time_ms": 0.011, "training_step_time_ms": 0.46, "sample_time_ms": 0.38, "synch_weights_time_ms": 0.018}, "counters": {"num_env_steps_sampled": 3678817, "num_env_steps_trained": 5922847, "num_agent_steps_sampled": 9581054, "num_agent_steps_trained": 5922847, "num_training_step_calls_since_last_synch_worker_weights": 4572, "num_weight_broadcasts": 120, "num_samples_added_to_queue": 2337790, "num_times_learner_queue_full": 190}, "done": false, "training_iteration": 49, "trial_id": "567b5_00000", "date": "2024-09-01_21-54-51", "timestamp": 1725195291, "time_this_iter_s": 70.03210115432739, "time_total_s": 3436.1597204208374, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3436.1597204208374, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 93.20000000000002, "ram_util_percent": 79.45151515151514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -4967.61181640625, "policy_loss": -4445.00244140625, "entropy": 13.7524995803833, "entropy_coeff": 0.01, "var_gnorm": 2047.224853515625, "vf_loss": 81.3854751586914, "vf_explained_var": 0.005126237869262695}, "model": {}, "num_grad_updates_lifetime": 250.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}}, "num_env_steps_sampled": 3740442, "num_env_steps_trained": 6018915, "num_agent_steps_sampled": 9728489, "num_agent_steps_trained": 6018915, "num_training_step_calls_since_last_synch_worker_weights": 4043, "num_weight_broadcasts": 123, "num_samples_added_to_queue": 2392753, "num_times_learner_queue_full": 191, "learner_queue": {"size_count": 255, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 240.917, "learner_load_time_ms": 1810.49, "learner_load_wait_time_ms": 8095.147, "learner_dequeue_time_ms": 107678.643}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 30, "num_in_flight_async_sample_reqs": 60, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9728489, "num_agent_steps_trained": 6018915, "num_env_steps_sampled": 3740442, "num_env_steps_trained": 6018915, "num_env_steps_sampled_this_iter": 61625, "num_env_steps_trained_this_iter": 96068, "num_env_steps_sampled_throughput_per_sec": 6162.398770028292, "num_env_steps_trained_throughput_per_sec": 9606.642191303496, "timesteps_total": 3740442, "num_env_steps_sampled_lifetime": 3740442, "num_agent_steps_sampled_lifetime": 9728489, "num_steps_trained_this_iter": 96068, "agent_timesteps_total": 9728489, "timers": {"training_iteration_time_ms": 10000.202, "restore_workers_time_ms": 0.01, "training_step_time_ms": 0.322, "sample_time_ms": 0.256, "synch_weights_time_ms": 0.015}, "counters": {"num_env_steps_sampled": 3740442, "num_env_steps_trained": 6018915, "num_agent_steps_sampled": 9728489, "num_agent_steps_trained": 6018915, "num_training_step_calls_since_last_synch_worker_weights": 4043, "num_weight_broadcasts": 123, "num_samples_added_to_queue": 2392753, "num_times_learner_queue_full": 191}, "done": false, "training_iteration": 50, "trial_id": "567b5_00000", "date": "2024-09-01_21-56-01", "timestamp": 1725195361, "time_this_iter_s": 70.04516625404358, "time_total_s": 3506.204886674881, "pid": 2424762, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 30, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 512, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d1ad796ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3506.204886674881, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 88.426, "ram_util_percent": 69.86899999999997}}
