{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 82094, "learner_queue": {"size_count": 0, "size_mean": NaN, "size_std": NaN, "size_quantiles": 1.0}, "timing_breakdown": {"learner_grad_time_ms": 0.0, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 0.0, "learner_dequeue_time_ms": 0.0}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 0, "num_env_steps_sampled_lifetime": 0, "num_agent_steps_sampled_lifetime": 0, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 0, "timers": {"training_iteration_time_ms": 10000.065, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.125, "sample_time_ms": 0.106, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 82094}, "done": false, "training_iteration": 1, "trial_id": "6466c_00000", "date": "2024-09-02_13-48-19", "timestamp": 1725252499, "time_this_iter_s": 70.00923776626587, "time_total_s": 70.00923776626587, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.00923776626587, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.364000000000004, "ram_util_percent": 39.352999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -1.3521426916122437, "policy_loss": 28.6615047454834, "entropy": 11.759857177734375, "entropy_coeff": 0.01, "var_gnorm": 2048.274658203125, "vf_loss": 0.18317344784736633, "vf_explained_var": 0.10881882905960083}, "model": {}, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 14336, "num_training_step_calls_since_last_synch_worker_weights": 20825, "num_samples_added_to_queue": 5120, "num_times_learner_queue_full": 35, "num_weight_broadcasts": 7, "learner_queue": {"size_count": 10, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.753, "learner_load_time_ms": 125.631, "learner_load_wait_time_ms": 7570.294, "learner_dequeue_time_ms": 37266.272}}, "env_runners": {"episode_reward_max": 1.723066134218243e-13, "episode_reward_min": 0.0, "episode_reward_mean": 3.437421287781735e-14, "episode_len_mean": 1140.7692307692307, "episode_media": {}, "episodes_timesteps_total": 14830, "policy_reward_min": {"default_policy": -1422.0}, "policy_reward_max": {"default_policy": 1422.0}, "policy_reward_mean": {"default_policy": -1.0335167065601458e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 1.3100631690576847e-13, 1.1102230246251565e-16, 1.723066134218243e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.432187701766452e-13, 2.220446049250313e-16], "episode_lengths": [1026, 1027, 1026, 1026, 1026, 1026, 2005, 1027, 1026, 1026, 1537, 1026, 1026], "policy_default_policy_reward": [0.0, 0.0, 304.0, -304.0, 678.1154031579039, -104.65180361560927, -573.4635995422934, -359.7276934780741, -255.72769347806906, 1289.261626873353, -673.8062399172434, 253.14422766478543, -712.0565286548579, 458.91230099007186, 641.0, -641.0, -1422.0, 1422.0, 218.0, -218.0, 476.0, -476.0, -491.0, 491.0, -853.0, 853.0, 184.55486988968912, -180.31222920257045, -4.242640687119216, -847.0614872174385, 722.3538290724795, 722.3538290724795, -597.6461709275205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.213246868130822, "mean_inference_ms": 3.6772789528909007, "mean_action_processing_ms": 0.6899156741213055, "mean_env_wait_ms": 30.98926732332207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01478745387150691, "StateBufferConnector_ms": 0.01088105715238131, "ViewRequirementAgentConnector_ms": 0.4431357750525841}, "num_episodes": 13, "episode_return_max": 1.723066134218243e-13, "episode_return_min": 0.0, "episode_return_mean": 3.437421287781735e-14, "episodes_this_iter": 13}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 23040, "num_env_steps_trained": 14336, "num_env_steps_sampled_this_iter": 23040, "num_env_steps_trained_this_iter": 14336, "num_env_steps_sampled_throughput_per_sec": 2303.979290957625, "num_env_steps_trained_throughput_per_sec": 1433.5871143736333, "timesteps_total": 23040, "num_env_steps_sampled_lifetime": 23040, "num_agent_steps_sampled_lifetime": 62464, "num_steps_trained_this_iter": 14336, "agent_timesteps_total": 62464, "timers": {"training_iteration_time_ms": 10000.082, "restore_workers_time_ms": 0.008, "training_step_time_ms": 0.18, "sample_time_ms": 0.123, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 14336, "num_training_step_calls_since_last_synch_worker_weights": 20825, "num_samples_added_to_queue": 5120, "num_times_learner_queue_full": 35, "num_weight_broadcasts": 7}, "done": false, "training_iteration": 2, "trial_id": "6466c_00000", "date": "2024-09-02_13-49-29", "timestamp": 1725252569, "time_this_iter_s": 70.01955652236938, "time_total_s": 140.02879428863525, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 140.02879428863525, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.09, "ram_util_percent": 43.091000000000015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -1010.5321044921875, "policy_loss": -988.4024658203125, "entropy": 13.985725402832031, "entropy_coeff": 0.01, "var_gnorm": 2048.274658203125, "vf_loss": 27.34764862060547, "vf_explained_var": -0.01087486743927002}, "model": {}, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 47616, "num_env_steps_trained": 26034, "num_agent_steps_sampled": 133585, "num_agent_steps_trained": 26034, "num_training_step_calls_since_last_synch_worker_weights": 19249, "num_samples_added_to_queue": 8704, "num_times_learner_queue_full": 76, "num_weight_broadcasts": 11, "learner_queue": {"size_count": 17, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.708, "learner_load_time_ms": 113.441, "learner_load_wait_time_ms": 7349.975, "learner_dequeue_time_ms": 48823.953}}, "env_runners": {"episode_reward_max": 3.33510996597397e-13, "episode_reward_min": 0.0, "episode_reward_mean": 6.875269584419094e-14, "episode_len_mean": 1202.7307692307693, "episode_media": {}, "episodes_timesteps_total": 31271, "policy_reward_min": {"default_policy": -1899.0}, "policy_reward_max": {"default_policy": 1899.0}, "policy_reward_mean": {"default_policy": 1.169821083802136e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 1.3100631690576847e-13, 1.1102230246251565e-16, 1.723066134218243e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.432187701766452e-13, 2.220446049250313e-16, 2.036149027162537e-13, 3.352873534367973e-14, 0.0, 2.220446049250313e-16, 1.4876988529977098e-13, 0.0, 2.751132655021138e-13, 0.0, 0.0, 0.0, 2.569056078982612e-13, 8.903988657493755e-14, 3.33510996597397e-13], "episode_lengths": [1026, 1027, 1026, 1026, 1026, 1026, 2005, 1027, 1026, 1026, 1537, 1026, 1026, 1023, 1024, 2050, 1024, 1024, 45, 1538, 2050, 1538, 1024, 1538, 513, 2050], "policy_default_policy_reward": [0.0, 0.0, 304.0, -304.0, 678.1154031579039, -104.65180361560927, -573.4635995422934, -359.7276934780741, -255.72769347806906, 1289.261626873353, -673.8062399172434, 253.14422766478543, -712.0565286548579, 458.91230099007186, 641.0, -641.0, -1422.0, 1422.0, 218.0, -218.0, 476.0, -476.0, -491.0, 491.0, -853.0, 853.0, 184.55486988968912, -180.31222920257045, -4.242640687119216, -847.0614872174385, 722.3538290724795, 722.3538290724795, -597.6461709275205, 405.17218561989387, 324.5620125646261, -729.7341981845217, 106.77312395916894, 106.77312395916894, -213.54624791833785, 1899.0, -1899.0, -738.5559337179743, 594.2183664205663, -523.7816335794337, 668.119200876838, 649.1240251292546, -4.242640687119268, -644.8813844421359, 0.0, 0.0, 0.0, 1071.2667734976521, -150.6137443927355, -920.6530291048914, 600.0, -600.0, -1116.0, 1116.0, -235.0, 235.0, -1428.3556979968134, 423.34375849514817, 1005.0119395016877, 283.5498192558072, -567.0996385116144, 283.5498192558072, -1670.1862171625644, 1516.0369388639695, 154.14927829866792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.446147154933339, "mean_inference_ms": 3.6584087431691845, "mean_action_processing_ms": 0.6796944391500609, "mean_env_wait_ms": 31.28416067798543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015903436220609225, "StateBufferConnector_ms": 0.011308376605694111, "ViewRequirementAgentConnector_ms": 0.45633407739492565}, "num_episodes": 13, "episode_return_max": 3.33510996597397e-13, "episode_return_min": 0.0, "episode_return_mean": 6.875269584419094e-14, "episodes_this_iter": 13}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133585, "num_agent_steps_trained": 26034, "num_env_steps_sampled": 47616, "num_env_steps_trained": 26034, "num_env_steps_sampled_this_iter": 24576, "num_env_steps_trained_this_iter": 11698, "num_env_steps_sampled_throughput_per_sec": 2457.567070753723, "num_env_steps_trained_throughput_per_sec": 1169.7843259145936, "timesteps_total": 47616, "num_env_steps_sampled_lifetime": 47616, "num_agent_steps_sampled_lifetime": 133585, "num_steps_trained_this_iter": 11698, "agent_timesteps_total": 133585, "timers": {"training_iteration_time_ms": 10000.103, "restore_workers_time_ms": 0.008, "training_step_time_ms": 0.185, "sample_time_ms": 0.128, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 47616, "num_env_steps_trained": 26034, "num_agent_steps_sampled": 133585, "num_agent_steps_trained": 26034, "num_training_step_calls_since_last_synch_worker_weights": 19249, "num_samples_added_to_queue": 8704, "num_times_learner_queue_full": 76, "num_weight_broadcasts": 11}, "done": false, "training_iteration": 3, "trial_id": "6466c_00000", "date": "2024-09-02_13-50-39", "timestamp": 1725252639, "time_this_iter_s": 70.00946116447449, "time_total_s": 210.03825545310974, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 210.03825545310974, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 31.92323232323233, "ram_util_percent": 42.75353535353535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -3735.93896484375, "policy_loss": -3800.81982421875, "entropy": 14.877042770385742, "entropy_coeff": 0.01, "var_gnorm": 2048.274658203125, "vf_loss": 205.9320068359375, "vf_explained_var": 0.0018543601036071777}, "model": {}, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 72704, "num_env_steps_trained": 40880, "num_agent_steps_sampled": 204681, "num_agent_steps_trained": 40880, "num_training_step_calls_since_last_synch_worker_weights": 4107, "num_samples_added_to_queue": 13312, "num_times_learner_queue_full": 116, "num_weight_broadcasts": 17, "learner_queue": {"size_count": 26, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.102, "learner_load_time_ms": 106.418, "learner_load_wait_time_ms": 7268.281, "learner_dequeue_time_ms": 54494.223}}, "env_runners": {"episode_reward_max": 4.0745185003743245e-13, "episode_reward_min": 0.0, "episode_reward_mean": 8.174542124287335e-14, "episode_len_mean": 1246.4594594594594, "episode_media": {}, "episodes_timesteps_total": 46119, "policy_reward_min": {"default_policy": -1899.0}, "policy_reward_max": {"default_policy": 3122.2769347808007}, "policy_reward_mean": {"default_policy": 2.6749844169792007e-14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 1.3100631690576847e-13, 1.1102230246251565e-16, 1.723066134218243e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.432187701766452e-13, 2.220446049250313e-16, 2.036149027162537e-13, 3.352873534367973e-14, 0.0, 2.220446049250313e-16, 1.4876988529977098e-13, 0.0, 2.751132655021138e-13, 0.0, 0.0, 0.0, 2.569056078982612e-13, 8.903988657493755e-14, 3.33510996597397e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 9.259260025373806e-14, 1.7386092565629951e-13, 2.220446049250313e-16, 4.0745185003743245e-13, 1.7741363933510002e-13, 3.850253449400043e-13, 0.0], "episode_lengths": [1026, 1027, 1026, 1026, 1026, 1026, 2005, 1027, 1026, 1026, 1537, 1026, 1026, 1023, 1024, 2050, 1024, 1024, 45, 1538, 2050, 1538, 1024, 1538, 513, 2050, 1024, 1024, 1024, 1536, 1024, 1024, 2048, 2048, 1024, 2048, 1024], "policy_default_policy_reward": [0.0, 0.0, 304.0, -304.0, 678.1154031579039, -104.65180361560927, -573.4635995422934, -359.7276934780741, -255.72769347806906, 1289.261626873353, -673.8062399172434, 253.14422766478543, -712.0565286548579, 458.91230099007186, 641.0, -641.0, -1422.0, 1422.0, 218.0, -218.0, 476.0, -476.0, -491.0, 491.0, -853.0, 853.0, 184.55486988968912, -180.31222920257045, -4.242640687119216, -847.0614872174385, 722.3538290724795, 722.3538290724795, -597.6461709275205, 405.17218561989387, 324.5620125646261, -729.7341981845217, 106.77312395916894, 106.77312395916894, -213.54624791833785, 1899.0, -1899.0, -738.5559337179743, 594.2183664205663, -523.7816335794337, 668.119200876838, 649.1240251292546, -4.242640687119268, -644.8813844421359, 0.0, 0.0, 0.0, 1071.2667734976521, -150.6137443927355, -920.6530291048914, 600.0, -600.0, -1116.0, 1116.0, -235.0, 235.0, -1428.3556979968134, 423.34375849514817, 1005.0119395016877, 283.5498192558072, -567.0996385116144, 283.5498192558072, -1670.1862171625644, 1516.0369388639695, 154.14927829866792, -499.0, 499.0, 294.3405434088003, -182.33459118601218, -420.2029020921448, 308.1969498693484, 0.0, 0.0, -736.3199243042488, -891.0497964470759, -440.31992430423475, 2067.689645055477, 294.8635277547921, -589.7270555095841, 294.8635277547921, -578.4133470106, 1082.5804819966118, -504.16713498601183, -974.5339333953345, 3122.2769347808007, -1023.09799800084, -1124.6450033846172, -1215.5165568596535, 2199.809196271341, -984.2926394116821, -403.7579720575213, 98.99494936611657, 304.7630226914033, -1223.2947314527044, -1227.537372139823, 2450.8321035925273, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.690278245918682, "mean_inference_ms": 3.691297478976334, "mean_action_processing_ms": 0.6994197341902831, "mean_env_wait_ms": 29.936109664039503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016236305236816406, "StateBufferConnector_ms": 0.011647714150918496, "ViewRequirementAgentConnector_ms": 0.4799514203458219}, "num_episodes": 11, "episode_return_max": 4.0745185003743245e-13, "episode_return_min": 0.0, "episode_return_mean": 8.174542124287335e-14, "episodes_this_iter": 11}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204681, "num_agent_steps_trained": 40880, "num_env_steps_sampled": 72704, "num_env_steps_trained": 40880, "num_env_steps_sampled_this_iter": 25088, "num_env_steps_trained_this_iter": 14846, "num_env_steps_sampled_throughput_per_sec": 2508.7968896522934, "num_env_steps_trained_throughput_per_sec": 1484.5981594299246, "timesteps_total": 72704, "num_env_steps_sampled_lifetime": 72704, "num_agent_steps_sampled_lifetime": 204681, "num_steps_trained_this_iter": 14846, "agent_timesteps_total": 204681, "timers": {"training_iteration_time_ms": 10000.083, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.169, "sample_time_ms": 0.126, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 72704, "num_env_steps_trained": 40880, "num_agent_steps_sampled": 204681, "num_agent_steps_trained": 40880, "num_training_step_calls_since_last_synch_worker_weights": 4107, "num_samples_added_to_queue": 13312, "num_times_learner_queue_full": 116, "num_weight_broadcasts": 17}, "done": false, "training_iteration": 4, "trial_id": "6466c_00000", "date": "2024-09-02_13-51-49", "timestamp": 1725252709, "time_this_iter_s": 70.00931215286255, "time_total_s": 280.0475676059723, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 280.0475676059723, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.31699999999999, "ram_util_percent": 43.02800000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -2741.686767578125, "policy_loss": -2785.51220703125, "entropy": 12.186408996582031, "entropy_coeff": 0.01, "var_gnorm": 2048.27490234375, "vf_loss": 150.0454559326172, "vf_explained_var": -0.0092087984085083}, "model": {}, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 97792, "num_env_steps_trained": 58282, "num_agent_steps_sampled": 283312, "num_agent_steps_trained": 58282, "num_training_step_calls_since_last_synch_worker_weights": 6126, "num_samples_added_to_queue": 17920, "num_times_learner_queue_full": 156, "num_weight_broadcasts": 23, "learner_queue": {"size_count": 35, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 46.564, "learner_load_time_ms": 119.939, "learner_load_wait_time_ms": 7017.506, "learner_dequeue_time_ms": 57101.204}}, "env_runners": {"episode_reward_max": 4.0745185003743245e-13, "episode_reward_min": 0.0, "episode_reward_mean": 8.441164434103143e-14, "episode_len_mean": 1323.4791666666667, "episode_media": {}, "episodes_timesteps_total": 63527, "policy_reward_min": {"default_policy": -1899.0}, "policy_reward_max": {"default_policy": 3122.2769347808007}, "policy_reward_mean": {"default_policy": -7.812764637410305e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 1.3100631690576847e-13, 1.1102230246251565e-16, 1.723066134218243e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.432187701766452e-13, 2.220446049250313e-16, 2.036149027162537e-13, 3.352873534367973e-14, 0.0, 2.220446049250313e-16, 1.4876988529977098e-13, 0.0, 2.751132655021138e-13, 0.0, 0.0, 0.0, 2.569056078982612e-13, 8.903988657493755e-14, 3.33510996597397e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 9.259260025373806e-14, 1.7386092565629951e-13, 2.220446049250313e-16, 4.0745185003743245e-13, 1.7741363933510002e-13, 3.850253449400043e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.483879851273741e-13, 2.220446049250313e-16, 2.731148640577885e-13, 4.050093593832571e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0], "episode_lengths": [1026, 1027, 1026, 1026, 1026, 1026, 2005, 1027, 1026, 1026, 1537, 1026, 1026, 1023, 1024, 2050, 1024, 1024, 45, 1538, 2050, 1538, 1024, 1538, 513, 2050, 1024, 1024, 1024, 1536, 1024, 1024, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 2048, 1024], "policy_default_policy_reward": [0.0, 0.0, 304.0, -304.0, 678.1154031579039, -104.65180361560927, -573.4635995422934, -359.7276934780741, -255.72769347806906, 1289.261626873353, -673.8062399172434, 253.14422766478543, -712.0565286548579, 458.91230099007186, 641.0, -641.0, -1422.0, 1422.0, 218.0, -218.0, 476.0, -476.0, -491.0, 491.0, -853.0, 853.0, 184.55486988968912, -180.31222920257045, -4.242640687119216, -847.0614872174385, 722.3538290724795, 722.3538290724795, -597.6461709275205, 405.17218561989387, 324.5620125646261, -729.7341981845217, 106.77312395916894, 106.77312395916894, -213.54624791833785, 1899.0, -1899.0, -738.5559337179743, 594.2183664205663, -523.7816335794337, 668.119200876838, 649.1240251292546, -4.242640687119268, -644.8813844421359, 0.0, 0.0, 0.0, 1071.2667734976521, -150.6137443927355, -920.6530291048914, 600.0, -600.0, -1116.0, 1116.0, -235.0, 235.0, -1428.3556979968134, 423.34375849514817, 1005.0119395016877, 283.5498192558072, -567.0996385116144, 283.5498192558072, -1670.1862171625644, 1516.0369388639695, 154.14927829866792, -499.0, 499.0, 294.3405434088003, -182.33459118601218, -420.2029020921448, 308.1969498693484, 0.0, 0.0, -736.3199243042488, -891.0497964470759, -440.31992430423475, 2067.689645055477, 294.8635277547921, -589.7270555095841, 294.8635277547921, -578.4133470106, 1082.5804819966118, -504.16713498601183, -974.5339333953345, 3122.2769347808007, -1023.09799800084, -1124.6450033846172, -1215.5165568596535, 2199.809196271341, -984.2926394116821, -403.7579720575213, 98.99494936611657, 304.7630226914033, -1223.2947314527044, -1227.537372139823, 2450.8321035925273, 0.0, 0.0, 647.0, -647.0, -479.0, 479.0, 1189.1023553302919, -754.9349528997182, 209.9162987846923, -644.0837012153099, -1354.5840533340604, 2377.7675657110026, -1023.1835123769418, -819.801085141098, -42.760217028216225, -244.76021702821623, 1107.3215191975069, 545.8864350760184, 53.74011537017761, -599.6265504461965, -1022.4764055957553, 207.88939366884597, 814.5870119269081, -79.0, 79.0, 1794.0, -1794.0, -896.1814855409405, -1582.07360533816, 636.3738644055659, 1841.881226473496, 813.0, -813.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.1172010203137, "mean_inference_ms": 3.7073691655298653, "mean_action_processing_ms": 0.7080993071249398, "mean_env_wait_ms": 29.166390752264885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015499691168467203, "StateBufferConnector_ms": 0.011709829171498617, "ViewRequirementAgentConnector_ms": 0.4792998234430949}, "num_episodes": 11, "episode_return_max": 4.0745185003743245e-13, "episode_return_min": 0.0, "episode_return_mean": 8.441164434103143e-14, "episodes_this_iter": 11}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283312, "num_agent_steps_trained": 58282, "num_env_steps_sampled": 97792, "num_env_steps_trained": 58282, "num_env_steps_sampled_this_iter": 25088, "num_env_steps_trained_this_iter": 17402, "num_env_steps_sampled_throughput_per_sec": 2508.781816538042, "num_env_steps_trained_throughput_per_sec": 1740.1873872526712, "timesteps_total": 97792, "num_env_steps_sampled_lifetime": 97792, "num_agent_steps_sampled_lifetime": 283312, "num_steps_trained_this_iter": 17402, "agent_timesteps_total": 283312, "timers": {"training_iteration_time_ms": 10000.083, "restore_workers_time_ms": 0.007, "training_step_time_ms": 0.147, "sample_time_ms": 0.104, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 97792, "num_env_steps_trained": 58282, "num_agent_steps_sampled": 283312, "num_agent_steps_trained": 58282, "num_training_step_calls_since_last_synch_worker_weights": 6126, "num_samples_added_to_queue": 17920, "num_times_learner_queue_full": 156, "num_weight_broadcasts": 23}, "done": false, "training_iteration": 5, "trial_id": "6466c_00000", "date": "2024-09-02_13-52-59", "timestamp": 1725252779, "time_this_iter_s": 70.00960993766785, "time_total_s": 350.05717754364014, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 350.05717754364014, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.25858585858586, "ram_util_percent": 43.72424242424243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 6.011706352233887, "policy_loss": 37.35723114013672, "entropy": 12.307388305664062, "entropy_coeff": 0.01, "var_gnorm": 2048.27490234375, "vf_loss": 0.32277849316596985, "vf_explained_var": 0.03437119722366333}, "model": {}, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 123392, "num_env_steps_trained": 74666, "num_agent_steps_sampled": 366561, "num_agent_steps_trained": 74666, "num_training_step_calls_since_last_synch_worker_weights": 12470, "num_samples_added_to_queue": 23040, "num_times_learner_queue_full": 196, "num_weight_broadcasts": 29, "learner_queue": {"size_count": 45, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.81, "learner_load_time_ms": 131.971, "learner_load_wait_time_ms": 6832.603, "learner_dequeue_time_ms": 58622.499}}, "env_runners": {"episode_reward_max": 4.0745185003743245e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 6.949441022641168e-14, "episode_len_mean": 1369.9666666666667, "episode_media": {}, "episodes_timesteps_total": 82198, "policy_reward_min": {"default_policy": -1899.0}, "policy_reward_max": {"default_policy": 3122.2769347808007}, "policy_reward_mean": {"default_policy": -4.4152795115139246e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 1.3100631690576847e-13, 1.1102230246251565e-16, 1.723066134218243e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.432187701766452e-13, 2.220446049250313e-16, 2.036149027162537e-13, 3.352873534367973e-14, 0.0, 2.220446049250313e-16, 1.4876988529977098e-13, 0.0, 2.751132655021138e-13, 0.0, 0.0, 0.0, 2.569056078982612e-13, 8.903988657493755e-14, 3.33510996597397e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 9.259260025373806e-14, 1.7386092565629951e-13, 2.220446049250313e-16, 4.0745185003743245e-13, 1.7741363933510002e-13, 3.850253449400043e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.483879851273741e-13, 2.220446049250313e-16, 2.731148640577885e-13, 4.050093593832571e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, -2.220446049250313e-16, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 1.1790568521519162e-13, -3.3306690738754696e-16], "episode_lengths": [1026, 1027, 1026, 1026, 1026, 1026, 2005, 1027, 1026, 1026, 1537, 1026, 1026, 1023, 1024, 2050, 1024, 1024, 45, 1538, 2050, 1538, 1024, 1538, 513, 2050, 1024, 1024, 1024, 1536, 1024, 1024, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 2048, 1024, 1536, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1775, 1024, 1024, 1024], "policy_default_policy_reward": [0.0, 0.0, 304.0, -304.0, 678.1154031579039, -104.65180361560927, -573.4635995422934, -359.7276934780741, -255.72769347806906, 1289.261626873353, -673.8062399172434, 253.14422766478543, -712.0565286548579, 458.91230099007186, 641.0, -641.0, -1422.0, 1422.0, 218.0, -218.0, 476.0, -476.0, -491.0, 491.0, -853.0, 853.0, 184.55486988968912, -180.31222920257045, -4.242640687119216, -847.0614872174385, 722.3538290724795, 722.3538290724795, -597.6461709275205, 405.17218561989387, 324.5620125646261, -729.7341981845217, 106.77312395916894, 106.77312395916894, -213.54624791833785, 1899.0, -1899.0, -738.5559337179743, 594.2183664205663, -523.7816335794337, 668.119200876838, 649.1240251292546, -4.242640687119268, -644.8813844421359, 0.0, 0.0, 0.0, 1071.2667734976521, -150.6137443927355, -920.6530291048914, 600.0, -600.0, -1116.0, 1116.0, -235.0, 235.0, -1428.3556979968134, 423.34375849514817, 1005.0119395016877, 283.5498192558072, -567.0996385116144, 283.5498192558072, -1670.1862171625644, 1516.0369388639695, 154.14927829866792, -499.0, 499.0, 294.3405434088003, -182.33459118601218, -420.2029020921448, 308.1969498693484, 0.0, 0.0, -736.3199243042488, -891.0497964470759, -440.31992430423475, 2067.689645055477, 294.8635277547921, -589.7270555095841, 294.8635277547921, -578.4133470106, 1082.5804819966118, -504.16713498601183, -974.5339333953345, 3122.2769347808007, -1023.09799800084, -1124.6450033846172, -1215.5165568596535, 2199.809196271341, -984.2926394116821, -403.7579720575213, 98.99494936611657, 304.7630226914033, -1223.2947314527044, -1227.537372139823, 2450.8321035925273, 0.0, 0.0, 647.0, -647.0, -479.0, 479.0, 1189.1023553302919, -754.9349528997182, 209.9162987846923, -644.0837012153099, -1354.5840533340604, 2377.7675657110026, -1023.1835123769418, -819.801085141098, -42.760217028216225, -244.76021702821623, 1107.3215191975069, 545.8864350760184, 53.74011537017761, -599.6265504461965, -1022.4764055957553, 207.88939366884597, 814.5870119269081, -79.0, 79.0, 1794.0, -1794.0, -896.1814855409405, -1582.07360533816, 636.3738644055659, 1841.881226473496, 813.0, -813.0, -345.6810868176027, -601.1733546534007, 1402.5355282885694, -455.6810868176078, 908.9668926783794, -896.2651867562547, -823.7899781421679, 811.0882722199735, 2689.093056899892, -1339.2481275344699, -1498.5968018307753, 148.75187246547335, -768.0, 768.0, 0.0, 0.0, -982.95280956808, 1273.9373452396255, -38.407769173858114, -252.57676649774675, 1081.7899781421434, -1334.6693960471853, 522.0890696665969, -269.2096517615687, -1457.377637963565, -1418.1178196586782, 475.8821803412443, 2399.6132772811134, 1493.0, -1493.0, 0.0, 0.0, 358.50313806158186, -742.4621202458796, 383.9589821842978, -330.6892177051387, -247.55077894182895, 1119.3496854181553, -541.1096887712093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.810784496625732, "mean_inference_ms": 3.7186607953532094, "mean_action_processing_ms": 0.7158768621202913, "mean_env_wait_ms": 28.131047791072078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015417734781901041, "StateBufferConnector_ms": 0.012029806772867838, "ViewRequirementAgentConnector_ms": 0.4937533537546794}, "num_episodes": 12, "episode_return_max": 4.0745185003743245e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 6.949441022641168e-14, "episodes_this_iter": 12}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 366561, "num_agent_steps_trained": 74666, "num_env_steps_sampled": 123392, "num_env_steps_trained": 74666, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 16384, "num_env_steps_sampled_throughput_per_sec": 2559.974365491068, "num_env_steps_trained_throughput_per_sec": 1638.3835939142837, "timesteps_total": 123392, "num_env_steps_sampled_lifetime": 123392, "num_agent_steps_sampled_lifetime": 366561, "num_steps_trained_this_iter": 16384, "agent_timesteps_total": 366561, "timers": {"training_iteration_time_ms": 10000.088, "restore_workers_time_ms": 0.007, "training_step_time_ms": 0.164, "sample_time_ms": 0.114, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 123392, "num_env_steps_trained": 74666, "num_agent_steps_sampled": 366561, "num_agent_steps_trained": 74666, "num_training_step_calls_since_last_synch_worker_weights": 12470, "num_samples_added_to_queue": 23040, "num_times_learner_queue_full": 196, "num_weight_broadcasts": 29}, "done": false, "training_iteration": 6, "trial_id": "6466c_00000", "date": "2024-09-02_13-54-09", "timestamp": 1725252849, "time_this_iter_s": 70.00971913337708, "time_total_s": 420.0668966770172, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 420.0668966770172, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.955000000000005, "ram_util_percent": 44.333999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 7527.19384765625, "policy_loss": 6774.189453125, "entropy": 12.790987014770508, "entropy_coeff": 0.01, "var_gnorm": 2048.27490234375, "vf_loss": 1571.4993896484375, "vf_explained_var": 0.00015783309936523438}, "model": {}, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 148480, "num_env_steps_trained": 85930, "num_agent_steps_sampled": 446996, "num_agent_steps_trained": 85930, "num_training_step_calls_since_last_synch_worker_weights": 34323, "num_samples_added_to_queue": 26624, "num_times_learner_queue_full": 238, "num_weight_broadcasts": 32, "learner_queue": {"size_count": 52, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 46.828, "learner_load_time_ms": 122.489, "learner_load_wait_time_ms": 7018.227, "learner_dequeue_time_ms": 59986.073}}, "env_runners": {"episode_reward_max": 4.0745185003743245e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 6.145920910702357e-14, "episode_len_mean": 1396.2602739726028, "episode_media": {}, "episodes_timesteps_total": 101927, "policy_reward_min": {"default_policy": -1899.0}, "policy_reward_max": {"default_policy": 3122.2769347808007}, "policy_reward_mean": {"default_policy": -2.0506130542310182e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 1.3100631690576847e-13, 1.1102230246251565e-16, 1.723066134218243e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.432187701766452e-13, 2.220446049250313e-16, 2.036149027162537e-13, 3.352873534367973e-14, 0.0, 2.220446049250313e-16, 1.4876988529977098e-13, 0.0, 2.751132655021138e-13, 0.0, 0.0, 0.0, 2.569056078982612e-13, 8.903988657493755e-14, 3.33510996597397e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 9.259260025373806e-14, 1.7386092565629951e-13, 2.220446049250313e-16, 4.0745185003743245e-13, 1.7741363933510002e-13, 3.850253449400043e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.483879851273741e-13, 2.220446049250313e-16, 2.731148640577885e-13, 4.050093593832571e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, -2.220446049250313e-16, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 1.1790568521519162e-13, -3.3306690738754696e-16, 1.6076029396572267e-13, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, -3.3306690738754696e-16, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, 1.5565326805244695e-13, 2.220446049250313e-16], "episode_lengths": [1026, 1027, 1026, 1026, 1026, 1026, 2005, 1027, 1026, 1026, 1537, 1026, 1026, 1023, 1024, 2050, 1024, 1024, 45, 1538, 2050, 1538, 1024, 1538, 513, 2050, 1024, 1024, 1024, 1536, 1024, 1024, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 2048, 1024, 1536, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1775, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 1024, 273, 2048, 1024, 2048], "policy_default_policy_reward": [0.0, 0.0, 304.0, -304.0, 678.1154031579039, -104.65180361560927, -573.4635995422934, -359.7276934780741, -255.72769347806906, 1289.261626873353, -673.8062399172434, 253.14422766478543, -712.0565286548579, 458.91230099007186, 641.0, -641.0, -1422.0, 1422.0, 218.0, -218.0, 476.0, -476.0, -491.0, 491.0, -853.0, 853.0, 184.55486988968912, -180.31222920257045, -4.242640687119216, -847.0614872174385, 722.3538290724795, 722.3538290724795, -597.6461709275205, 405.17218561989387, 324.5620125646261, -729.7341981845217, 106.77312395916894, 106.77312395916894, -213.54624791833785, 1899.0, -1899.0, -738.5559337179743, 594.2183664205663, -523.7816335794337, 668.119200876838, 649.1240251292546, -4.242640687119268, -644.8813844421359, 0.0, 0.0, 0.0, 1071.2667734976521, -150.6137443927355, -920.6530291048914, 600.0, -600.0, -1116.0, 1116.0, -235.0, 235.0, -1428.3556979968134, 423.34375849514817, 1005.0119395016877, 283.5498192558072, -567.0996385116144, 283.5498192558072, -1670.1862171625644, 1516.0369388639695, 154.14927829866792, -499.0, 499.0, 294.3405434088003, -182.33459118601218, -420.2029020921448, 308.1969498693484, 0.0, 0.0, -736.3199243042488, -891.0497964470759, -440.31992430423475, 2067.689645055477, 294.8635277547921, -589.7270555095841, 294.8635277547921, -578.4133470106, 1082.5804819966118, -504.16713498601183, -974.5339333953345, 3122.2769347808007, -1023.09799800084, -1124.6450033846172, -1215.5165568596535, 2199.809196271341, -984.2926394116821, -403.7579720575213, 98.99494936611657, 304.7630226914033, -1223.2947314527044, -1227.537372139823, 2450.8321035925273, 0.0, 0.0, 647.0, -647.0, -479.0, 479.0, 1189.1023553302919, -754.9349528997182, 209.9162987846923, -644.0837012153099, -1354.5840533340604, 2377.7675657110026, -1023.1835123769418, -819.801085141098, -42.760217028216225, -244.76021702821623, 1107.3215191975069, 545.8864350760184, 53.74011537017761, -599.6265504461965, -1022.4764055957553, 207.88939366884597, 814.5870119269081, -79.0, 79.0, 1794.0, -1794.0, -896.1814855409405, -1582.07360533816, 636.3738644055659, 1841.881226473496, 813.0, -813.0, -345.6810868176027, -601.1733546534007, 1402.5355282885694, -455.6810868176078, 908.9668926783794, -896.2651867562547, -823.7899781421679, 811.0882722199735, 2689.093056899892, -1339.2481275344699, -1498.5968018307753, 148.75187246547335, -768.0, 768.0, 0.0, 0.0, -982.95280956808, 1273.9373452396255, -38.407769173858114, -252.57676649774675, 1081.7899781421434, -1334.6693960471853, 522.0890696665969, -269.2096517615687, -1457.377637963565, -1418.1178196586782, 475.8821803412443, 2399.6132772811134, 1493.0, -1493.0, 0.0, 0.0, 358.50313806158186, -742.4621202458796, 383.9589821842978, -330.6892177051387, -247.55077894182895, 1119.3496854181553, -541.1096887712093, -656.1950929411202, -223.4457428549502, 879.6408357960715, -855.0571298879464, 594.0948082142238, -358.5358983848671, 619.4982200585677, 365.0, -365.0, -1102.798109029693, 497.08529610858255, -635.6493607141073, 1241.3621736352038, -840.0, 840.0, 514.2693304105163, 2274.032950900516, -1546.5716117215188, -1241.7306695894408, -875.0, 875.0, -252.8712870175201, 421.4738273959373, 1699.7110616066993, -1868.3136019850501, 345.3413408554502, -1432.8974882485816, 614.2148065377182, 473.3413408554502, 0.0, 0.0, -629.3258765270219, -632.7618119215373, -1259.6352776037938, 2521.7229660522994, 183.14065632731626, 134.35028842544395, -317.4909447527618, -759.0289636673123, -1137.7707402556837, 56.97103633269754, 1839.8286675902427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.441239015106504, "mean_inference_ms": 3.736897922846606, "mean_action_processing_ms": 0.7257746441473237, "mean_env_wait_ms": 27.215959835878206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015838832071382706, "StateBufferConnector_ms": 0.01241507595532561, "ViewRequirementAgentConnector_ms": 0.5045074306122245}, "num_episodes": 13, "episode_return_max": 4.0745185003743245e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 6.145920910702357e-14, "episodes_this_iter": 13}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 446996, "num_agent_steps_trained": 85930, "num_env_steps_sampled": 148480, "num_env_steps_trained": 85930, "num_env_steps_sampled_this_iter": 25088, "num_env_steps_trained_this_iter": 11264, "num_env_steps_sampled_throughput_per_sec": 2508.799282226768, "num_env_steps_trained_throughput_per_sec": 1126.399677734467, "timesteps_total": 148480, "num_env_steps_sampled_lifetime": 148480, "num_agent_steps_sampled_lifetime": 446996, "num_steps_trained_this_iter": 11264, "agent_timesteps_total": 446996, "timers": {"training_iteration_time_ms": 10000.078, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.141, "sample_time_ms": 0.099, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 148480, "num_env_steps_trained": 85930, "num_agent_steps_sampled": 446996, "num_agent_steps_trained": 85930, "num_training_step_calls_since_last_synch_worker_weights": 34323, "num_samples_added_to_queue": 26624, "num_times_learner_queue_full": 238, "num_weight_broadcasts": 32}, "done": false, "training_iteration": 7, "trial_id": "6466c_00000", "date": "2024-09-02_13-55-19", "timestamp": 1725252919, "time_this_iter_s": 70.01004385948181, "time_total_s": 490.076940536499, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 490.076940536499, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 37.9030303030303, "ram_util_percent": 43.920202020202005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 5206.611328125, "policy_loss": 4928.66748046875, "entropy": 12.681997299194336, "entropy_coeff": 0.01, "var_gnorm": 2048.275146484375, "vf_loss": 620.8195190429688, "vf_explained_var": -0.004781007766723633}, "model": {}, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 173568, "num_env_steps_trained": 97706, "num_agent_steps_sampled": 523481, "num_agent_steps_trained": 97706, "num_training_step_calls_since_last_synch_worker_weights": 1436, "num_samples_added_to_queue": 30208, "num_times_learner_queue_full": 280, "num_weight_broadcasts": 36, "learner_queue": {"size_count": 59, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 44.196, "learner_load_time_ms": 115.174, "learner_load_wait_time_ms": 7727.013, "learner_dequeue_time_ms": 61214.333}}, "env_runners": {"episode_reward_max": 4.0745185003743245e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 6.188589692381483e-14, "episode_len_mean": 1386.906976744186, "episode_media": {}, "episodes_timesteps_total": 119274, "policy_reward_min": {"default_policy": -1899.0}, "policy_reward_max": {"default_policy": 3122.2769347808007}, "policy_reward_mean": {"default_policy": 5.5941142370953916e-14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 1.3100631690576847e-13, 1.1102230246251565e-16, 1.723066134218243e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.432187701766452e-13, 2.220446049250313e-16, 2.036149027162537e-13, 3.352873534367973e-14, 0.0, 2.220446049250313e-16, 1.4876988529977098e-13, 0.0, 2.751132655021138e-13, 0.0, 0.0, 0.0, 2.569056078982612e-13, 8.903988657493755e-14, 3.33510996597397e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 9.259260025373806e-14, 1.7386092565629951e-13, 2.220446049250313e-16, 4.0745185003743245e-13, 1.7741363933510002e-13, 3.850253449400043e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.483879851273741e-13, 2.220446049250313e-16, 2.731148640577885e-13, 4.050093593832571e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, -2.220446049250313e-16, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 1.1790568521519162e-13, -3.3306690738754696e-16, 1.6076029396572267e-13, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, -3.3306690738754696e-16, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, 1.5565326805244695e-13, 2.220446049250313e-16, 2.220446049250313e-16, 1.9895196601282805e-13, 0.0, 1.6542323066914832e-13, 1.2811973704174306e-13, -3.3306690738754696e-16, 1.2234657731369225e-13, 2.220446049250313e-16, 0.0, 8.060219158778636e-14, 0.0, 0.0, 1.4011014570769476e-13], "episode_lengths": [1026, 1027, 1026, 1026, 1026, 1026, 2005, 1027, 1026, 1026, 1537, 1026, 1026, 1023, 1024, 2050, 1024, 1024, 45, 1538, 2050, 1538, 1024, 1538, 513, 2050, 1024, 1024, 1024, 1536, 1024, 1024, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 2048, 1024, 1536, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1775, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 1024, 273, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 1024, 2047, 1988, 1024], "policy_default_policy_reward": [0.0, 0.0, 304.0, -304.0, 678.1154031579039, -104.65180361560927, -573.4635995422934, -359.7276934780741, -255.72769347806906, 1289.261626873353, -673.8062399172434, 253.14422766478543, -712.0565286548579, 458.91230099007186, 641.0, -641.0, -1422.0, 1422.0, 218.0, -218.0, 476.0, -476.0, -491.0, 491.0, -853.0, 853.0, 184.55486988968912, -180.31222920257045, -4.242640687119216, -847.0614872174385, 722.3538290724795, 722.3538290724795, -597.6461709275205, 405.17218561989387, 324.5620125646261, -729.7341981845217, 106.77312395916894, 106.77312395916894, -213.54624791833785, 1899.0, -1899.0, -738.5559337179743, 594.2183664205663, -523.7816335794337, 668.119200876838, 649.1240251292546, -4.242640687119268, -644.8813844421359, 0.0, 0.0, 0.0, 1071.2667734976521, -150.6137443927355, -920.6530291048914, 600.0, -600.0, -1116.0, 1116.0, -235.0, 235.0, -1428.3556979968134, 423.34375849514817, 1005.0119395016877, 283.5498192558072, -567.0996385116144, 283.5498192558072, -1670.1862171625644, 1516.0369388639695, 154.14927829866792, -499.0, 499.0, 294.3405434088003, -182.33459118601218, -420.2029020921448, 308.1969498693484, 0.0, 0.0, -736.3199243042488, -891.0497964470759, -440.31992430423475, 2067.689645055477, 294.8635277547921, -589.7270555095841, 294.8635277547921, -578.4133470106, 1082.5804819966118, -504.16713498601183, -974.5339333953345, 3122.2769347808007, -1023.09799800084, -1124.6450033846172, -1215.5165568596535, 2199.809196271341, -984.2926394116821, -403.7579720575213, 98.99494936611657, 304.7630226914033, -1223.2947314527044, -1227.537372139823, 2450.8321035925273, 0.0, 0.0, 647.0, -647.0, -479.0, 479.0, 1189.1023553302919, -754.9349528997182, 209.9162987846923, -644.0837012153099, -1354.5840533340604, 2377.7675657110026, -1023.1835123769418, -819.801085141098, -42.760217028216225, -244.76021702821623, 1107.3215191975069, 545.8864350760184, 53.74011537017761, -599.6265504461965, -1022.4764055957553, 207.88939366884597, 814.5870119269081, -79.0, 79.0, 1794.0, -1794.0, -896.1814855409405, -1582.07360533816, 636.3738644055659, 1841.881226473496, 813.0, -813.0, -345.6810868176027, -601.1733546534007, 1402.5355282885694, -455.6810868176078, 908.9668926783794, -896.2651867562547, -823.7899781421679, 811.0882722199735, 2689.093056899892, -1339.2481275344699, -1498.5968018307753, 148.75187246547335, -768.0, 768.0, 0.0, 0.0, -982.95280956808, 1273.9373452396255, -38.407769173858114, -252.57676649774675, 1081.7899781421434, -1334.6693960471853, 522.0890696665969, -269.2096517615687, -1457.377637963565, -1418.1178196586782, 475.8821803412443, 2399.6132772811134, 1493.0, -1493.0, 0.0, 0.0, 358.50313806158186, -742.4621202458796, 383.9589821842978, -330.6892177051387, -247.55077894182895, 1119.3496854181553, -541.1096887712093, -656.1950929411202, -223.4457428549502, 879.6408357960715, -855.0571298879464, 594.0948082142238, -358.5358983848671, 619.4982200585677, 365.0, -365.0, -1102.798109029693, 497.08529610858255, -635.6493607141073, 1241.3621736352038, -840.0, 840.0, 514.2693304105163, 2274.032950900516, -1546.5716117215188, -1241.7306695894408, -875.0, 875.0, -252.8712870175201, 421.4738273959373, 1699.7110616066993, -1868.3136019850501, 345.3413408554502, -1432.8974882485816, 614.2148065377182, 473.3413408554502, 0.0, 0.0, -629.3258765270219, -632.7618119215373, -1259.6352776037938, 2521.7229660522994, 183.14065632731626, 134.35028842544395, -317.4909447527618, -759.0289636673123, -1137.7707402556837, 56.97103633269754, 1839.8286675902427, -1470.6791218279868, 2854.0103668064353, -554.6656224891848, -828.6656224891962, 728.3199846221491, -1172.3830432072887, 444.06305858515475, -647.0, 647.0, -584.0702012600918, -412.2432534317599, 996.3134546918523, 471.6402230514304, 280.721392131061, -752.3616151824914, -41.942286340601036, -425.3028650825172, 966.8574175823729, -499.612266159279, -135.7645019878176, 604.5762979145019, -468.81179592668354, -859.3242816337267, 671.1080938779087, -482.8919061220913, 671.1080938779087, 989.0, -989.0, 256.6797615707182, 256.6797615707182, -513.3595231414364, 712.0, -712.0, 1150.0, -1150.0, -799.0306627408039, 259.5081886954644, 539.5224740453394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.92830180591538, "mean_inference_ms": 3.7491514076499852, "mean_action_processing_ms": 0.7325190530344741, "mean_env_wait_ms": 26.58047267235818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01579550809638445, "StateBufferConnector_ms": 0.012335666390352471, "ViewRequirementAgentConnector_ms": 0.5038128342739371}, "num_episodes": 13, "episode_return_max": 4.0745185003743245e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 6.188589692381483e-14, "episodes_this_iter": 13}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 523481, "num_agent_steps_trained": 97706, "num_env_steps_sampled": 173568, "num_env_steps_trained": 97706, "num_env_steps_sampled_this_iter": 25088, "num_env_steps_trained_this_iter": 11776, "num_env_steps_sampled_throughput_per_sec": 2508.7947961533723, "num_env_steps_trained_throughput_per_sec": 1177.5975573781134, "timesteps_total": 173568, "num_env_steps_sampled_lifetime": 173568, "num_agent_steps_sampled_lifetime": 523481, "num_steps_trained_this_iter": 11776, "agent_timesteps_total": 523481, "timers": {"training_iteration_time_ms": 10000.072, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.158, "sample_time_ms": 0.11, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 173568, "num_env_steps_trained": 97706, "num_agent_steps_sampled": 523481, "num_agent_steps_trained": 97706, "num_training_step_calls_since_last_synch_worker_weights": 1436, "num_samples_added_to_queue": 30208, "num_times_learner_queue_full": 280, "num_weight_broadcasts": 36}, "done": false, "training_iteration": 8, "trial_id": "6466c_00000", "date": "2024-09-02_13-56-29", "timestamp": 1725252989, "time_this_iter_s": 70.00923228263855, "time_total_s": 560.0861728191376, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 560.0861728191376, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.889, "ram_util_percent": 42.867000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -15583.19921875, "policy_loss": -17675.794921875, "entropy": 13.777392387390137, "entropy_coeff": 0.01, "var_gnorm": 2048.275146484375, "vf_loss": 4255.7294921875, "vf_explained_var": -0.001836538314819336}, "model": {}, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 198144, "num_env_steps_trained": 112698, "num_agent_steps_sampled": 594284, "num_agent_steps_trained": 112698, "num_training_step_calls_since_last_synch_worker_weights": 5595, "num_samples_added_to_queue": 35328, "num_times_learner_queue_full": 318, "num_weight_broadcasts": 43, "learner_queue": {"size_count": 69, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.187, "learner_load_time_ms": 113.689, "learner_load_wait_time_ms": 6872.279, "learner_dequeue_time_ms": 62374.129}}, "env_runners": {"episode_reward_max": 4.0745185003743245e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 5.69804974179301e-14, "episode_len_mean": 1374.9897959183672, "episode_media": {}, "episodes_timesteps_total": 134749, "policy_reward_min": {"default_policy": -1899.0}, "policy_reward_max": {"default_policy": 3122.2769347808007}, "policy_reward_mean": {"default_policy": -3.6126270384011785e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 1.3100631690576847e-13, 1.1102230246251565e-16, 1.723066134218243e-13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.432187701766452e-13, 2.220446049250313e-16, 2.036149027162537e-13, 3.352873534367973e-14, 0.0, 2.220446049250313e-16, 1.4876988529977098e-13, 0.0, 2.751132655021138e-13, 0.0, 0.0, 0.0, 2.569056078982612e-13, 8.903988657493755e-14, 3.33510996597397e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 9.259260025373806e-14, 1.7386092565629951e-13, 2.220446049250313e-16, 4.0745185003743245e-13, 1.7741363933510002e-13, 3.850253449400043e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.483879851273741e-13, 2.220446049250313e-16, 2.731148640577885e-13, 4.050093593832571e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, -2.220446049250313e-16, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 1.1790568521519162e-13, -3.3306690738754696e-16, 1.6076029396572267e-13, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, -3.3306690738754696e-16, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, 1.5565326805244695e-13, 2.220446049250313e-16, 2.220446049250313e-16, 1.9895196601282805e-13, 0.0, 1.6542323066914832e-13, 1.2811973704174306e-13, -3.3306690738754696e-16, 1.2234657731369225e-13, 2.220446049250313e-16, 0.0, 8.060219158778636e-14, 0.0, 0.0, 1.4011014570769476e-13, 0.0, 2.615685446016869e-13, 0.0, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16], "episode_lengths": [1026, 1027, 1026, 1026, 1026, 1026, 2005, 1027, 1026, 1026, 1537, 1026, 1026, 1023, 1024, 2050, 1024, 1024, 45, 1538, 2050, 1538, 1024, 1538, 513, 2050, 1024, 1024, 1024, 1536, 1024, 1024, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 2048, 1024, 1536, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1775, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 1024, 273, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 1024, 2047, 1988, 1024, 1024, 2048, 1024, 1024, 2048, 1024, 1025, 2049, 1536, 1588, 61, 1024], "policy_default_policy_reward": [0.0, 0.0, 304.0, -304.0, 678.1154031579039, -104.65180361560927, -573.4635995422934, -359.7276934780741, -255.72769347806906, 1289.261626873353, -673.8062399172434, 253.14422766478543, -712.0565286548579, 458.91230099007186, 641.0, -641.0, -1422.0, 1422.0, 218.0, -218.0, 476.0, -476.0, -491.0, 491.0, -853.0, 853.0, 184.55486988968912, -180.31222920257045, -4.242640687119216, -847.0614872174385, 722.3538290724795, 722.3538290724795, -597.6461709275205, 405.17218561989387, 324.5620125646261, -729.7341981845217, 106.77312395916894, 106.77312395916894, -213.54624791833785, 1899.0, -1899.0, -738.5559337179743, 594.2183664205663, -523.7816335794337, 668.119200876838, 649.1240251292546, -4.242640687119268, -644.8813844421359, 0.0, 0.0, 0.0, 1071.2667734976521, -150.6137443927355, -920.6530291048914, 600.0, -600.0, -1116.0, 1116.0, -235.0, 235.0, -1428.3556979968134, 423.34375849514817, 1005.0119395016877, 283.5498192558072, -567.0996385116144, 283.5498192558072, -1670.1862171625644, 1516.0369388639695, 154.14927829866792, -499.0, 499.0, 294.3405434088003, -182.33459118601218, -420.2029020921448, 308.1969498693484, 0.0, 0.0, -736.3199243042488, -891.0497964470759, -440.31992430423475, 2067.689645055477, 294.8635277547921, -589.7270555095841, 294.8635277547921, -578.4133470106, 1082.5804819966118, -504.16713498601183, -974.5339333953345, 3122.2769347808007, -1023.09799800084, -1124.6450033846172, -1215.5165568596535, 2199.809196271341, -984.2926394116821, -403.7579720575213, 98.99494936611657, 304.7630226914033, -1223.2947314527044, -1227.537372139823, 2450.8321035925273, 0.0, 0.0, 647.0, -647.0, -479.0, 479.0, 1189.1023553302919, -754.9349528997182, 209.9162987846923, -644.0837012153099, -1354.5840533340604, 2377.7675657110026, -1023.1835123769418, -819.801085141098, -42.760217028216225, -244.76021702821623, 1107.3215191975069, 545.8864350760184, 53.74011537017761, -599.6265504461965, -1022.4764055957553, 207.88939366884597, 814.5870119269081, -79.0, 79.0, 1794.0, -1794.0, -896.1814855409405, -1582.07360533816, 636.3738644055659, 1841.881226473496, 813.0, -813.0, -345.6810868176027, -601.1733546534007, 1402.5355282885694, -455.6810868176078, 908.9668926783794, -896.2651867562547, -823.7899781421679, 811.0882722199735, 2689.093056899892, -1339.2481275344699, -1498.5968018307753, 148.75187246547335, -768.0, 768.0, 0.0, 0.0, -982.95280956808, 1273.9373452396255, -38.407769173858114, -252.57676649774675, 1081.7899781421434, -1334.6693960471853, 522.0890696665969, -269.2096517615687, -1457.377637963565, -1418.1178196586782, 475.8821803412443, 2399.6132772811134, 1493.0, -1493.0, 0.0, 0.0, 358.50313806158186, -742.4621202458796, 383.9589821842978, -330.6892177051387, -247.55077894182895, 1119.3496854181553, -541.1096887712093, -656.1950929411202, -223.4457428549502, 879.6408357960715, -855.0571298879464, 594.0948082142238, -358.5358983848671, 619.4982200585677, 365.0, -365.0, -1102.798109029693, 497.08529610858255, -635.6493607141073, 1241.3621736352038, -840.0, 840.0, 514.2693304105163, 2274.032950900516, -1546.5716117215188, -1241.7306695894408, -875.0, 875.0, -252.8712870175201, 421.4738273959373, 1699.7110616066993, -1868.3136019850501, 345.3413408554502, -1432.8974882485816, 614.2148065377182, 473.3413408554502, 0.0, 0.0, -629.3258765270219, -632.7618119215373, -1259.6352776037938, 2521.7229660522994, 183.14065632731626, 134.35028842544395, -317.4909447527618, -759.0289636673123, -1137.7707402556837, 56.97103633269754, 1839.8286675902427, -1470.6791218279868, 2854.0103668064353, -554.6656224891848, -828.6656224891962, 728.3199846221491, -1172.3830432072887, 444.06305858515475, -647.0, 647.0, -584.0702012600918, -412.2432534317599, 996.3134546918523, 471.6402230514304, 280.721392131061, -752.3616151824914, -41.942286340601036, -425.3028650825172, 966.8574175823729, -499.612266159279, -135.7645019878176, 604.5762979145019, -468.81179592668354, -859.3242816337267, 671.1080938779087, -482.8919061220913, 671.1080938779087, 989.0, -989.0, 256.6797615707182, 256.6797615707182, -513.3595231414364, 712.0, -712.0, 1150.0, -1150.0, -799.0306627408039, 259.5081886954644, 539.5224740453394, 278.0, -278.0, -781.3529932111406, 497.80317395533194, 283.5498192558066, 231.0, -231.0, 981.9032267962001, -50.39905451484528, -612.3990545148599, -319.1051177665254, -571.6041352717459, 2400.6497880644743, -437.60413527174006, -1391.4415175209601, -557.1422123213497, -654.1370575452116, 1350.4214821878775, -139.1422123213444, 474.0, -474.0, -566.0, 566.0, 1639.9752372410926, -152.11999832348468, -869.7899781421761, -618.0652607754921, 1242.0, -1242.0, 0.0, 0.0, -101.86533479473131, -767.6241706048606, 1054.4932789576046, -185.00377355803698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.30686886869431, "mean_inference_ms": 3.7551893886805634, "mean_action_processing_ms": 0.735574893760427, "mean_env_wait_ms": 26.131850901571035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015620796047911351, "StateBufferConnector_ms": 0.012381709351831553, "ViewRequirementAgentConnector_ms": 0.5061271239300164}, "num_episodes": 12, "episode_return_max": 4.0745185003743245e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 5.69804974179301e-14, "episodes_this_iter": 12}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594284, "num_agent_steps_trained": 112698, "num_env_steps_sampled": 198144, "num_env_steps_trained": 112698, "num_env_steps_sampled_this_iter": 24576, "num_env_steps_trained_this_iter": 14992, "num_env_steps_sampled_throughput_per_sec": 2457.5768556867124, "num_env_steps_trained_throughput_per_sec": 1499.1858813661781, "timesteps_total": 198144, "num_env_steps_sampled_lifetime": 198144, "num_agent_steps_sampled_lifetime": 594284, "num_steps_trained_this_iter": 14992, "agent_timesteps_total": 594284, "timers": {"training_iteration_time_ms": 10000.076, "restore_workers_time_ms": 0.005, "training_step_time_ms": 0.138, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 198144, "num_env_steps_trained": 112698, "num_agent_steps_sampled": 594284, "num_agent_steps_trained": 112698, "num_training_step_calls_since_last_synch_worker_weights": 5595, "num_samples_added_to_queue": 35328, "num_times_learner_queue_full": 318, "num_weight_broadcasts": 43}, "done": false, "training_iteration": 9, "trial_id": "6466c_00000", "date": "2024-09-02_13-57-39", "timestamp": 1725253059, "time_this_iter_s": 70.00931406021118, "time_total_s": 630.0954868793488, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 630.0954868793488, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.18484848484849, "ram_util_percent": 43.357575757575766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -5181.697265625, "policy_loss": -5929.19189453125, "entropy": 12.905532836914062, "entropy_coeff": 0.01, "var_gnorm": 2048.275146484375, "vf_loss": 1561.0654296875, "vf_explained_var": 0.0013866424560546875}, "model": {}, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 223232, "num_env_steps_trained": 126516, "num_agent_steps_sampled": 666346, "num_agent_steps_trained": 126516, "num_training_step_calls_since_last_synch_worker_weights": 16643, "num_samples_added_to_queue": 39936, "num_times_learner_queue_full": 358, "num_weight_broadcasts": 48, "learner_queue": {"size_count": 78, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 45.854, "learner_load_time_ms": 111.795, "learner_load_wait_time_ms": 6968.631, "learner_dequeue_time_ms": 62859.826}}, "env_runners": {"episode_reward_max": 4.1522341120980855e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 6.502798299834467e-14, "episode_len_mean": 1424.01, "episode_media": {}, "episodes_timesteps_total": 142401, "policy_reward_min": {"default_policy": -2247.8924573920517}, "policy_reward_max": {"default_policy": 3122.2769347808007}, "policy_reward_mean": {"default_policy": -2.8172899852898785e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 1.432187701766452e-13, 2.220446049250313e-16, 2.036149027162537e-13, 3.352873534367973e-14, 0.0, 2.220446049250313e-16, 1.4876988529977098e-13, 0.0, 2.751132655021138e-13, 0.0, 0.0, 0.0, 2.569056078982612e-13, 8.903988657493755e-14, 3.33510996597397e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 9.259260025373806e-14, 1.7386092565629951e-13, 2.220446049250313e-16, 4.0745185003743245e-13, 1.7741363933510002e-13, 3.850253449400043e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.483879851273741e-13, 2.220446049250313e-16, 2.731148640577885e-13, 4.050093593832571e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, -2.220446049250313e-16, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 1.1790568521519162e-13, -3.3306690738754696e-16, 1.6076029396572267e-13, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, -3.3306690738754696e-16, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, 1.5565326805244695e-13, 2.220446049250313e-16, 2.220446049250313e-16, 1.9895196601282805e-13, 0.0, 1.6542323066914832e-13, 1.2811973704174306e-13, -3.3306690738754696e-16, 1.2234657731369225e-13, 2.220446049250313e-16, 0.0, 8.060219158778636e-14, 0.0, 0.0, 1.4011014570769476e-13, 0.0, 2.615685446016869e-13, 0.0, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 3.934630399271555e-13, 0.0, 3.494982081519993e-13, 6.372680161348399e-14, 4.1522341120980855e-13], "episode_lengths": [1026, 1537, 1026, 1026, 1023, 1024, 2050, 1024, 1024, 45, 1538, 2050, 1538, 1024, 1538, 513, 2050, 1024, 1024, 1024, 1536, 1024, 1024, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 2048, 1024, 1536, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1775, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 1024, 273, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 1024, 2047, 1988, 1024, 1024, 2048, 1024, 1024, 2048, 1024, 1025, 2049, 1536, 1588, 61, 1024, 1024, 2048, 1024, 1536, 1536, 2048, 2048, 2048, 2047, 460, 2048], "policy_default_policy_reward": [-491.0, 491.0, -853.0, 853.0, 184.55486988968912, -180.31222920257045, -4.242640687119216, -847.0614872174385, 722.3538290724795, 722.3538290724795, -597.6461709275205, 405.17218561989387, 324.5620125646261, -729.7341981845217, 106.77312395916894, 106.77312395916894, -213.54624791833785, 1899.0, -1899.0, -738.5559337179743, 594.2183664205663, -523.7816335794337, 668.119200876838, 649.1240251292546, -4.242640687119268, -644.8813844421359, 0.0, 0.0, 0.0, 1071.2667734976521, -150.6137443927355, -920.6530291048914, 600.0, -600.0, -1116.0, 1116.0, -235.0, 235.0, -1428.3556979968134, 423.34375849514817, 1005.0119395016877, 283.5498192558072, -567.0996385116144, 283.5498192558072, -1670.1862171625644, 1516.0369388639695, 154.14927829866792, -499.0, 499.0, 294.3405434088003, -182.33459118601218, -420.2029020921448, 308.1969498693484, 0.0, 0.0, -736.3199243042488, -891.0497964470759, -440.31992430423475, 2067.689645055477, 294.8635277547921, -589.7270555095841, 294.8635277547921, -578.4133470106, 1082.5804819966118, -504.16713498601183, -974.5339333953345, 3122.2769347808007, -1023.09799800084, -1124.6450033846172, -1215.5165568596535, 2199.809196271341, -984.2926394116821, -403.7579720575213, 98.99494936611657, 304.7630226914033, -1223.2947314527044, -1227.537372139823, 2450.8321035925273, 0.0, 0.0, 647.0, -647.0, -479.0, 479.0, 1189.1023553302919, -754.9349528997182, 209.9162987846923, -644.0837012153099, -1354.5840533340604, 2377.7675657110026, -1023.1835123769418, -819.801085141098, -42.760217028216225, -244.76021702821623, 1107.3215191975069, 545.8864350760184, 53.74011537017761, -599.6265504461965, -1022.4764055957553, 207.88939366884597, 814.5870119269081, -79.0, 79.0, 1794.0, -1794.0, -896.1814855409405, -1582.07360533816, 636.3738644055659, 1841.881226473496, 813.0, -813.0, -345.6810868176027, -601.1733546534007, 1402.5355282885694, -455.6810868176078, 908.9668926783794, -896.2651867562547, -823.7899781421679, 811.0882722199735, 2689.093056899892, -1339.2481275344699, -1498.5968018307753, 148.75187246547335, -768.0, 768.0, 0.0, 0.0, -982.95280956808, 1273.9373452396255, -38.407769173858114, -252.57676649774675, 1081.7899781421434, -1334.6693960471853, 522.0890696665969, -269.2096517615687, -1457.377637963565, -1418.1178196586782, 475.8821803412443, 2399.6132772811134, 1493.0, -1493.0, 0.0, 0.0, 358.50313806158186, -742.4621202458796, 383.9589821842978, -330.6892177051387, -247.55077894182895, 1119.3496854181553, -541.1096887712093, -656.1950929411202, -223.4457428549502, 879.6408357960715, -855.0571298879464, 594.0948082142238, -358.5358983848671, 619.4982200585677, 365.0, -365.0, -1102.798109029693, 497.08529610858255, -635.6493607141073, 1241.3621736352038, -840.0, 840.0, 514.2693304105163, 2274.032950900516, -1546.5716117215188, -1241.7306695894408, -875.0, 875.0, -252.8712870175201, 421.4738273959373, 1699.7110616066993, -1868.3136019850501, 345.3413408554502, -1432.8974882485816, 614.2148065377182, 473.3413408554502, 0.0, 0.0, -629.3258765270219, -632.7618119215373, -1259.6352776037938, 2521.7229660522994, 183.14065632731626, 134.35028842544395, -317.4909447527618, -759.0289636673123, -1137.7707402556837, 56.97103633269754, 1839.8286675902427, -1470.6791218279868, 2854.0103668064353, -554.6656224891848, -828.6656224891962, 728.3199846221491, -1172.3830432072887, 444.06305858515475, -647.0, 647.0, -584.0702012600918, -412.2432534317599, 996.3134546918523, 471.6402230514304, 280.721392131061, -752.3616151824914, -41.942286340601036, -425.3028650825172, 966.8574175823729, -499.612266159279, -135.7645019878176, 604.5762979145019, -468.81179592668354, -859.3242816337267, 671.1080938779087, -482.8919061220913, 671.1080938779087, 989.0, -989.0, 256.6797615707182, 256.6797615707182, -513.3595231414364, 712.0, -712.0, 1150.0, -1150.0, -799.0306627408039, 259.5081886954644, 539.5224740453394, 278.0, -278.0, -781.3529932111406, 497.80317395533194, 283.5498192558066, 231.0, -231.0, 981.9032267962001, -50.39905451484528, -612.3990545148599, -319.1051177665254, -571.6041352717459, 2400.6497880644743, -437.60413527174006, -1391.4415175209601, -557.1422123213497, -654.1370575452116, 1350.4214821878775, -139.1422123213444, 474.0, -474.0, -566.0, 566.0, 1639.9752372410926, -152.11999832348468, -869.7899781421761, -618.0652607754921, 1242.0, -1242.0, 0.0, 0.0, -101.86533479473131, -767.6241706048606, 1054.4932789576046, -185.00377355803698, 0.0, 0.0, -1309.1467833260203, -804.4716487312256, 1951.249138656332, 162.36929340089324, 40.393102292056795, 398.39310229205535, -957.2681628676139, 518.4819582834996, 797.2082705434617, -888.6545154902565, 103.45814939234495, -12.011904445576999, 1200.0, -1200.0, -1263.0, 1263.0, 2432.4940084759182, -956.0083681642193, -1476.4856403116867, 1025.0, -1025.0, -1028.840366626433, -1007.6271631908377, 2036.4675298172724, 267.99347006970305, 72.83199846221439, -340.8254685319174, 955.3012613830327, 1292.5911960090414, -2247.8924573920517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.998750610496828, "mean_inference_ms": 3.7669645039165793, "mean_action_processing_ms": 0.7433916752987899, "mean_env_wait_ms": 25.32486240363967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01564192771911621, "StateBufferConnector_ms": 0.012550830841064453, "ViewRequirementAgentConnector_ms": 0.5138978958129883}, "num_episodes": 11, "episode_return_max": 4.1522341120980855e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 6.502798299834467e-14, "episodes_this_iter": 11}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666346, "num_agent_steps_trained": 126516, "num_env_steps_sampled": 223232, "num_env_steps_trained": 126516, "num_env_steps_sampled_this_iter": 25088, "num_env_steps_trained_this_iter": 13818, "num_env_steps_sampled_throughput_per_sec": 2508.791865260752, "num_env_steps_trained_throughput_per_sec": 1381.7955195381485, "timesteps_total": 223232, "num_env_steps_sampled_lifetime": 223232, "num_agent_steps_sampled_lifetime": 666346, "num_steps_trained_this_iter": 13818, "agent_timesteps_total": 666346, "timers": {"training_iteration_time_ms": 10000.073, "restore_workers_time_ms": 0.007, "training_step_time_ms": 0.164, "sample_time_ms": 0.115, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 223232, "num_env_steps_trained": 126516, "num_agent_steps_sampled": 666346, "num_agent_steps_trained": 126516, "num_training_step_calls_since_last_synch_worker_weights": 16643, "num_samples_added_to_queue": 39936, "num_times_learner_queue_full": 358, "num_weight_broadcasts": 48}, "done": false, "training_iteration": 10, "trial_id": "6466c_00000", "date": "2024-09-02_13-58-49", "timestamp": 1725253129, "time_this_iter_s": 70.00921154022217, "time_total_s": 700.1046984195709, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 700.1046984195709, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 33.521, "ram_util_percent": 43.332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -3323.488525390625, "policy_loss": -3357.78662109375, "entropy": 14.561481475830078, "entropy_coeff": 0.01, "var_gnorm": 2048.275146484375, "vf_loss": 143.15078735351562, "vf_explained_var": -0.010283827781677246}, "model": {}, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 247808, "num_env_steps_trained": 143916, "num_agent_steps_sampled": 740122, "num_agent_steps_trained": 143916, "num_training_step_calls_since_last_synch_worker_weights": 2354, "num_samples_added_to_queue": 45056, "num_times_learner_queue_full": 396, "num_weight_broadcasts": 53, "learner_queue": {"size_count": 88, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.78, "learner_load_time_ms": 107.358, "learner_load_wait_time_ms": 7198.448, "learner_dequeue_time_ms": 62631.031}}, "env_runners": {"episode_reward_max": 4.1522341120980855e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 6.367351090830198e-14, "episode_len_mean": 1454.14, "episode_media": {}, "episodes_timesteps_total": 145414, "policy_reward_min": {"default_policy": -2247.8924573920517}, "policy_reward_max": {"default_policy": 3122.2769347808007}, "policy_reward_mean": {"default_policy": -5.772382198121111e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 2.569056078982612e-13, 8.903988657493755e-14, 3.33510996597397e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 9.259260025373806e-14, 1.7386092565629951e-13, 2.220446049250313e-16, 4.0745185003743245e-13, 1.7741363933510002e-13, 3.850253449400043e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.483879851273741e-13, 2.220446049250313e-16, 2.731148640577885e-13, 4.050093593832571e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, -2.220446049250313e-16, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 1.1790568521519162e-13, -3.3306690738754696e-16, 1.6076029396572267e-13, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, -3.3306690738754696e-16, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, 1.5565326805244695e-13, 2.220446049250313e-16, 2.220446049250313e-16, 1.9895196601282805e-13, 0.0, 1.6542323066914832e-13, 1.2811973704174306e-13, -3.3306690738754696e-16, 1.2234657731369225e-13, 2.220446049250313e-16, 0.0, 8.060219158778636e-14, 0.0, 0.0, 1.4011014570769476e-13, 0.0, 2.615685446016869e-13, 0.0, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 3.934630399271555e-13, 0.0, 3.494982081519993e-13, 6.372680161348399e-14, 4.1522341120980855e-13, 3.9879211044535623e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 2.7000623958883807e-13, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0], "episode_lengths": [1024, 1538, 513, 2050, 1024, 1024, 1024, 1536, 1024, 1024, 2048, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 2048, 1024, 1536, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1775, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 1024, 273, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 1024, 2047, 1988, 1024, 1024, 2048, 1024, 1024, 2048, 1024, 1025, 2049, 1536, 1588, 61, 1024, 1024, 2048, 1024, 1536, 1536, 2048, 2048, 2048, 2047, 460, 2048, 2048, 2048, 1024, 2048, 1024, 2048, 1536, 1024, 2047, 1024, 1024, 1024, 1025], "policy_default_policy_reward": [-235.0, 235.0, -1428.3556979968134, 423.34375849514817, 1005.0119395016877, 283.5498192558072, -567.0996385116144, 283.5498192558072, -1670.1862171625644, 1516.0369388639695, 154.14927829866792, -499.0, 499.0, 294.3405434088003, -182.33459118601218, -420.2029020921448, 308.1969498693484, 0.0, 0.0, -736.3199243042488, -891.0497964470759, -440.31992430423475, 2067.689645055477, 294.8635277547921, -589.7270555095841, 294.8635277547921, -578.4133470106, 1082.5804819966118, -504.16713498601183, -974.5339333953345, 3122.2769347808007, -1023.09799800084, -1124.6450033846172, -1215.5165568596535, 2199.809196271341, -984.2926394116821, -403.7579720575213, 98.99494936611657, 304.7630226914033, -1223.2947314527044, -1227.537372139823, 2450.8321035925273, 0.0, 0.0, 647.0, -647.0, -479.0, 479.0, 1189.1023553302919, -754.9349528997182, 209.9162987846923, -644.0837012153099, -1354.5840533340604, 2377.7675657110026, -1023.1835123769418, -819.801085141098, -42.760217028216225, -244.76021702821623, 1107.3215191975069, 545.8864350760184, 53.74011537017761, -599.6265504461965, -1022.4764055957553, 207.88939366884597, 814.5870119269081, -79.0, 79.0, 1794.0, -1794.0, -896.1814855409405, -1582.07360533816, 636.3738644055659, 1841.881226473496, 813.0, -813.0, -345.6810868176027, -601.1733546534007, 1402.5355282885694, -455.6810868176078, 908.9668926783794, -896.2651867562547, -823.7899781421679, 811.0882722199735, 2689.093056899892, -1339.2481275344699, -1498.5968018307753, 148.75187246547335, -768.0, 768.0, 0.0, 0.0, -982.95280956808, 1273.9373452396255, -38.407769173858114, -252.57676649774675, 1081.7899781421434, -1334.6693960471853, 522.0890696665969, -269.2096517615687, -1457.377637963565, -1418.1178196586782, 475.8821803412443, 2399.6132772811134, 1493.0, -1493.0, 0.0, 0.0, 358.50313806158186, -742.4621202458796, 383.9589821842978, -330.6892177051387, -247.55077894182895, 1119.3496854181553, -541.1096887712093, -656.1950929411202, -223.4457428549502, 879.6408357960715, -855.0571298879464, 594.0948082142238, -358.5358983848671, 619.4982200585677, 365.0, -365.0, -1102.798109029693, 497.08529610858255, -635.6493607141073, 1241.3621736352038, -840.0, 840.0, 514.2693304105163, 2274.032950900516, -1546.5716117215188, -1241.7306695894408, -875.0, 875.0, -252.8712870175201, 421.4738273959373, 1699.7110616066993, -1868.3136019850501, 345.3413408554502, -1432.8974882485816, 614.2148065377182, 473.3413408554502, 0.0, 0.0, -629.3258765270219, -632.7618119215373, -1259.6352776037938, 2521.7229660522994, 183.14065632731626, 134.35028842544395, -317.4909447527618, -759.0289636673123, -1137.7707402556837, 56.97103633269754, 1839.8286675902427, -1470.6791218279868, 2854.0103668064353, -554.6656224891848, -828.6656224891962, 728.3199846221491, -1172.3830432072887, 444.06305858515475, -647.0, 647.0, -584.0702012600918, -412.2432534317599, 996.3134546918523, 471.6402230514304, 280.721392131061, -752.3616151824914, -41.942286340601036, -425.3028650825172, 966.8574175823729, -499.612266159279, -135.7645019878176, 604.5762979145019, -468.81179592668354, -859.3242816337267, 671.1080938779087, -482.8919061220913, 671.1080938779087, 989.0, -989.0, 256.6797615707182, 256.6797615707182, -513.3595231414364, 712.0, -712.0, 1150.0, -1150.0, -799.0306627408039, 259.5081886954644, 539.5224740453394, 278.0, -278.0, -781.3529932111406, 497.80317395533194, 283.5498192558066, 231.0, -231.0, 981.9032267962001, -50.39905451484528, -612.3990545148599, -319.1051177665254, -571.6041352717459, 2400.6497880644743, -437.60413527174006, -1391.4415175209601, -557.1422123213497, -654.1370575452116, 1350.4214821878775, -139.1422123213444, 474.0, -474.0, -566.0, 566.0, 1639.9752372410926, -152.11999832348468, -869.7899781421761, -618.0652607754921, 1242.0, -1242.0, 0.0, 0.0, -101.86533479473131, -767.6241706048606, 1054.4932789576046, -185.00377355803698, 0.0, 0.0, -1309.1467833260203, -804.4716487312256, 1951.249138656332, 162.36929340089324, 40.393102292056795, 398.39310229205535, -957.2681628676139, 518.4819582834996, 797.2082705434617, -888.6545154902565, 103.45814939234495, -12.011904445576999, 1200.0, -1200.0, -1263.0, 1263.0, 2432.4940084759182, -956.0083681642193, -1476.4856403116867, 1025.0, -1025.0, -1028.840366626433, -1007.6271631908377, 2036.4675298172724, 267.99347006970305, 72.83199846221439, -340.8254685319174, 955.3012613830327, 1292.5911960090414, -2247.8924573920517, -1228.9515857021959, 2519.421461367612, -1290.4698756654163, 216.0, -216.0, 748.0, -748.0, -1216.4236608526433, 729.1400336566109, -1202.5672543920944, 1689.8508815881107, -783.0, 783.0, -1358.7808793787476, 2321.153208573646, -962.3723291948977, -712.6182183820705, 628.3250790803709, 854.6463846027038, -770.3532453010358, -691.3562214124252, -88.60254037844358, -84.60254037844358, 864.5613021692948, 792.0, -792.0, 0.0, 0.0, -231.0, 231.0, 737.3348048611948, -123.03411844343415, -438.150343208888, -176.15034320887943, 322.0, -322.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.985266955009873, "mean_inference_ms": 3.7820233485522237, "mean_action_processing_ms": 0.7529400497583576, "mean_env_wait_ms": 23.88334269139992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015462875366210938, "StateBufferConnector_ms": 0.012582778930664062, "ViewRequirementAgentConnector_ms": 0.5156214237213135}, "num_episodes": 13, "episode_return_max": 4.1522341120980855e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 6.367351090830198e-14, "episodes_this_iter": 13}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 740122, "num_agent_steps_trained": 143916, "num_env_steps_sampled": 247808, "num_env_steps_trained": 143916, "num_env_steps_sampled_this_iter": 24576, "num_env_steps_trained_this_iter": 17400, "num_env_steps_sampled_throughput_per_sec": 2457.570996436042, "num_env_steps_trained_throughput_per_sec": 1739.9794652501273, "timesteps_total": 247808, "num_env_steps_sampled_lifetime": 247808, "num_agent_steps_sampled_lifetime": 740122, "num_steps_trained_this_iter": 17400, "agent_timesteps_total": 740122, "timers": {"training_iteration_time_ms": 10000.079, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.138, "sample_time_ms": 0.099, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 247808, "num_env_steps_trained": 143916, "num_agent_steps_sampled": 740122, "num_agent_steps_trained": 143916, "num_training_step_calls_since_last_synch_worker_weights": 2354, "num_samples_added_to_queue": 45056, "num_times_learner_queue_full": 396, "num_weight_broadcasts": 53}, "done": false, "training_iteration": 11, "trial_id": "6466c_00000", "date": "2024-09-02_13-59-59", "timestamp": 1725253199, "time_this_iter_s": 70.0295922756195, "time_total_s": 770.1342906951904, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 770.1342906951904, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.57575757575758, "ram_util_percent": 43.795959595959594}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -276.4093933105469, "policy_loss": -243.79669189453125, "entropy": 12.941104888916016, "entropy_coeff": 0.01, "var_gnorm": 2048.275390625, "vf_loss": 1.0330458879470825, "vf_explained_var": -0.0930413007736206}, "model": {}, "num_grad_updates_lifetime": 96.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 273408, "num_env_steps_trained": 155692, "num_agent_steps_sampled": 814814, "num_agent_steps_trained": 155692, "num_training_step_calls_since_last_synch_worker_weights": 15646, "num_samples_added_to_queue": 49152, "num_times_learner_queue_full": 438, "num_weight_broadcasts": 58, "learner_queue": {"size_count": 96, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.3, "learner_load_time_ms": 117.22, "learner_load_wait_time_ms": 7402.577, "learner_dequeue_time_ms": 69298.437}}, "env_runners": {"episode_reward_max": 4.18554080283684e-13, "episode_reward_min": -6.661338147750939e-16, "episode_reward_mean": 6.637801419628886e-14, "episode_len_mean": 1479.69, "episode_media": {}, "episodes_timesteps_total": 147969, "policy_reward_min": {"default_policy": -2634.6798667010016}, "policy_reward_max": {"default_policy": 3116.3013274434006}, "policy_reward_mean": {"default_policy": -7.652879076159791e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0745185003743245e-13, 1.7741363933510002e-13, 3.850253449400043e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.483879851273741e-13, 2.220446049250313e-16, 2.731148640577885e-13, 4.050093593832571e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, -2.220446049250313e-16, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 1.1790568521519162e-13, -3.3306690738754696e-16, 1.6076029396572267e-13, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, -3.3306690738754696e-16, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, 1.5565326805244695e-13, 2.220446049250313e-16, 2.220446049250313e-16, 1.9895196601282805e-13, 0.0, 1.6542323066914832e-13, 1.2811973704174306e-13, -3.3306690738754696e-16, 1.2234657731369225e-13, 2.220446049250313e-16, 0.0, 8.060219158778636e-14, 0.0, 0.0, 1.4011014570769476e-13, 0.0, 2.615685446016869e-13, 0.0, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 3.934630399271555e-13, 0.0, 3.494982081519993e-13, 6.372680161348399e-14, 4.1522341120980855e-13, 3.9879211044535623e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 2.7000623958883807e-13, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 4.18554080283684e-13, 2.0605739337042905e-13, 0.0, 0.0, -6.661338147750939e-16, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 1.7918999617450027e-13, 4.1366909897533333e-13, 2.220446049250313e-16], "episode_lengths": [2048, 1024, 2048, 1024, 2048, 1024, 1024, 2048, 1024, 2048, 2048, 1024, 2048, 2048, 1024, 1536, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1775, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 1024, 273, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 1024, 2047, 1988, 1024, 1024, 2048, 1024, 1024, 2048, 1024, 1025, 2049, 1536, 1588, 61, 1024, 1024, 2048, 1024, 1536, 1536, 2048, 2048, 2048, 2047, 460, 2048, 2048, 2048, 1024, 2048, 1024, 2048, 1536, 1024, 2047, 1024, 1024, 1024, 1025, 2048, 1024, 1024, 1024, 1536, 2048, 1536, 1024, 1024, 2048, 2048], "policy_default_policy_reward": [-1215.5165568596535, 2199.809196271341, -984.2926394116821, -403.7579720575213, 98.99494936611657, 304.7630226914033, -1223.2947314527044, -1227.537372139823, 2450.8321035925273, 0.0, 0.0, 647.0, -647.0, -479.0, 479.0, 1189.1023553302919, -754.9349528997182, 209.9162987846923, -644.0837012153099, -1354.5840533340604, 2377.7675657110026, -1023.1835123769418, -819.801085141098, -42.760217028216225, -244.76021702821623, 1107.3215191975069, 545.8864350760184, 53.74011537017761, -599.6265504461965, -1022.4764055957553, 207.88939366884597, 814.5870119269081, -79.0, 79.0, 1794.0, -1794.0, -896.1814855409405, -1582.07360533816, 636.3738644055659, 1841.881226473496, 813.0, -813.0, -345.6810868176027, -601.1733546534007, 1402.5355282885694, -455.6810868176078, 908.9668926783794, -896.2651867562547, -823.7899781421679, 811.0882722199735, 2689.093056899892, -1339.2481275344699, -1498.5968018307753, 148.75187246547335, -768.0, 768.0, 0.0, 0.0, -982.95280956808, 1273.9373452396255, -38.407769173858114, -252.57676649774675, 1081.7899781421434, -1334.6693960471853, 522.0890696665969, -269.2096517615687, -1457.377637963565, -1418.1178196586782, 475.8821803412443, 2399.6132772811134, 1493.0, -1493.0, 0.0, 0.0, 358.50313806158186, -742.4621202458796, 383.9589821842978, -330.6892177051387, -247.55077894182895, 1119.3496854181553, -541.1096887712093, -656.1950929411202, -223.4457428549502, 879.6408357960715, -855.0571298879464, 594.0948082142238, -358.5358983848671, 619.4982200585677, 365.0, -365.0, -1102.798109029693, 497.08529610858255, -635.6493607141073, 1241.3621736352038, -840.0, 840.0, 514.2693304105163, 2274.032950900516, -1546.5716117215188, -1241.7306695894408, -875.0, 875.0, -252.8712870175201, 421.4738273959373, 1699.7110616066993, -1868.3136019850501, 345.3413408554502, -1432.8974882485816, 614.2148065377182, 473.3413408554502, 0.0, 0.0, -629.3258765270219, -632.7618119215373, -1259.6352776037938, 2521.7229660522994, 183.14065632731626, 134.35028842544395, -317.4909447527618, -759.0289636673123, -1137.7707402556837, 56.97103633269754, 1839.8286675902427, -1470.6791218279868, 2854.0103668064353, -554.6656224891848, -828.6656224891962, 728.3199846221491, -1172.3830432072887, 444.06305858515475, -647.0, 647.0, -584.0702012600918, -412.2432534317599, 996.3134546918523, 471.6402230514304, 280.721392131061, -752.3616151824914, -41.942286340601036, -425.3028650825172, 966.8574175823729, -499.612266159279, -135.7645019878176, 604.5762979145019, -468.81179592668354, -859.3242816337267, 671.1080938779087, -482.8919061220913, 671.1080938779087, 989.0, -989.0, 256.6797615707182, 256.6797615707182, -513.3595231414364, 712.0, -712.0, 1150.0, -1150.0, -799.0306627408039, 259.5081886954644, 539.5224740453394, 278.0, -278.0, -781.3529932111406, 497.80317395533194, 283.5498192558066, 231.0, -231.0, 981.9032267962001, -50.39905451484528, -612.3990545148599, -319.1051177665254, -571.6041352717459, 2400.6497880644743, -437.60413527174006, -1391.4415175209601, -557.1422123213497, -654.1370575452116, 1350.4214821878775, -139.1422123213444, 474.0, -474.0, -566.0, 566.0, 1639.9752372410926, -152.11999832348468, -869.7899781421761, -618.0652607754921, 1242.0, -1242.0, 0.0, 0.0, -101.86533479473131, -767.6241706048606, 1054.4932789576046, -185.00377355803698, 0.0, 0.0, -1309.1467833260203, -804.4716487312256, 1951.249138656332, 162.36929340089324, 40.393102292056795, 398.39310229205535, -957.2681628676139, 518.4819582834996, 797.2082705434617, -888.6545154902565, 103.45814939234495, -12.011904445576999, 1200.0, -1200.0, -1263.0, 1263.0, 2432.4940084759182, -956.0083681642193, -1476.4856403116867, 1025.0, -1025.0, -1028.840366626433, -1007.6271631908377, 2036.4675298172724, 267.99347006970305, 72.83199846221439, -340.8254685319174, 955.3012613830327, 1292.5911960090414, -2247.8924573920517, -1228.9515857021959, 2519.421461367612, -1290.4698756654163, 216.0, -216.0, 748.0, -748.0, -1216.4236608526433, 729.1400336566109, -1202.5672543920944, 1689.8508815881107, -783.0, 783.0, -1358.7808793787476, 2321.153208573646, -962.3723291948977, -712.6182183820705, 628.3250790803709, 854.6463846027038, -770.3532453010358, -691.3562214124252, -88.60254037844358, -84.60254037844358, 864.5613021692948, 792.0, -792.0, 0.0, 0.0, -231.0, 231.0, 737.3348048611948, -123.03411844343415, -438.150343208888, -176.15034320887943, 322.0, -322.0, 619.42554031942, 1620.6887424795866, -2240.1142827989925, 656.1950929411207, 656.1950929411207, -1312.3901858822414, 283.0, -283.0, 0.0, 0.0, -728.2651867562413, -224.81575202287567, 348.3687096294443, 604.712229149617, 3116.3013274434006, -1117.5146955088494, -793.5146955088521, -1205.2719364256595, 1981.9050353646492, -403.70627692685935, -569.7062769268674, -1008.4924815109964, 566.0, -566.0, 724.7844507162164, 24.748737341528575, -749.5331880577452, 1317.3399333505008, 1317.3399333505008, -2634.6798667010016, -725.1245693281855, -1355.6458008312202, 939.9536070147558, 1140.8167631446825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.50392373108989, "mean_inference_ms": 3.7923044223470725, "mean_action_processing_ms": 0.7580986187583045, "mean_env_wait_ms": 23.165082086587322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015485048294067383, "StateBufferConnector_ms": 0.012629032135009766, "ViewRequirementAgentConnector_ms": 0.5209264755249023}, "num_episodes": 11, "episode_return_max": 4.18554080283684e-13, "episode_return_min": -6.661338147750939e-16, "episode_return_mean": 6.637801419628886e-14, "episodes_this_iter": 11}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 814814, "num_agent_steps_trained": 155692, "num_env_steps_sampled": 273408, "num_env_steps_trained": 155692, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 11776, "num_env_steps_sampled_throughput_per_sec": 2559.967407641514, "num_env_steps_trained_throughput_per_sec": 1177.5850075150963, "timesteps_total": 273408, "num_env_steps_sampled_lifetime": 273408, "num_agent_steps_sampled_lifetime": 814814, "num_steps_trained_this_iter": 11776, "agent_timesteps_total": 814814, "timers": {"training_iteration_time_ms": 10000.083, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.157, "sample_time_ms": 0.112, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 273408, "num_env_steps_trained": 155692, "num_agent_steps_sampled": 814814, "num_agent_steps_trained": 155692, "num_training_step_calls_since_last_synch_worker_weights": 15646, "num_samples_added_to_queue": 49152, "num_times_learner_queue_full": 438, "num_weight_broadcasts": 58}, "done": false, "training_iteration": 12, "trial_id": "6466c_00000", "date": "2024-09-02_14-01-09", "timestamp": 1725253269, "time_this_iter_s": 70.0100769996643, "time_total_s": 840.1443676948547, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 840.1443676948547, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 41.132, "ram_util_percent": 43.75500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -18244.69921875, "policy_loss": -19447.513671875, "entropy": 18.64566421508789, "entropy_coeff": 0.01, "var_gnorm": 2048.275390625, "vf_loss": 2501.09521484375, "vf_explained_var": 0.0013322234153747559}, "model": {}, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 299008, "num_env_steps_trained": 172076, "num_agent_steps_sampled": 897867, "num_agent_steps_trained": 172076, "num_training_step_calls_since_last_synch_worker_weights": 10425, "num_samples_added_to_queue": 54272, "num_times_learner_queue_full": 478, "num_weight_broadcasts": 64, "learner_queue": {"size_count": 106, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.109, "learner_load_time_ms": 135.787, "learner_load_wait_time_ms": 7046.654, "learner_dequeue_time_ms": 62337.92}}, "env_runners": {"episode_reward_max": 4.249933738265099e-13, "episode_reward_min": -6.661338147750939e-16, "episode_reward_mean": 6.079914349754745e-14, "episode_len_mean": 1469.45, "episode_media": {}, "episodes_timesteps_total": 146945, "policy_reward_min": {"default_policy": -2634.6798667010016}, "policy_reward_max": {"default_policy": 3116.3013274434006}, "policy_reward_mean": {"default_policy": -4.245612064746424e-13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, -2.220446049250313e-16, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 1.1790568521519162e-13, -3.3306690738754696e-16, 1.6076029396572267e-13, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, -3.3306690738754696e-16, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, 1.5565326805244695e-13, 2.220446049250313e-16, 2.220446049250313e-16, 1.9895196601282805e-13, 0.0, 1.6542323066914832e-13, 1.2811973704174306e-13, -3.3306690738754696e-16, 1.2234657731369225e-13, 2.220446049250313e-16, 0.0, 8.060219158778636e-14, 0.0, 0.0, 1.4011014570769476e-13, 0.0, 2.615685446016869e-13, 0.0, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 3.934630399271555e-13, 0.0, 3.494982081519993e-13, 6.372680161348399e-14, 4.1522341120980855e-13, 3.9879211044535623e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 2.7000623958883807e-13, -2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 4.18554080283684e-13, 2.0605739337042905e-13, 0.0, 0.0, -6.661338147750939e-16, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 1.7918999617450027e-13, 4.1366909897533333e-13, 2.220446049250313e-16, 4.249933738265099e-13, 0.0, 4.005684672847565e-13, 0.0, 2.220446049250313e-16, 4.1677772344428377e-13, 1.1102230246251565e-16, 0.0, 1.9606538614880265e-13, 0.0, 2.220446049250313e-16], "episode_lengths": [1024, 2048, 2048, 1024, 1536, 2048, 2048, 1024, 1024, 2048, 2048, 2048, 1775, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 2048, 2048, 1024, 273, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 1024, 2047, 1988, 1024, 1024, 2048, 1024, 1024, 2048, 1024, 1025, 2049, 1536, 1588, 61, 1024, 1024, 2048, 1024, 1536, 1536, 2048, 2048, 2048, 2047, 460, 2048, 2048, 2048, 1024, 2048, 1024, 2048, 1536, 1024, 2047, 1024, 1024, 1024, 1025, 2048, 1024, 1024, 1024, 1536, 2048, 1536, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 2048, 1024], "policy_default_policy_reward": [-79.0, 79.0, 1794.0, -1794.0, -896.1814855409405, -1582.07360533816, 636.3738644055659, 1841.881226473496, 813.0, -813.0, -345.6810868176027, -601.1733546534007, 1402.5355282885694, -455.6810868176078, 908.9668926783794, -896.2651867562547, -823.7899781421679, 811.0882722199735, 2689.093056899892, -1339.2481275344699, -1498.5968018307753, 148.75187246547335, -768.0, 768.0, 0.0, 0.0, -982.95280956808, 1273.9373452396255, -38.407769173858114, -252.57676649774675, 1081.7899781421434, -1334.6693960471853, 522.0890696665969, -269.2096517615687, -1457.377637963565, -1418.1178196586782, 475.8821803412443, 2399.6132772811134, 1493.0, -1493.0, 0.0, 0.0, 358.50313806158186, -742.4621202458796, 383.9589821842978, -330.6892177051387, -247.55077894182895, 1119.3496854181553, -541.1096887712093, -656.1950929411202, -223.4457428549502, 879.6408357960715, -855.0571298879464, 594.0948082142238, -358.5358983848671, 619.4982200585677, 365.0, -365.0, -1102.798109029693, 497.08529610858255, -635.6493607141073, 1241.3621736352038, -840.0, 840.0, 514.2693304105163, 2274.032950900516, -1546.5716117215188, -1241.7306695894408, -875.0, 875.0, -252.8712870175201, 421.4738273959373, 1699.7110616066993, -1868.3136019850501, 345.3413408554502, -1432.8974882485816, 614.2148065377182, 473.3413408554502, 0.0, 0.0, -629.3258765270219, -632.7618119215373, -1259.6352776037938, 2521.7229660522994, 183.14065632731626, 134.35028842544395, -317.4909447527618, -759.0289636673123, -1137.7707402556837, 56.97103633269754, 1839.8286675902427, -1470.6791218279868, 2854.0103668064353, -554.6656224891848, -828.6656224891962, 728.3199846221491, -1172.3830432072887, 444.06305858515475, -647.0, 647.0, -584.0702012600918, -412.2432534317599, 996.3134546918523, 471.6402230514304, 280.721392131061, -752.3616151824914, -41.942286340601036, -425.3028650825172, 966.8574175823729, -499.612266159279, -135.7645019878176, 604.5762979145019, -468.81179592668354, -859.3242816337267, 671.1080938779087, -482.8919061220913, 671.1080938779087, 989.0, -989.0, 256.6797615707182, 256.6797615707182, -513.3595231414364, 712.0, -712.0, 1150.0, -1150.0, -799.0306627408039, 259.5081886954644, 539.5224740453394, 278.0, -278.0, -781.3529932111406, 497.80317395533194, 283.5498192558066, 231.0, -231.0, 981.9032267962001, -50.39905451484528, -612.3990545148599, -319.1051177665254, -571.6041352717459, 2400.6497880644743, -437.60413527174006, -1391.4415175209601, -557.1422123213497, -654.1370575452116, 1350.4214821878775, -139.1422123213444, 474.0, -474.0, -566.0, 566.0, 1639.9752372410926, -152.11999832348468, -869.7899781421761, -618.0652607754921, 1242.0, -1242.0, 0.0, 0.0, -101.86533479473131, -767.6241706048606, 1054.4932789576046, -185.00377355803698, 0.0, 0.0, -1309.1467833260203, -804.4716487312256, 1951.249138656332, 162.36929340089324, 40.393102292056795, 398.39310229205535, -957.2681628676139, 518.4819582834996, 797.2082705434617, -888.6545154902565, 103.45814939234495, -12.011904445576999, 1200.0, -1200.0, -1263.0, 1263.0, 2432.4940084759182, -956.0083681642193, -1476.4856403116867, 1025.0, -1025.0, -1028.840366626433, -1007.6271631908377, 2036.4675298172724, 267.99347006970305, 72.83199846221439, -340.8254685319174, 955.3012613830327, 1292.5911960090414, -2247.8924573920517, -1228.9515857021959, 2519.421461367612, -1290.4698756654163, 216.0, -216.0, 748.0, -748.0, -1216.4236608526433, 729.1400336566109, -1202.5672543920944, 1689.8508815881107, -783.0, 783.0, -1358.7808793787476, 2321.153208573646, -962.3723291948977, -712.6182183820705, 628.3250790803709, 854.6463846027038, -770.3532453010358, -691.3562214124252, -88.60254037844358, -84.60254037844358, 864.5613021692948, 792.0, -792.0, 0.0, 0.0, -231.0, 231.0, 737.3348048611948, -123.03411844343415, -438.150343208888, -176.15034320887943, 322.0, -322.0, 619.42554031942, 1620.6887424795866, -2240.1142827989925, 656.1950929411207, 656.1950929411207, -1312.3901858822414, 283.0, -283.0, 0.0, 0.0, -728.2651867562413, -224.81575202287567, 348.3687096294443, 604.712229149617, 3116.3013274434006, -1117.5146955088494, -793.5146955088521, -1205.2719364256595, 1981.9050353646492, -403.70627692685935, -569.7062769268674, -1008.4924815109964, 566.0, -566.0, 724.7844507162164, 24.748737341528575, -749.5331880577452, 1317.3399333505008, 1317.3399333505008, -2634.6798667010016, -725.1245693281855, -1355.6458008312202, 939.9536070147558, 1140.8167631446825, -570.6351724175479, 1694.9349545041669, -1124.2997820866028, -321.0, 321.0, -1155.4124804588062, 1209.8597026101913, -54.44722215136439, 0.0, 0.0, -885.2102355330305, 834.4034118443435, -783.5965881556565, 834.4034118443435, 2301.6325727621957, -748.8260812765594, -1552.8064914855847, -748.3532453010351, -397.32428163373226, 761.0549512231886, 384.622575711545, 732.0, -732.0, 446.8914857099005, -698.6214998123133, 251.73001410241116, 1028.0, -1028.0, -310.1229744348785, 663.4613391789253, -477.3827927397809, 124.04442799572116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.960630017225604, "mean_inference_ms": 3.7980813738916486, "mean_action_processing_ms": 0.7611124108410352, "mean_env_wait_ms": 22.552158254410983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015093803405761719, "StateBufferConnector_ms": 0.012668848037719727, "ViewRequirementAgentConnector_ms": 0.5207810401916504}, "num_episodes": 11, "episode_return_max": 4.249933738265099e-13, "episode_return_min": -6.661338147750939e-16, "episode_return_mean": 6.079914349754745e-14, "episodes_this_iter": 11}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 897867, "num_agent_steps_trained": 172076, "num_env_steps_sampled": 299008, "num_env_steps_trained": 172076, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 16384, "num_env_steps_sampled_throughput_per_sec": 2559.9771120210407, "num_env_steps_trained_throughput_per_sec": 1638.385351693466, "timesteps_total": 299008, "num_env_steps_sampled_lifetime": 299008, "num_agent_steps_sampled_lifetime": 897867, "num_steps_trained_this_iter": 16384, "agent_timesteps_total": 897867, "timers": {"training_iteration_time_ms": 10000.078, "restore_workers_time_ms": 0.005, "training_step_time_ms": 0.136, "sample_time_ms": 0.097, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 299008, "num_env_steps_trained": 172076, "num_agent_steps_sampled": 897867, "num_agent_steps_trained": 172076, "num_training_step_calls_since_last_synch_worker_weights": 10425, "num_samples_added_to_queue": 54272, "num_times_learner_queue_full": 478, "num_weight_broadcasts": 64}, "done": false, "training_iteration": 13, "trial_id": "6466c_00000", "date": "2024-09-02_14-02-19", "timestamp": 1725253339, "time_this_iter_s": 70.00951790809631, "time_total_s": 910.153885602951, "pid": 362001, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": true, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7073d157aa70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": true, "max_num_env_runner_restarts": 10, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": true, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 10, "env_runner_restore_timeout_s": 120, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 910.153885602951, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 35.05050505050505, "ram_util_percent": 43.685858585858576}}
