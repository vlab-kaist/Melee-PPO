{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 46419, "learner_queue": {"size_count": 0, "size_mean": NaN, "size_std": NaN, "size_quantiles": 1.0}, "timing_breakdown": {"learner_grad_time_ms": 0.0, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 0.0, "learner_dequeue_time_ms": 0.0}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 0, "num_env_steps_sampled_lifetime": 0, "num_agent_steps_sampled_lifetime": 0, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 0, "timers": {"training_iteration_time_ms": 10000.048, "restore_workers_time_ms": 0.008, "training_step_time_ms": 0.156, "sample_time_ms": 0.132, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 46419}, "done": false, "training_iteration": 1, "trial_id": "aec47_00000", "date": "2024-09-02_10-22-18", "timestamp": 1725240138, "time_this_iter_s": 38.727418661117554, "time_total_s": 38.727418661117554, "pid": 3866939, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.4, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 0.4, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ecf73628c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.727418661117554, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 67.72857142857143, "ram_util_percent": 39.64821428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 5636.5654296875, "policy_loss": 5534.54248046875, "entropy": 12.63463020324707, "entropy_coeff": 0.01, "var_gnorm": 2049.2998046875, "vf_loss": 333.4244079589844, "vf_explained_var": 0.004854440689086914}, "model": {}, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 6656, "num_training_step_calls_since_last_synch_worker_weights": 43155, "num_samples_added_to_queue": 2048, "num_times_learner_queue_full": 46, "num_weight_broadcasts": 1, "learner_queue": {"size_count": 4, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 98.569, "learner_load_time_ms": 310.613, "learner_load_wait_time_ms": 10023.663, "learner_dequeue_time_ms": 39048.385}}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 1528.0, "episode_media": {}, "episodes_timesteps_total": 3056, "policy_reward_min": {"default_policy": -1574.0}, "policy_reward_max": {"default_policy": 1574.0}, "policy_reward_mean": {"default_policy": 0.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0], "episode_lengths": [2030, 1026], "policy_default_policy_reward": [1574.0, -1574.0, 652.0, -652.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.336665328506612, "mean_inference_ms": 4.168708653726945, "mean_action_processing_ms": 0.7094720213979904, "mean_env_wait_ms": 20.36854009502629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013148784637451172, "StateBufferConnector_ms": 0.012969970703125, "ViewRequirementAgentConnector_ms": 0.4458904266357422}, "num_episodes": 2, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0, "episodes_this_iter": 2}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 6656, "num_env_steps_sampled": 25600, "num_env_steps_trained": 6656, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 6656, "num_env_steps_sampled_throughput_per_sec": 2559.9620366957943, "num_env_steps_trained_throughput_per_sec": 665.5901295409066, "timesteps_total": 25600, "num_env_steps_sampled_lifetime": 25600, "num_agent_steps_sampled_lifetime": 80896, "num_steps_trained_this_iter": 6656, "agent_timesteps_total": 80896, "timers": {"training_iteration_time_ms": 10000.103, "restore_workers_time_ms": 0.008, "training_step_time_ms": 0.188, "sample_time_ms": 0.128, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 6656, "num_training_step_calls_since_last_synch_worker_weights": 43155, "num_samples_added_to_queue": 2048, "num_times_learner_queue_full": 46, "num_weight_broadcasts": 1}, "done": false, "training_iteration": 2, "trial_id": "aec47_00000", "date": "2024-09-02_10-22-56", "timestamp": 1725240176, "time_this_iter_s": 38.03283667564392, "time_total_s": 76.76025533676147, "pid": 3866939, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.4, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 0.4, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ecf73628c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 76.76025533676147, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 52.10555555555557, "ram_util_percent": 42.05925925925928}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 24196.19921875, "policy_loss": 22601.70703125, "entropy": 13.374113082885742, "entropy_coeff": 0.01, "var_gnorm": 2049.2998046875, "vf_loss": 3325.93212890625, "vf_explained_var": -0.006968975067138672}, "model": {}, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 163553, "num_agent_steps_trained": 15872, "num_training_step_calls_since_last_synch_worker_weights": 2670, "num_samples_added_to_queue": 5120, "num_times_learner_queue_full": 92, "num_weight_broadcasts": 4, "learner_queue": {"size_count": 10, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.938, "learner_load_time_ms": 190.824, "learner_load_wait_time_ms": 8585.887, "learner_dequeue_time_ms": 43001.338}}, "env_runners": {"episode_reward_max": 4.2543746303636e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 1.723322339531618e-13, "episode_len_mean": 2013.3076923076924, "episode_media": {}, "episodes_timesteps_total": 52346, "policy_reward_min": {"default_policy": -2456.488957842019}, "policy_reward_max": {"default_policy": 2722.2553045543473}, "policy_reward_mean": {"default_policy": 6.3727788478394765e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.2543746303636e-13, 4.0456527017340704e-13, 0.0, 3.5771385853422544e-13, 2.220446049250313e-16, 1.1013412404281553e-13, 2.220446049250313e-16, 4.105604745063829e-13, 3.856914787547794e-13, 3.574918139293004e-13, 4.2232883856740955e-13, 4.007905118896815e-13, 0.0, 4.8960835385969403e-14, -2.220446049250313e-16, 0.0, 3.439470930288735e-13, -2.220446049250313e-16, 3.9124259387790516e-13, 1.1102230246251565e-16, 0.0, 4.2166270475263445e-13], "episode_lengths": [2030, 1026, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2140, 2050, 2050, 2050, 2050, 2050, 2050], "policy_default_policy_reward": [1574.0, -1574.0, 652.0, -652.0, -906.5686356102165, 96.04145188430851, 295.4020306262231, 515.125153099617, -1199.8137870332916, 439.86097746523564, 1032.382208968329, -272.42939940024155, 1079.7520548718649, -1355.5236995345686, 275.7716446627645, 299.8132752230979, -2082.4294705943294, 1782.6161953713, -1295.0, 1295.0, -83.43860018001276, -1602.3039661686355, 1685.7425663487422, 285.0037735580386, -517.0985817722703, 1276.0684505620088, -1043.9736423478155, -1018.1578903249742, 905.3900937540197, 128.251783350788, -15.483986779827731, 2722.2553045543473, -1222.2993051996534, -995.977999677356, -503.9779996773345, -1436.8409793710086, -1048.6393564996538, 2485.4803358706636, 1228.2444789210094, -2456.488957842019, 1228.2444789210094, 2093.03607231219, -770.7463914933423, -1322.2896808188054, 2673.570739666256, -1312.3901858821957, -1361.1805537840603, 1663.1151493508137, -284.2569260369937, -1378.858223313722, 165.0, -165.0, -775.5190528383391, -435.4792068742822, 773.722190659616, 437.27606905296284, 48.37067461900722, 861.4694700664527, -1368.193389986528, 458.35324530103424, 1226.0, -1226.0, -1392.293252156263, 1547.8567440173642, -155.56349186104117, 1396.7515023692376, 1172.7395979236373, -1086.1370575452133, -1483.3540427475973, 2429.6742033225282, -913.5819612930261, -1516.0922420294833, 627.2606157515376, -130.739384248454, 1345.484350623428, -1842.0055821264696, -1274.0, 1274.0, 2192.0310216782914, -1836.356310741347, -355.67471093683565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.464732565480602, "mean_inference_ms": 4.817224858231272, "mean_action_processing_ms": 1.003769276493541, "mean_env_wait_ms": 21.15050205355878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018806640918438252, "StateBufferConnector_ms": 0.013954822833721455, "ViewRequirementAgentConnector_ms": 0.5584359169006348}, "num_episodes": 24, "episode_return_max": 4.2543746303636e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 1.723322339531618e-13, "episodes_this_iter": 24}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163553, "num_agent_steps_trained": 15872, "num_env_steps_sampled": 52224, "num_env_steps_trained": 15872, "num_env_steps_sampled_this_iter": 26624, "num_env_steps_trained_this_iter": 9216, "num_env_steps_sampled_throughput_per_sec": 2662.38781255579, "num_env_steps_trained_throughput_per_sec": 921.5957812693118, "timesteps_total": 52224, "num_env_steps_sampled_lifetime": 52224, "num_agent_steps_sampled_lifetime": 163553, "num_steps_trained_this_iter": 9216, "agent_timesteps_total": 163553, "timers": {"training_iteration_time_ms": 10000.087, "restore_workers_time_ms": 0.005, "training_step_time_ms": 0.139, "sample_time_ms": 0.1, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 163553, "num_agent_steps_trained": 15872, "num_training_step_calls_since_last_synch_worker_weights": 2670, "num_samples_added_to_queue": 5120, "num_times_learner_queue_full": 92, "num_weight_broadcasts": 4}, "done": false, "training_iteration": 3, "trial_id": "aec47_00000", "date": "2024-09-02_10-23-44", "timestamp": 1725240224, "time_this_iter_s": 48.35404062271118, "time_total_s": 125.11429595947266, "pid": 3866939, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.4, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 0.4, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ecf73628c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 125.11429595947266, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 58.76323529411765, "ram_util_percent": 40.482352941176465}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -13859.3486328125, "policy_loss": -18437.408203125, "entropy": 12.323677062988281, "entropy_coeff": 0.01, "var_gnorm": 2049.2998046875, "vf_loss": 9281.326171875, "vf_explained_var": 0.04821866750717163}, "model": {}, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 77824, "num_env_steps_trained": 21324, "num_agent_steps_sampled": 241912, "num_agent_steps_trained": 21324, "num_training_step_calls_since_last_synch_worker_weights": 45128, "num_samples_added_to_queue": 7168, "num_times_learner_queue_full": 138, "num_weight_broadcasts": 5, "learner_queue": {"size_count": 14, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.247, "learner_load_time_ms": 190.824, "learner_load_wait_time_ms": 8520.517, "learner_dequeue_time_ms": 43001.338}}, "env_runners": {"episode_reward_max": 4.2543746303636e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 1.64182843565774e-13, "episode_len_mean": 1929.344827586207, "episode_media": {}, "episodes_timesteps_total": 55951, "policy_reward_min": {"default_policy": -2456.488957842019}, "policy_reward_max": {"default_policy": 2722.2553045543473}, "policy_reward_mean": {"default_policy": 6.128754069901664e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.2543746303636e-13, 4.0456527017340704e-13, 0.0, 3.5771385853422544e-13, 2.220446049250313e-16, 1.1013412404281553e-13, 2.220446049250313e-16, 4.105604745063829e-13, 3.856914787547794e-13, 3.574918139293004e-13, 4.2232883856740955e-13, 4.007905118896815e-13, 0.0, 4.8960835385969403e-14, -2.220446049250313e-16, 0.0, 3.439470930288735e-13, -2.220446049250313e-16, 3.9124259387790516e-13, 1.1102230246251565e-16, 0.0, 4.2166270475263445e-13, 2.8066438062523957e-13, 0.0, 0.0], "episode_lengths": [2030, 1026, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2140, 2050, 2050, 2050, 2050, 2050, 2050, 1556, 1024, 1025], "policy_default_policy_reward": [1574.0, -1574.0, 652.0, -652.0, -906.5686356102165, 96.04145188430851, 295.4020306262231, 515.125153099617, -1199.8137870332916, 439.86097746523564, 1032.382208968329, -272.42939940024155, 1079.7520548718649, -1355.5236995345686, 275.7716446627645, 299.8132752230979, -2082.4294705943294, 1782.6161953713, -1295.0, 1295.0, -83.43860018001276, -1602.3039661686355, 1685.7425663487422, 285.0037735580386, -517.0985817722703, 1276.0684505620088, -1043.9736423478155, -1018.1578903249742, 905.3900937540197, 128.251783350788, -15.483986779827731, 2722.2553045543473, -1222.2993051996534, -995.977999677356, -503.9779996773345, -1436.8409793710086, -1048.6393564996538, 2485.4803358706636, 1228.2444789210094, -2456.488957842019, 1228.2444789210094, 2093.03607231219, -770.7463914933423, -1322.2896808188054, 2673.570739666256, -1312.3901858821957, -1361.1805537840603, 1663.1151493508137, -284.2569260369937, -1378.858223313722, 165.0, -165.0, -775.5190528383391, -435.4792068742822, 773.722190659616, 437.27606905296284, 48.37067461900722, 861.4694700664527, -1368.193389986528, 458.35324530103424, 1226.0, -1226.0, -1392.293252156263, 1547.8567440173642, -155.56349186104117, 1396.7515023692376, 1172.7395979236373, -1086.1370575452133, -1483.3540427475973, 2429.6742033225282, -913.5819612930261, -1516.0922420294833, 627.2606157515376, -130.739384248454, 1345.484350623428, -1842.0055821264696, -1274.0, 1274.0, 2192.0310216782914, -1836.356310741347, -355.67471093683565, -364.86709909226084, 1523.108006675835, -1158.2409075835515, 41.0, -41.0, 852.0, -852.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.594722788896695, "mean_inference_ms": 4.786081974343273, "mean_action_processing_ms": 0.991710952290791, "mean_env_wait_ms": 21.058239521356334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899702795620622, "StateBufferConnector_ms": 0.014072451098211881, "ViewRequirementAgentConnector_ms": 0.5552966019202923}, "num_episodes": 3, "episode_return_max": 4.2543746303636e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 1.64182843565774e-13, "episodes_this_iter": 3}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241912, "num_agent_steps_trained": 21324, "num_env_steps_sampled": 77824, "num_env_steps_trained": 21324, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 5452, "num_env_steps_sampled_throughput_per_sec": 2559.9718631022242, "num_env_steps_trained_throughput_per_sec": 545.1940077200518, "timesteps_total": 77824, "num_env_steps_sampled_lifetime": 77824, "num_agent_steps_sampled_lifetime": 241912, "num_steps_trained_this_iter": 5452, "agent_timesteps_total": 241912, "timers": {"training_iteration_time_ms": 10000.095, "restore_workers_time_ms": 0.007, "training_step_time_ms": 0.168, "sample_time_ms": 0.117, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 77824, "num_env_steps_trained": 21324, "num_agent_steps_sampled": 241912, "num_agent_steps_trained": 21324, "num_training_step_calls_since_last_synch_worker_weights": 45128, "num_samples_added_to_queue": 7168, "num_times_learner_queue_full": 138, "num_weight_broadcasts": 5}, "done": false, "training_iteration": 4, "trial_id": "aec47_00000", "date": "2024-09-02_10-24-30", "timestamp": 1725240270, "time_this_iter_s": 46.306713819503784, "time_total_s": 171.42100977897644, "pid": 3866939, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.4, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 0.4, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ecf73628c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 171.42100977897644, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 49.404545454545456, "ram_util_percent": 41.71060606060606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 428.1119384765625, "policy_loss": -1857.173828125, "entropy": 11.178704261779785, "entropy_coeff": 0.01, "var_gnorm": 2049.2998046875, "vf_loss": 4685.04150390625, "vf_explained_var": -0.0006884336471557617}, "model": {}, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 103424, "num_env_steps_trained": 26954, "num_agent_steps_sampled": 325868, "num_agent_steps_trained": 26954, "num_training_step_calls_since_last_synch_worker_weights": 61337, "num_samples_added_to_queue": 9216, "num_times_learner_queue_full": 184, "num_weight_broadcasts": 6, "learner_queue": {"size_count": 18, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.452, "learner_load_time_ms": 178.229, "learner_load_wait_time_ms": 9404.509, "learner_dequeue_time_ms": 57111.344}}, "env_runners": {"episode_reward_max": 4.276579090856103e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.4671053043448589e-13, "episode_len_mean": 1968.686274509804, "episode_media": {}, "episodes_timesteps_total": 100403, "policy_reward_min": {"default_policy": -2456.488957842019}, "policy_reward_max": {"default_policy": 2722.2553045543473}, "policy_reward_mean": {"default_policy": 2.83785372135477e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.2543746303636e-13, 4.0456527017340704e-13, 0.0, 3.5771385853422544e-13, 2.220446049250313e-16, 1.1013412404281553e-13, 2.220446049250313e-16, 4.105604745063829e-13, 3.856914787547794e-13, 3.574918139293004e-13, 4.2232883856740955e-13, 4.007905118896815e-13, 0.0, 4.8960835385969403e-14, -2.220446049250313e-16, 0.0, 3.439470930288735e-13, -2.220446049250313e-16, 3.9124259387790516e-13, 1.1102230246251565e-16, 0.0, 4.2166270475263445e-13, 2.8066438062523957e-13, 0.0, 0.0, 0.0, 0.0, 4.276579090856103e-13, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 7.860379014346108e-14, -2.220446049250313e-16, 3.310685059432217e-13, 2.220446049250313e-16, 3.823608096809039e-13, 4.234390615920347e-13, 1.1102230246251565e-16, -3.3306690738754696e-16, 3.559375016948252e-13, -2.220446049250313e-16, 0.0, 4.0478731477833207e-13, 3.170796958329447e-13], "episode_lengths": [2030, 1026, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2140, 2050, 2050, 2050, 2050, 2050, 2050, 1556, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1444, 2048, 2048, 2048, 2048, 2048, 2048], "policy_default_policy_reward": [1574.0, -1574.0, 652.0, -652.0, -906.5686356102165, 96.04145188430851, 295.4020306262231, 515.125153099617, -1199.8137870332916, 439.86097746523564, 1032.382208968329, -272.42939940024155, 1079.7520548718649, -1355.5236995345686, 275.7716446627645, 299.8132752230979, -2082.4294705943294, 1782.6161953713, -1295.0, 1295.0, -83.43860018001276, -1602.3039661686355, 1685.7425663487422, 285.0037735580386, -517.0985817722703, 1276.0684505620088, -1043.9736423478155, -1018.1578903249742, 905.3900937540197, 128.251783350788, -15.483986779827731, 2722.2553045543473, -1222.2993051996534, -995.977999677356, -503.9779996773345, -1436.8409793710086, -1048.6393564996538, 2485.4803358706636, 1228.2444789210094, -2456.488957842019, 1228.2444789210094, 2093.03607231219, -770.7463914933423, -1322.2896808188054, 2673.570739666256, -1312.3901858821957, -1361.1805537840603, 1663.1151493508137, -284.2569260369937, -1378.858223313722, 165.0, -165.0, -775.5190528383391, -435.4792068742822, 773.722190659616, 437.27606905296284, 48.37067461900722, 861.4694700664527, -1368.193389986528, 458.35324530103424, 1226.0, -1226.0, -1392.293252156263, 1547.8567440173642, -155.56349186104117, 1396.7515023692376, 1172.7395979236373, -1086.1370575452133, -1483.3540427475973, 2429.6742033225282, -913.5819612930261, -1516.0922420294833, 627.2606157515376, -130.739384248454, 1345.484350623428, -1842.0055821264696, -1274.0, 1274.0, 2192.0310216782914, -1836.356310741347, -355.67471093683565, -364.86709909226084, 1523.108006675835, -1158.2409075835515, 41.0, -41.0, 852.0, -852.0, 0.0, 0.0, -1349.0, 1349.0, -1411.385135248297, -1262.892711199145, 2674.2778464474422, -1329.0690343334752, 1019.6092900479352, -1174.3391621906662, 1483.79890647632, 1553.5059808498143, -938.0505938937215, 491.46867261978184, -1106.9240595759818, -576.0, 576.0, -1866.0, 1866.0, -1266.1697947705202, -168.44188761730007, -526.687836487043, 1961.2995188748496, 766.1999259807349, -196.0904508847442, -1218.8425370254056, 648.7330619293825, -287.08535316173993, 463.86204845837767, -176.77669529663768, -1224.2697577609072, 2240.406231534637, -362.2887819721987, -653.8476918015696, -614.4757928511141, -1274.2064196981275, 1888.682212549283, 935.572409168224, 1251.9603566841856, -1372.0492126755603, -815.4835531768126, -1475.7318523362628, -701.4499269370601, 2177.181779273376, 2676.399166791002, -1368.9587283771111, -1307.4404384138907, -873.4754222892791, -591.8395609140308, 1812.2469599915512, -346.93197678831694, -1139.0993792189101, -146.08231999719513, 1904.7324781579164, -619.5507789418468, -847.8210306426766, 2124.148770684393, -1276.3277400416869, 1118.943297462414, -682.4664939550976, -1035.7279071532855, 599.2511036458966, 1633.0, -1633.0, 2207.5873708643785, -1023.1835123769425, -1184.4038584874368, 843.5783899555568, 255.97265478953005, -1099.551044745077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.899849913238351, "mean_inference_ms": 4.805141480015752, "mean_action_processing_ms": 1.0014525190003556, "mean_env_wait_ms": 20.657089333195117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0175321803373449, "StateBufferConnector_ms": 0.013766569249770221, "ViewRequirementAgentConnector_ms": 0.5581243365418678}, "num_episodes": 22, "episode_return_max": 4.276579090856103e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.4671053043448589e-13, "episodes_this_iter": 22}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 325868, "num_agent_steps_trained": 26954, "num_env_steps_sampled": 103424, "num_env_steps_trained": 26954, "num_env_steps_sampled_this_iter": 25600, "num_env_steps_trained_this_iter": 5630, "num_env_steps_sampled_throughput_per_sec": 2559.959473297828, "num_env_steps_trained_throughput_per_sec": 562.9910872916707, "timesteps_total": 103424, "num_env_steps_sampled_lifetime": 103424, "num_agent_steps_sampled_lifetime": 325868, "num_steps_trained_this_iter": 5630, "agent_timesteps_total": 325868, "timers": {"training_iteration_time_ms": 10000.111, "restore_workers_time_ms": 0.005, "training_step_time_ms": 0.143, "sample_time_ms": 0.102, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 103424, "num_env_steps_trained": 26954, "num_agent_steps_sampled": 325868, "num_agent_steps_trained": 26954, "num_training_step_calls_since_last_synch_worker_weights": 61337, "num_samples_added_to_queue": 9216, "num_times_learner_queue_full": 184, "num_weight_broadcasts": 6}, "done": false, "training_iteration": 5, "trial_id": "aec47_00000", "date": "2024-09-02_10-25-18", "timestamp": 1725240318, "time_this_iter_s": 47.8461480140686, "time_total_s": 219.26715779304504, "pid": 3866939, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.4, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 0.4, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ecf73628c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 219.26715779304504, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 56.55882352941176, "ram_util_percent": 40.316176470588246}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -26465.41015625, "policy_loss": -33815.0703125, "entropy": 12.625741958618164, "entropy_coeff": 0.01, "var_gnorm": 2049.2998046875, "vf_loss": 14828.609375, "vf_explained_var": -0.001107335090637207}, "model": {}, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 131584, "num_env_steps_trained": 34632, "num_agent_steps_sampled": 404736, "num_agent_steps_trained": 34632, "num_training_step_calls_since_last_synch_worker_weights": 20, "num_samples_added_to_queue": 13824, "num_times_learner_queue_full": 230, "num_weight_broadcasts": 12, "learner_queue": {"size_count": 27, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.091, "learner_load_time_ms": 141.421, "learner_load_wait_time_ms": 5684.565, "learner_dequeue_time_ms": 57108.751}}, "env_runners": {"episode_reward_max": 4.276579090856103e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.2471505309955924e-13, "episode_len_mean": 1878.1833333333334, "episode_media": {}, "episodes_timesteps_total": 112691, "policy_reward_min": {"default_policy": -2456.488957842019}, "policy_reward_max": {"default_policy": 2900.8868086001034}, "policy_reward_mean": {"default_policy": 2.5960576789617375e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.2543746303636e-13, 4.0456527017340704e-13, 0.0, 3.5771385853422544e-13, 2.220446049250313e-16, 1.1013412404281553e-13, 2.220446049250313e-16, 4.105604745063829e-13, 3.856914787547794e-13, 3.574918139293004e-13, 4.2232883856740955e-13, 4.007905118896815e-13, 0.0, 4.8960835385969403e-14, -2.220446049250313e-16, 0.0, 3.439470930288735e-13, -2.220446049250313e-16, 3.9124259387790516e-13, 1.1102230246251565e-16, 0.0, 4.2166270475263445e-13, 2.8066438062523957e-13, 0.0, 0.0, 0.0, 0.0, 4.276579090856103e-13, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 7.860379014346108e-14, -2.220446049250313e-16, 3.310685059432217e-13, 2.220446049250313e-16, 3.823608096809039e-13, 4.234390615920347e-13, 1.1102230246251565e-16, -3.3306690738754696e-16, 3.559375016948252e-13, -2.220446049250313e-16, 0.0, 4.0478731477833207e-13, 3.170796958329447e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0], "episode_lengths": [2030, 1026, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2140, 2050, 2050, 2050, 2050, 2050, 2050, 1556, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1444, 2048, 2048, 2048, 2048, 2048, 2048, 1025, 2048, 1024, 2048, 1024, 1024, 2047, 1024, 1024], "policy_default_policy_reward": [1574.0, -1574.0, 652.0, -652.0, -906.5686356102165, 96.04145188430851, 295.4020306262231, 515.125153099617, -1199.8137870332916, 439.86097746523564, 1032.382208968329, -272.42939940024155, 1079.7520548718649, -1355.5236995345686, 275.7716446627645, 299.8132752230979, -2082.4294705943294, 1782.6161953713, -1295.0, 1295.0, -83.43860018001276, -1602.3039661686355, 1685.7425663487422, 285.0037735580386, -517.0985817722703, 1276.0684505620088, -1043.9736423478155, -1018.1578903249742, 905.3900937540197, 128.251783350788, -15.483986779827731, 2722.2553045543473, -1222.2993051996534, -995.977999677356, -503.9779996773345, -1436.8409793710086, -1048.6393564996538, 2485.4803358706636, 1228.2444789210094, -2456.488957842019, 1228.2444789210094, 2093.03607231219, -770.7463914933423, -1322.2896808188054, 2673.570739666256, -1312.3901858821957, -1361.1805537840603, 1663.1151493508137, -284.2569260369937, -1378.858223313722, 165.0, -165.0, -775.5190528383391, -435.4792068742822, 773.722190659616, 437.27606905296284, 48.37067461900722, 861.4694700664527, -1368.193389986528, 458.35324530103424, 1226.0, -1226.0, -1392.293252156263, 1547.8567440173642, -155.56349186104117, 1396.7515023692376, 1172.7395979236373, -1086.1370575452133, -1483.3540427475973, 2429.6742033225282, -913.5819612930261, -1516.0922420294833, 627.2606157515376, -130.739384248454, 1345.484350623428, -1842.0055821264696, -1274.0, 1274.0, 2192.0310216782914, -1836.356310741347, -355.67471093683565, -364.86709909226084, 1523.108006675835, -1158.2409075835515, 41.0, -41.0, 852.0, -852.0, 0.0, 0.0, -1349.0, 1349.0, -1411.385135248297, -1262.892711199145, 2674.2778464474422, -1329.0690343334752, 1019.6092900479352, -1174.3391621906662, 1483.79890647632, 1553.5059808498143, -938.0505938937215, 491.46867261978184, -1106.9240595759818, -576.0, 576.0, -1866.0, 1866.0, -1266.1697947705202, -168.44188761730007, -526.687836487043, 1961.2995188748496, 766.1999259807349, -196.0904508847442, -1218.8425370254056, 648.7330619293825, -287.08535316173993, 463.86204845837767, -176.77669529663768, -1224.2697577609072, 2240.406231534637, -362.2887819721987, -653.8476918015696, -614.4757928511141, -1274.2064196981275, 1888.682212549283, 935.572409168224, 1251.9603566841856, -1372.0492126755603, -815.4835531768126, -1475.7318523362628, -701.4499269370601, 2177.181779273376, 2676.399166791002, -1368.9587283771111, -1307.4404384138907, -873.4754222892791, -591.8395609140308, 1812.2469599915512, -346.93197678831694, -1139.0993792189101, -146.08231999719513, 1904.7324781579164, -619.5507789418468, -847.8210306426766, 2124.148770684393, -1276.3277400416869, 1118.943297462414, -682.4664939550976, -1035.7279071532855, 599.2511036458966, 1633.0, -1633.0, 2207.5873708643785, -1023.1835123769425, -1184.4038584874368, 843.5783899555568, 255.97265478953005, -1099.551044745077, 404.0, -404.0, -765.8455131368256, -1052.2112466548876, -1082.8300488084, 2900.8868086001034, 0.0, 0.0, 1297.5664569454384, 759.4760060607101, -1752.518469066838, -304.5239939392857, 0.0, 0.0, 0.0, 0.0, -853.0341184434559, -1633.6116823877412, 344.9658815565441, 2141.679919274662, 764.0, -764.0, -672.0, 672.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.094627663167589, "mean_inference_ms": 4.776514998328414, "mean_action_processing_ms": 0.9912646658931243, "mean_env_wait_ms": 20.533522597387634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017333825429280598, "StateBufferConnector_ms": 0.01379092534383138, "ViewRequirementAgentConnector_ms": 0.5571015675862631}, "num_episodes": 9, "episode_return_max": 4.276579090856103e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.2471505309955924e-13, "episodes_this_iter": 9}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404736, "num_agent_steps_trained": 34632, "num_env_steps_sampled": 131584, "num_env_steps_trained": 34632, "num_env_steps_sampled_this_iter": 28160, "num_env_steps_trained_this_iter": 7678, "num_env_steps_sampled_throughput_per_sec": 2815.9916748293, "num_env_steps_trained_throughput_per_sec": 767.7977300901763, "timesteps_total": 131584, "num_env_steps_sampled_lifetime": 131584, "num_agent_steps_sampled_lifetime": 404736, "num_steps_trained_this_iter": 7678, "agent_timesteps_total": 404736, "timers": {"training_iteration_time_ms": 10000.1, "restore_workers_time_ms": 0.007, "training_step_time_ms": 0.182, "sample_time_ms": 0.129, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 131584, "num_env_steps_trained": 34632, "num_agent_steps_sampled": 404736, "num_agent_steps_trained": 34632, "num_training_step_calls_since_last_synch_worker_weights": 20, "num_samples_added_to_queue": 13824, "num_times_learner_queue_full": 230, "num_weight_broadcasts": 12}, "done": false, "training_iteration": 6, "trial_id": "aec47_00000", "date": "2024-09-02_10-26-02", "timestamp": 1725240362, "time_this_iter_s": 43.864469051361084, "time_total_s": 263.1316268444061, "pid": 3866939, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.4, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 0.4, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ecf73628c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 263.1316268444061, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 50.624193548387105, "ram_util_percent": 41.18387096774195}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 14096.474609375, "policy_loss": 12903.451171875, "entropy": 12.314800262451172, "entropy_coeff": 0.01, "var_gnorm": 2049.2998046875, "vf_loss": 2512.1494140625, "vf_explained_var": 0.003024876117706299}, "model": {}, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 159232, "num_env_steps_trained": 47945, "num_agent_steps_sampled": 483451, "num_agent_steps_trained": 47945, "num_training_step_calls_since_last_synch_worker_weights": 912, "num_samples_added_to_queue": 17920, "num_times_learner_queue_full": 276, "num_weight_broadcasts": 17, "learner_queue": {"size_count": 35, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.804, "learner_load_time_ms": 125.724, "learner_load_wait_time_ms": 4322.962, "learner_dequeue_time_ms": 54358.055}}, "env_runners": {"episode_reward_max": 4.276579090856103e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.2357778618074451e-13, "episode_len_mean": 1950.551282051282, "episode_media": {}, "episodes_timesteps_total": 152143, "policy_reward_min": {"default_policy": -2542.0488783656056}, "policy_reward_max": {"default_policy": 2972.4359926486522}, "policy_reward_mean": {"default_policy": 2.849944402029913e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.2543746303636e-13, 4.0456527017340704e-13, 0.0, 3.5771385853422544e-13, 2.220446049250313e-16, 1.1013412404281553e-13, 2.220446049250313e-16, 4.105604745063829e-13, 3.856914787547794e-13, 3.574918139293004e-13, 4.2232883856740955e-13, 4.007905118896815e-13, 0.0, 4.8960835385969403e-14, -2.220446049250313e-16, 0.0, 3.439470930288735e-13, -2.220446049250313e-16, 3.9124259387790516e-13, 1.1102230246251565e-16, 0.0, 4.2166270475263445e-13, 2.8066438062523957e-13, 0.0, 0.0, 0.0, 0.0, 4.276579090856103e-13, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 7.860379014346108e-14, -2.220446049250313e-16, 3.310685059432217e-13, 2.220446049250313e-16, 3.823608096809039e-13, 4.234390615920347e-13, 1.1102230246251565e-16, -3.3306690738754696e-16, 3.559375016948252e-13, -2.220446049250313e-16, 0.0, 4.0478731477833207e-13, 3.170796958329447e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 3.885780586188048e-13, 0.0, 9.57012247226885e-14, -3.3306690738754696e-16, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 1.2856382625159313e-13, 0.0, 0.0, 0.0, 4.192202140984591e-13, 3.9834802123550617e-13, 0.0, 3.133049375492192e-13, 0.0, 4.1255887595070817e-13, -2.220446049250313e-16], "episode_lengths": [2030, 1026, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2140, 2050, 2050, 2050, 2050, 2050, 2050, 1556, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1444, 2048, 2048, 2048, 2048, 2048, 2048, 1025, 2048, 1024, 2048, 1024, 1024, 2047, 1024, 1024, 2048, 2560, 2048, 2048, 2048, 1997, 2048, 2048, 2561, 2126, 2560, 2048, 2048, 2560, 2048, 2560, 2048, 2048], "policy_default_policy_reward": [1574.0, -1574.0, 652.0, -652.0, -906.5686356102165, 96.04145188430851, 295.4020306262231, 515.125153099617, -1199.8137870332916, 439.86097746523564, 1032.382208968329, -272.42939940024155, 1079.7520548718649, -1355.5236995345686, 275.7716446627645, 299.8132752230979, -2082.4294705943294, 1782.6161953713, -1295.0, 1295.0, -83.43860018001276, -1602.3039661686355, 1685.7425663487422, 285.0037735580386, -517.0985817722703, 1276.0684505620088, -1043.9736423478155, -1018.1578903249742, 905.3900937540197, 128.251783350788, -15.483986779827731, 2722.2553045543473, -1222.2993051996534, -995.977999677356, -503.9779996773345, -1436.8409793710086, -1048.6393564996538, 2485.4803358706636, 1228.2444789210094, -2456.488957842019, 1228.2444789210094, 2093.03607231219, -770.7463914933423, -1322.2896808188054, 2673.570739666256, -1312.3901858821957, -1361.1805537840603, 1663.1151493508137, -284.2569260369937, -1378.858223313722, 165.0, -165.0, -775.5190528383391, -435.4792068742822, 773.722190659616, 437.27606905296284, 48.37067461900722, 861.4694700664527, -1368.193389986528, 458.35324530103424, 1226.0, -1226.0, -1392.293252156263, 1547.8567440173642, -155.56349186104117, 1396.7515023692376, 1172.7395979236373, -1086.1370575452133, -1483.3540427475973, 2429.6742033225282, -913.5819612930261, -1516.0922420294833, 627.2606157515376, -130.739384248454, 1345.484350623428, -1842.0055821264696, -1274.0, 1274.0, 2192.0310216782914, -1836.356310741347, -355.67471093683565, -364.86709909226084, 1523.108006675835, -1158.2409075835515, 41.0, -41.0, 852.0, -852.0, 0.0, 0.0, -1349.0, 1349.0, -1411.385135248297, -1262.892711199145, 2674.2778464474422, -1329.0690343334752, 1019.6092900479352, -1174.3391621906662, 1483.79890647632, 1553.5059808498143, -938.0505938937215, 491.46867261978184, -1106.9240595759818, -576.0, 576.0, -1866.0, 1866.0, -1266.1697947705202, -168.44188761730007, -526.687836487043, 1961.2995188748496, 766.1999259807349, -196.0904508847442, -1218.8425370254056, 648.7330619293825, -287.08535316173993, 463.86204845837767, -176.77669529663768, -1224.2697577609072, 2240.406231534637, -362.2887819721987, -653.8476918015696, -614.4757928511141, -1274.2064196981275, 1888.682212549283, 935.572409168224, 1251.9603566841856, -1372.0492126755603, -815.4835531768126, -1475.7318523362628, -701.4499269370601, 2177.181779273376, 2676.399166791002, -1368.9587283771111, -1307.4404384138907, -873.4754222892791, -591.8395609140308, 1812.2469599915512, -346.93197678831694, -1139.0993792189101, -146.08231999719513, 1904.7324781579164, -619.5507789418468, -847.8210306426766, 2124.148770684393, -1276.3277400416869, 1118.943297462414, -682.4664939550976, -1035.7279071532855, 599.2511036458966, 1633.0, -1633.0, 2207.5873708643785, -1023.1835123769425, -1184.4038584874368, 843.5783899555568, 255.97265478953005, -1099.551044745077, 404.0, -404.0, -765.8455131368256, -1052.2112466548876, -1082.8300488084, 2900.8868086001034, 0.0, 0.0, 1297.5664569454384, 759.4760060607101, -1752.518469066838, -304.5239939392857, 0.0, 0.0, 0.0, 0.0, -853.0341184434559, -1633.6116823877412, 344.9658815565441, 2141.679919274662, 764.0, -764.0, -672.0, 672.0, 363.4528855298877, -2037.8817433795748, 1674.4288578497574, 0.0, 0.0, -126.57211383239242, -393.8584771209089, 520.4305909533022, -100.12515309965258, -797.0771652210582, 2134.279483541736, -1237.077165221067, 974.7552759272311, -819.6493607141223, -272.697348592674, 117.59143337948478, 1592.0, -1592.0, 242.31375840624287, -1602.6485632674376, 1471.0127018922306, -110.6778970310307, -787.8285152959595, 96.6158260421137, -1217.7737777479422, 1908.9864670017719, 1208.0, -1208.0, 649.0, -649.0, -2047.0, 2047.0, -1179.454111019145, 1991.9198026025188, -812.4656915833496, 2.828427124746116, -1904.2385617352847, 1901.4101346106409, -919.0, 919.0, -122.32947314527318, -1356.937913096941, 1479.267386242277, -900.0, 900.0, 1142.6845583974502, -2542.0488783656056, 1399.3643199681553, -570.1852590989752, 2972.4359926486522, -970.1852590989915, -1432.0654744506203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.22741122865956, "mean_inference_ms": 4.76482980534481, "mean_action_processing_ms": 0.9886848617787047, "mean_env_wait_ms": 20.278930548900114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016711919735639524, "StateBufferConnector_ms": 0.013852730775490785, "ViewRequirementAgentConnector_ms": 0.5531952931330755}, "num_episodes": 18, "episode_return_max": 4.276579090856103e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.2357778618074451e-13, "episodes_this_iter": 18}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 483451, "num_agent_steps_trained": 47945, "num_env_steps_sampled": 159232, "num_env_steps_trained": 47945, "num_env_steps_sampled_this_iter": 27648, "num_env_steps_trained_this_iter": 13313, "num_env_steps_sampled_throughput_per_sec": 2764.760383868439, "num_env_steps_trained_throughput_per_sec": 1331.2809241334103, "timesteps_total": 159232, "num_env_steps_sampled_lifetime": 159232, "num_agent_steps_sampled_lifetime": 483451, "num_steps_trained_this_iter": 13313, "agent_timesteps_total": 483451, "timers": {"training_iteration_time_ms": 10000.107, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.136, "sample_time_ms": 0.095, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 159232, "num_env_steps_trained": 47945, "num_agent_steps_sampled": 483451, "num_agent_steps_trained": 47945, "num_training_step_calls_since_last_synch_worker_weights": 912, "num_samples_added_to_queue": 17920, "num_times_learner_queue_full": 276, "num_weight_broadcasts": 17}, "done": false, "training_iteration": 7, "trial_id": "aec47_00000", "date": "2024-09-02_10-26-50", "timestamp": 1725240410, "time_this_iter_s": 47.46360206604004, "time_total_s": 310.59522891044617, "pid": 3866939, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.4, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 0.4, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ecf73628c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 310.59522891044617, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 54.417647058823526, "ram_util_percent": 40.755882352941185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 54440.828125, "policy_loss": 46850.94921875, "entropy": 12.433021545410156, "entropy_coeff": 0.01, "var_gnorm": 2049.2998046875, "vf_loss": 15307.0673828125, "vf_explained_var": -0.0016669034957885742}, "model": {}, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 185344, "num_env_steps_trained": 53065, "num_agent_steps_sampled": 560606, "num_agent_steps_trained": 53065, "num_training_step_calls_since_last_synch_worker_weights": 158, "num_samples_added_to_queue": 20480, "num_times_learner_queue_full": 322, "num_weight_broadcasts": 19, "learner_queue": {"size_count": 40, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.085, "learner_load_time_ms": 125.724, "learner_load_wait_time_ms": 5617.103, "learner_dequeue_time_ms": 54358.055}}, "env_runners": {"episode_reward_max": 4.276579090856103e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.2233509224792026e-13, "episode_len_mean": 1964.0804597701149, "episode_media": {}, "episodes_timesteps_total": 170875, "policy_reward_min": {"default_policy": -2542.0488783656056}, "policy_reward_max": {"default_policy": 2972.4359926486522}, "policy_reward_mean": {"default_policy": 2.5379818367041847e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 4.2543746303636e-13, 4.0456527017340704e-13, 0.0, 3.5771385853422544e-13, 2.220446049250313e-16, 1.1013412404281553e-13, 2.220446049250313e-16, 4.105604745063829e-13, 3.856914787547794e-13, 3.574918139293004e-13, 4.2232883856740955e-13, 4.007905118896815e-13, 0.0, 4.8960835385969403e-14, -2.220446049250313e-16, 0.0, 3.439470930288735e-13, -2.220446049250313e-16, 3.9124259387790516e-13, 1.1102230246251565e-16, 0.0, 4.2166270475263445e-13, 2.8066438062523957e-13, 0.0, 0.0, 0.0, 0.0, 4.276579090856103e-13, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 7.860379014346108e-14, -2.220446049250313e-16, 3.310685059432217e-13, 2.220446049250313e-16, 3.823608096809039e-13, 4.234390615920347e-13, 1.1102230246251565e-16, -3.3306690738754696e-16, 3.559375016948252e-13, -2.220446049250313e-16, 0.0, 4.0478731477833207e-13, 3.170796958329447e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 3.885780586188048e-13, 0.0, 9.57012247226885e-14, -3.3306690738754696e-16, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 1.2856382625159313e-13, 0.0, 0.0, 0.0, 4.192202140984591e-13, 3.9834802123550617e-13, 0.0, 3.133049375492192e-13, 0.0, 4.1255887595070817e-13, -2.220446049250313e-16, 3.956834859764058e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.8702374638432957e-13, 1.9095836023552692e-14, 2.020605904817785e-13, 0.0], "episode_lengths": [2030, 1026, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2140, 2050, 2050, 2050, 2050, 2050, 2050, 1556, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1444, 2048, 2048, 2048, 2048, 2048, 2048, 1025, 2048, 1024, 2048, 1024, 1024, 2047, 1024, 1024, 2048, 2560, 2048, 2048, 2048, 1997, 2048, 2048, 2561, 2126, 2560, 2048, 2048, 2560, 2048, 2560, 2048, 2048, 2047, 2560, 2349, 2560, 2048, 2048, 2048, 2048, 1024], "policy_default_policy_reward": [1574.0, -1574.0, 652.0, -652.0, -906.5686356102165, 96.04145188430851, 295.4020306262231, 515.125153099617, -1199.8137870332916, 439.86097746523564, 1032.382208968329, -272.42939940024155, 1079.7520548718649, -1355.5236995345686, 275.7716446627645, 299.8132752230979, -2082.4294705943294, 1782.6161953713, -1295.0, 1295.0, -83.43860018001276, -1602.3039661686355, 1685.7425663487422, 285.0037735580386, -517.0985817722703, 1276.0684505620088, -1043.9736423478155, -1018.1578903249742, 905.3900937540197, 128.251783350788, -15.483986779827731, 2722.2553045543473, -1222.2993051996534, -995.977999677356, -503.9779996773345, -1436.8409793710086, -1048.6393564996538, 2485.4803358706636, 1228.2444789210094, -2456.488957842019, 1228.2444789210094, 2093.03607231219, -770.7463914933423, -1322.2896808188054, 2673.570739666256, -1312.3901858821957, -1361.1805537840603, 1663.1151493508137, -284.2569260369937, -1378.858223313722, 165.0, -165.0, -775.5190528383391, -435.4792068742822, 773.722190659616, 437.27606905296284, 48.37067461900722, 861.4694700664527, -1368.193389986528, 458.35324530103424, 1226.0, -1226.0, -1392.293252156263, 1547.8567440173642, -155.56349186104117, 1396.7515023692376, 1172.7395979236373, -1086.1370575452133, -1483.3540427475973, 2429.6742033225282, -913.5819612930261, -1516.0922420294833, 627.2606157515376, -130.739384248454, 1345.484350623428, -1842.0055821264696, -1274.0, 1274.0, 2192.0310216782914, -1836.356310741347, -355.67471093683565, -364.86709909226084, 1523.108006675835, -1158.2409075835515, 41.0, -41.0, 852.0, -852.0, 0.0, 0.0, -1349.0, 1349.0, -1411.385135248297, -1262.892711199145, 2674.2778464474422, -1329.0690343334752, 1019.6092900479352, -1174.3391621906662, 1483.79890647632, 1553.5059808498143, -938.0505938937215, 491.46867261978184, -1106.9240595759818, -576.0, 576.0, -1866.0, 1866.0, -1266.1697947705202, -168.44188761730007, -526.687836487043, 1961.2995188748496, 766.1999259807349, -196.0904508847442, -1218.8425370254056, 648.7330619293825, -287.08535316173993, 463.86204845837767, -176.77669529663768, -1224.2697577609072, 2240.406231534637, -362.2887819721987, -653.8476918015696, -614.4757928511141, -1274.2064196981275, 1888.682212549283, 935.572409168224, 1251.9603566841856, -1372.0492126755603, -815.4835531768126, -1475.7318523362628, -701.4499269370601, 2177.181779273376, 2676.399166791002, -1368.9587283771111, -1307.4404384138907, -873.4754222892791, -591.8395609140308, 1812.2469599915512, -346.93197678831694, -1139.0993792189101, -146.08231999719513, 1904.7324781579164, -619.5507789418468, -847.8210306426766, 2124.148770684393, -1276.3277400416869, 1118.943297462414, -682.4664939550976, -1035.7279071532855, 599.2511036458966, 1633.0, -1633.0, 2207.5873708643785, -1023.1835123769425, -1184.4038584874368, 843.5783899555568, 255.97265478953005, -1099.551044745077, 404.0, -404.0, -765.8455131368256, -1052.2112466548876, -1082.8300488084, 2900.8868086001034, 0.0, 0.0, 1297.5664569454384, 759.4760060607101, -1752.518469066838, -304.5239939392857, 0.0, 0.0, 0.0, 0.0, -853.0341184434559, -1633.6116823877412, 344.9658815565441, 2141.679919274662, 764.0, -764.0, -672.0, 672.0, 363.4528855298877, -2037.8817433795748, 1674.4288578497574, 0.0, 0.0, -126.57211383239242, -393.8584771209089, 520.4305909533022, -100.12515309965258, -797.0771652210582, 2134.279483541736, -1237.077165221067, 974.7552759272311, -819.6493607141223, -272.697348592674, 117.59143337948478, 1592.0, -1592.0, 242.31375840624287, -1602.6485632674376, 1471.0127018922306, -110.6778970310307, -787.8285152959595, 96.6158260421137, -1217.7737777479422, 1908.9864670017719, 1208.0, -1208.0, 649.0, -649.0, -2047.0, 2047.0, -1179.454111019145, 1991.9198026025188, -812.4656915833496, 2.828427124746116, -1904.2385617352847, 1901.4101346106409, -919.0, 919.0, -122.32947314527318, -1356.937913096941, 1479.267386242277, -900.0, 900.0, 1142.6845583974502, -2542.0488783656056, 1399.3643199681553, -570.1852590989752, 2972.4359926486522, -970.1852590989915, -1432.0654744506203, -1161.0693347082977, -951.0586206959141, 2112.1279554042226, 1099.0, -1099.0, -2098.0, 2098.0, 1854.0, -1854.0, -667.1852590989777, -819.6057301650449, -1272.7116453781757, 2759.502634642211, 1716.8552647209117, 125.86500705120524, -1842.7202717721175, -629.7211574838374, 116.8537131674253, 1388.0402497698738, -875.1728054534948, 1024.5977259393146, -651.2453454728143, -373.3523804664995, 434.0, -434.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.31734148090305, "mean_inference_ms": 4.748466435401615, "mean_action_processing_ms": 0.9843278891847532, "mean_env_wait_ms": 20.183262156850862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016613664298221982, "StateBufferConnector_ms": 0.013926111418625405, "ViewRequirementAgentConnector_ms": 0.5534520094422088}, "num_episodes": 9, "episode_return_max": 4.276579090856103e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.2233509224792026e-13, "episodes_this_iter": 9}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560606, "num_agent_steps_trained": 53065, "num_env_steps_sampled": 185344, "num_env_steps_trained": 53065, "num_env_steps_sampled_this_iter": 26112, "num_env_steps_trained_this_iter": 5120, "num_env_steps_sampled_throughput_per_sec": 2611.145900779062, "num_env_steps_trained_throughput_per_sec": 511.98939230962, "timesteps_total": 185344, "num_env_steps_sampled_lifetime": 185344, "num_agent_steps_sampled_lifetime": 560606, "num_steps_trained_this_iter": 5120, "agent_timesteps_total": 560606, "timers": {"training_iteration_time_ms": 10000.121, "restore_workers_time_ms": 0.008, "training_step_time_ms": 0.194, "sample_time_ms": 0.132, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 185344, "num_env_steps_trained": 53065, "num_agent_steps_sampled": 560606, "num_agent_steps_trained": 53065, "num_training_step_calls_since_last_synch_worker_weights": 158, "num_samples_added_to_queue": 20480, "num_times_learner_queue_full": 322, "num_weight_broadcasts": 19}, "done": false, "training_iteration": 8, "trial_id": "aec47_00000", "date": "2024-09-02_10-27-35", "timestamp": 1725240455, "time_this_iter_s": 44.883535861968994, "time_total_s": 355.47876477241516, "pid": 3866939, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.4, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 0.4, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ecf73628c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 355.47876477241516, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.4015625, "ram_util_percent": 41.267187500000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -51228.90625, "policy_loss": -66052.890625, "entropy": 12.545528411865234, "entropy_coeff": 0.01, "var_gnorm": 2049.2998046875, "vf_loss": 29776.439453125, "vf_explained_var": 0.00028580427169799805}, "model": {}, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 212992, "num_env_steps_trained": 61159, "num_agent_steps_sampled": 640298, "num_agent_steps_trained": 61159, "num_training_step_calls_since_last_synch_worker_weights": 172, "num_samples_added_to_queue": 24576, "num_times_learner_queue_full": 368, "num_weight_broadcasts": 23, "learner_queue": {"size_count": 48, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 44.807, "learner_load_time_ms": 124.691, "learner_load_wait_time_ms": 5370.407, "learner_dequeue_time_ms": 59119.946}}, "env_runners": {"episode_reward_max": 4.276579090856103e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 1.352840062196492e-13, "episode_len_mean": 1974.86, "episode_media": {}, "episodes_timesteps_total": 197486, "policy_reward_min": {"default_policy": -2542.0488783656056}, "policy_reward_max": {"default_policy": 3256.542705308488}, "policy_reward_mean": {"default_policy": 3.4773014097784956e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.220446049250313e-16, 4.2543746303636e-13, 4.0456527017340704e-13, 0.0, 3.5771385853422544e-13, 2.220446049250313e-16, 1.1013412404281553e-13, 2.220446049250313e-16, 4.105604745063829e-13, 3.856914787547794e-13, 3.574918139293004e-13, 4.2232883856740955e-13, 4.007905118896815e-13, 0.0, 4.8960835385969403e-14, -2.220446049250313e-16, 0.0, 3.439470930288735e-13, -2.220446049250313e-16, 3.9124259387790516e-13, 1.1102230246251565e-16, 0.0, 4.2166270475263445e-13, 2.8066438062523957e-13, 0.0, 0.0, 0.0, 0.0, 4.276579090856103e-13, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 7.860379014346108e-14, -2.220446049250313e-16, 3.310685059432217e-13, 2.220446049250313e-16, 3.823608096809039e-13, 4.234390615920347e-13, 1.1102230246251565e-16, -3.3306690738754696e-16, 3.559375016948252e-13, -2.220446049250313e-16, 0.0, 4.0478731477833207e-13, 3.170796958329447e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 3.885780586188048e-13, 0.0, 9.57012247226885e-14, -3.3306690738754696e-16, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 1.2856382625159313e-13, 0.0, 0.0, 0.0, 4.192202140984591e-13, 3.9834802123550617e-13, 0.0, 3.133049375492192e-13, 0.0, 4.1255887595070817e-13, -2.220446049250313e-16, 3.956834859764058e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.8702374638432957e-13, 1.9095836023552692e-14, 2.020605904817785e-13, 0.0, 0.0, 4.1455727739503345e-13, 2.220446049250313e-16, -3.3306690738754696e-16, 4.2743586448068527e-13, 0.0, 4.2010839251815923e-13, -3.3306690738754696e-16, 0.0, 4.001243780749064e-13, 4.1033842990145786e-13, 2.220446049250313e-16, 4.440892098500626e-16, 0.0, 4.212186155427844e-13, 3.914646384828302e-13], "episode_lengths": [2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2050, 2140, 2050, 2050, 2050, 2050, 2050, 2050, 1556, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1444, 2048, 2048, 2048, 2048, 2048, 2048, 1025, 2048, 1024, 2048, 1024, 1024, 2047, 1024, 1024, 2048, 2560, 2048, 2048, 2048, 1997, 2048, 2048, 2561, 2126, 2560, 2048, 2048, 2560, 2048, 2560, 2048, 2048, 2047, 2560, 2349, 2560, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 1587, 2048, 2047, 1458, 2048, 2048, 2048, 2048, 2049, 2048, 2048], "policy_default_policy_reward": [-1199.8137870332916, 439.86097746523564, 1032.382208968329, -272.42939940024155, 1079.7520548718649, -1355.5236995345686, 275.7716446627645, 299.8132752230979, -2082.4294705943294, 1782.6161953713, -1295.0, 1295.0, -83.43860018001276, -1602.3039661686355, 1685.7425663487422, 285.0037735580386, -517.0985817722703, 1276.0684505620088, -1043.9736423478155, -1018.1578903249742, 905.3900937540197, 128.251783350788, -15.483986779827731, 2722.2553045543473, -1222.2993051996534, -995.977999677356, -503.9779996773345, -1436.8409793710086, -1048.6393564996538, 2485.4803358706636, 1228.2444789210094, -2456.488957842019, 1228.2444789210094, 2093.03607231219, -770.7463914933423, -1322.2896808188054, 2673.570739666256, -1312.3901858821957, -1361.1805537840603, 1663.1151493508137, -284.2569260369937, -1378.858223313722, 165.0, -165.0, -775.5190528383391, -435.4792068742822, 773.722190659616, 437.27606905296284, 48.37067461900722, 861.4694700664527, -1368.193389986528, 458.35324530103424, 1226.0, -1226.0, -1392.293252156263, 1547.8567440173642, -155.56349186104117, 1396.7515023692376, 1172.7395979236373, -1086.1370575452133, -1483.3540427475973, 2429.6742033225282, -913.5819612930261, -1516.0922420294833, 627.2606157515376, -130.739384248454, 1345.484350623428, -1842.0055821264696, -1274.0, 1274.0, 2192.0310216782914, -1836.356310741347, -355.67471093683565, -364.86709909226084, 1523.108006675835, -1158.2409075835515, 41.0, -41.0, 852.0, -852.0, 0.0, 0.0, -1349.0, 1349.0, -1411.385135248297, -1262.892711199145, 2674.2778464474422, -1329.0690343334752, 1019.6092900479352, -1174.3391621906662, 1483.79890647632, 1553.5059808498143, -938.0505938937215, 491.46867261978184, -1106.9240595759818, -576.0, 576.0, -1866.0, 1866.0, -1266.1697947705202, -168.44188761730007, -526.687836487043, 1961.2995188748496, 766.1999259807349, -196.0904508847442, -1218.8425370254056, 648.7330619293825, -287.08535316173993, 463.86204845837767, -176.77669529663768, -1224.2697577609072, 2240.406231534637, -362.2887819721987, -653.8476918015696, -614.4757928511141, -1274.2064196981275, 1888.682212549283, 935.572409168224, 1251.9603566841856, -1372.0492126755603, -815.4835531768126, -1475.7318523362628, -701.4499269370601, 2177.181779273376, 2676.399166791002, -1368.9587283771111, -1307.4404384138907, -873.4754222892791, -591.8395609140308, 1812.2469599915512, -346.93197678831694, -1139.0993792189101, -146.08231999719513, 1904.7324781579164, -619.5507789418468, -847.8210306426766, 2124.148770684393, -1276.3277400416869, 1118.943297462414, -682.4664939550976, -1035.7279071532855, 599.2511036458966, 1633.0, -1633.0, 2207.5873708643785, -1023.1835123769425, -1184.4038584874368, 843.5783899555568, 255.97265478953005, -1099.551044745077, 404.0, -404.0, -765.8455131368256, -1052.2112466548876, -1082.8300488084, 2900.8868086001034, 0.0, 0.0, 1297.5664569454384, 759.4760060607101, -1752.518469066838, -304.5239939392857, 0.0, 0.0, 0.0, 0.0, -853.0341184434559, -1633.6116823877412, 344.9658815565441, 2141.679919274662, 764.0, -764.0, -672.0, 672.0, 363.4528855298877, -2037.8817433795748, 1674.4288578497574, 0.0, 0.0, -126.57211383239242, -393.8584771209089, 520.4305909533022, -100.12515309965258, -797.0771652210582, 2134.279483541736, -1237.077165221067, 974.7552759272311, -819.6493607141223, -272.697348592674, 117.59143337948478, 1592.0, -1592.0, 242.31375840624287, -1602.6485632674376, 1471.0127018922306, -110.6778970310307, -787.8285152959595, 96.6158260421137, -1217.7737777479422, 1908.9864670017719, 1208.0, -1208.0, 649.0, -649.0, -2047.0, 2047.0, -1179.454111019145, 1991.9198026025188, -812.4656915833496, 2.828427124746116, -1904.2385617352847, 1901.4101346106409, -919.0, 919.0, -122.32947314527318, -1356.937913096941, 1479.267386242277, -900.0, 900.0, 1142.6845583974502, -2542.0488783656056, 1399.3643199681553, -570.1852590989752, 2972.4359926486522, -970.1852590989915, -1432.0654744506203, -1161.0693347082977, -951.0586206959141, 2112.1279554042226, 1099.0, -1099.0, -2098.0, 2098.0, 1854.0, -1854.0, -667.1852590989777, -819.6057301650449, -1272.7116453781757, 2759.502634642211, 1716.8552647209117, 125.86500705120524, -1842.7202717721175, -629.7211574838374, 116.8537131674253, 1388.0402497698738, -875.1728054534948, 1024.5977259393146, -651.2453454728143, -373.3523804664995, 434.0, -434.0, 1102.0, -1102.0, -55.86143571373726, 1776.959341121817, -1721.0979054079592, 572.9609404556074, 421.2362230889238, -1231.8625723585094, 237.66540881397896, -1578.673169605224, 1266.9040242428787, 1278.4510296266324, -966.6818842642641, -1280.5703807287935, -1289.0556621030432, 2569.626042831837, 947.0, -947.0, -344.3610024378514, -1279.8632739476195, 1624.2242763855108, -845.1801043228419, -623.4776009540149, 2219.2737449941196, -750.6160397173354, 1180.0, -1180.0, -1591.6973644508687, 1096.0155108391557, 495.68185361177314, -31.81980515339477, -1826.4568158047746, 1858.2766209582433, -1055.6834791575616, 3256.542705308488, -1201.1757469933254, -999.6834791575651, 1163.7921568068857, 1168.410958960407, -1858.921880911186, -473.2812348561187, 996.0, -996.0, 2409.8199102837148, -795.4951288348717, -1614.324781448805, 1779.0806614653666, -658.3164132846811, -1120.7642481806706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.411710334731902, "mean_inference_ms": 4.747691891051374, "mean_action_processing_ms": 0.98537121318992, "mean_env_wait_ms": 19.976525947962557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016411304473876953, "StateBufferConnector_ms": 0.0140228271484375, "ViewRequirementAgentConnector_ms": 0.5585565567016602}, "num_episodes": 16, "episode_return_max": 4.276579090856103e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 1.352840062196492e-13, "episodes_this_iter": 16}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640298, "num_agent_steps_trained": 61159, "num_env_steps_sampled": 212992, "num_env_steps_trained": 61159, "num_env_steps_sampled_this_iter": 27648, "num_env_steps_trained_this_iter": 8094, "num_env_steps_sampled_throughput_per_sec": 2764.757483563974, "num_env_steps_trained_throughput_per_sec": 809.3875532395401, "timesteps_total": 212992, "num_env_steps_sampled_lifetime": 212992, "num_agent_steps_sampled_lifetime": 640298, "num_steps_trained_this_iter": 8094, "agent_timesteps_total": 640298, "timers": {"training_iteration_time_ms": 10000.126, "restore_workers_time_ms": 0.008, "training_step_time_ms": 0.19, "sample_time_ms": 0.131, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 212992, "num_env_steps_trained": 61159, "num_agent_steps_sampled": 640298, "num_agent_steps_trained": 61159, "num_training_step_calls_since_last_synch_worker_weights": 172, "num_samples_added_to_queue": 24576, "num_times_learner_queue_full": 368, "num_weight_broadcasts": 23}, "done": false, "training_iteration": 9, "trial_id": "aec47_00000", "date": "2024-09-02_10-28-21", "timestamp": 1725240501, "time_this_iter_s": 46.25200867652893, "time_total_s": 401.7307734489441, "pid": 3866939, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.4, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 0.4, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ecf73628c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 401.7307734489441, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 57.74696969696969, "ram_util_percent": 40.70606060606061}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 24482.8671875, "policy_loss": 18727.5078125, "entropy": 12.641340255737305, "entropy_coeff": 0.01, "var_gnorm": 2049.299560546875, "vf_loss": 11640.16796875, "vf_explained_var": -0.001741170883178711}, "model": {}, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 240128, "num_env_steps_trained": 71907, "num_agent_steps_sampled": 718124, "num_agent_steps_trained": 71907, "num_training_step_calls_since_last_synch_worker_weights": 97, "num_samples_added_to_queue": 28160, "num_times_learner_queue_full": 414, "num_weight_broadcasts": 27, "learner_queue": {"size_count": 55, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 47.258, "learner_load_time_ms": 138.32, "learner_load_wait_time_ms": 4626.101, "learner_dequeue_time_ms": 57267.066}}, "env_runners": {"episode_reward_max": 4.276579090856103e-13, "episode_reward_min": -7.771561172376096e-16, "episode_reward_mean": 1.2485790179539434e-13, "episode_len_mean": 1987.03, "episode_media": {}, "episodes_timesteps_total": 198703, "policy_reward_min": {"default_policy": -2542.0488783656056}, "policy_reward_max": {"default_policy": 3256.542705308488}, "policy_reward_mean": {"default_policy": 3.0395866004353693e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.856914787547794e-13, 3.574918139293004e-13, 4.2232883856740955e-13, 4.007905118896815e-13, 0.0, 4.8960835385969403e-14, -2.220446049250313e-16, 0.0, 3.439470930288735e-13, -2.220446049250313e-16, 3.9124259387790516e-13, 1.1102230246251565e-16, 0.0, 4.2166270475263445e-13, 2.8066438062523957e-13, 0.0, 0.0, 0.0, 0.0, 4.276579090856103e-13, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 7.860379014346108e-14, -2.220446049250313e-16, 3.310685059432217e-13, 2.220446049250313e-16, 3.823608096809039e-13, 4.234390615920347e-13, 1.1102230246251565e-16, -3.3306690738754696e-16, 3.559375016948252e-13, -2.220446049250313e-16, 0.0, 4.0478731477833207e-13, 3.170796958329447e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 3.885780586188048e-13, 0.0, 9.57012247226885e-14, -3.3306690738754696e-16, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 1.2856382625159313e-13, 0.0, 0.0, 0.0, 4.192202140984591e-13, 3.9834802123550617e-13, 0.0, 3.133049375492192e-13, 0.0, 4.1255887595070817e-13, -2.220446049250313e-16, 3.956834859764058e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.8702374638432957e-13, 1.9095836023552692e-14, 2.020605904817785e-13, 0.0, 0.0, 4.1455727739503345e-13, 2.220446049250313e-16, -3.3306690738754696e-16, 4.2743586448068527e-13, 0.0, 4.2010839251815923e-13, -3.3306690738754696e-16, 0.0, 4.001243780749064e-13, 4.1033842990145786e-13, 2.220446049250313e-16, 4.440892098500626e-16, 0.0, 4.212186155427844e-13, 3.914646384828302e-13, 3.232969447708456e-13, -7.771561172376096e-16, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 3.4305891460917337e-13, 0.0, 0.0, 0.0], "episode_lengths": [2050, 2050, 2050, 2050, 2050, 2050, 2050, 2140, 2050, 2050, 2050, 2050, 2050, 2050, 1556, 1024, 1025, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1444, 2048, 2048, 2048, 2048, 2048, 2048, 1025, 2048, 1024, 2048, 1024, 1024, 2047, 1024, 1024, 2048, 2560, 2048, 2048, 2048, 1997, 2048, 2048, 2561, 2126, 2560, 2048, 2048, 2560, 2048, 2560, 2048, 2048, 2047, 2560, 2349, 2560, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 1587, 2048, 2047, 1458, 2048, 2048, 2048, 2048, 2049, 2048, 2048, 2048, 2048, 1235, 2560, 2048, 2048, 2560, 2560, 2560], "policy_default_policy_reward": [1228.2444789210094, -2456.488957842019, 1228.2444789210094, 2093.03607231219, -770.7463914933423, -1322.2896808188054, 2673.570739666256, -1312.3901858821957, -1361.1805537840603, 1663.1151493508137, -284.2569260369937, -1378.858223313722, 165.0, -165.0, -775.5190528383391, -435.4792068742822, 773.722190659616, 437.27606905296284, 48.37067461900722, 861.4694700664527, -1368.193389986528, 458.35324530103424, 1226.0, -1226.0, -1392.293252156263, 1547.8567440173642, -155.56349186104117, 1396.7515023692376, 1172.7395979236373, -1086.1370575452133, -1483.3540427475973, 2429.6742033225282, -913.5819612930261, -1516.0922420294833, 627.2606157515376, -130.739384248454, 1345.484350623428, -1842.0055821264696, -1274.0, 1274.0, 2192.0310216782914, -1836.356310741347, -355.67471093683565, -364.86709909226084, 1523.108006675835, -1158.2409075835515, 41.0, -41.0, 852.0, -852.0, 0.0, 0.0, -1349.0, 1349.0, -1411.385135248297, -1262.892711199145, 2674.2778464474422, -1329.0690343334752, 1019.6092900479352, -1174.3391621906662, 1483.79890647632, 1553.5059808498143, -938.0505938937215, 491.46867261978184, -1106.9240595759818, -576.0, 576.0, -1866.0, 1866.0, -1266.1697947705202, -168.44188761730007, -526.687836487043, 1961.2995188748496, 766.1999259807349, -196.0904508847442, -1218.8425370254056, 648.7330619293825, -287.08535316173993, 463.86204845837767, -176.77669529663768, -1224.2697577609072, 2240.406231534637, -362.2887819721987, -653.8476918015696, -614.4757928511141, -1274.2064196981275, 1888.682212549283, 935.572409168224, 1251.9603566841856, -1372.0492126755603, -815.4835531768126, -1475.7318523362628, -701.4499269370601, 2177.181779273376, 2676.399166791002, -1368.9587283771111, -1307.4404384138907, -873.4754222892791, -591.8395609140308, 1812.2469599915512, -346.93197678831694, -1139.0993792189101, -146.08231999719513, 1904.7324781579164, -619.5507789418468, -847.8210306426766, 2124.148770684393, -1276.3277400416869, 1118.943297462414, -682.4664939550976, -1035.7279071532855, 599.2511036458966, 1633.0, -1633.0, 2207.5873708643785, -1023.1835123769425, -1184.4038584874368, 843.5783899555568, 255.97265478953005, -1099.551044745077, 404.0, -404.0, -765.8455131368256, -1052.2112466548876, -1082.8300488084, 2900.8868086001034, 0.0, 0.0, 1297.5664569454384, 759.4760060607101, -1752.518469066838, -304.5239939392857, 0.0, 0.0, 0.0, 0.0, -853.0341184434559, -1633.6116823877412, 344.9658815565441, 2141.679919274662, 764.0, -764.0, -672.0, 672.0, 363.4528855298877, -2037.8817433795748, 1674.4288578497574, 0.0, 0.0, -126.57211383239242, -393.8584771209089, 520.4305909533022, -100.12515309965258, -797.0771652210582, 2134.279483541736, -1237.077165221067, 974.7552759272311, -819.6493607141223, -272.697348592674, 117.59143337948478, 1592.0, -1592.0, 242.31375840624287, -1602.6485632674376, 1471.0127018922306, -110.6778970310307, -787.8285152959595, 96.6158260421137, -1217.7737777479422, 1908.9864670017719, 1208.0, -1208.0, 649.0, -649.0, -2047.0, 2047.0, -1179.454111019145, 1991.9198026025188, -812.4656915833496, 2.828427124746116, -1904.2385617352847, 1901.4101346106409, -919.0, 919.0, -122.32947314527318, -1356.937913096941, 1479.267386242277, -900.0, 900.0, 1142.6845583974502, -2542.0488783656056, 1399.3643199681553, -570.1852590989752, 2972.4359926486522, -970.1852590989915, -1432.0654744506203, -1161.0693347082977, -951.0586206959141, 2112.1279554042226, 1099.0, -1099.0, -2098.0, 2098.0, 1854.0, -1854.0, -667.1852590989777, -819.6057301650449, -1272.7116453781757, 2759.502634642211, 1716.8552647209117, 125.86500705120524, -1842.7202717721175, -629.7211574838374, 116.8537131674253, 1388.0402497698738, -875.1728054534948, 1024.5977259393146, -651.2453454728143, -373.3523804664995, 434.0, -434.0, 1102.0, -1102.0, -55.86143571373726, 1776.959341121817, -1721.0979054079592, 572.9609404556074, 421.2362230889238, -1231.8625723585094, 237.66540881397896, -1578.673169605224, 1266.9040242428787, 1278.4510296266324, -966.6818842642641, -1280.5703807287935, -1289.0556621030432, 2569.626042831837, 947.0, -947.0, -344.3610024378514, -1279.8632739476195, 1624.2242763855108, -845.1801043228419, -623.4776009540149, 2219.2737449941196, -750.6160397173354, 1180.0, -1180.0, -1591.6973644508687, 1096.0155108391557, 495.68185361177314, -31.81980515339477, -1826.4568158047746, 1858.2766209582433, -1055.6834791575616, 3256.542705308488, -1201.1757469933254, -999.6834791575651, 1163.7921568068857, 1168.410958960407, -1858.921880911186, -473.2812348561187, 996.0, -996.0, 2409.8199102837148, -795.4951288348717, -1614.324781448805, 1779.0806614653666, -658.3164132846811, -1120.7642481806706, -243.24473272817372, 1665.9435764755187, -1422.6988437472799, -1150.9010481314597, 143.72094380862248, 2018.0811524542703, -1010.9010481314781, 186.17553331812738, -665.9934640057701, 212.19615242270123, 267.62177826489665, -1795.0, 1795.0, 2430.892547147653, -504.8520491310601, -1828.1388661135634, -97.90163190292778, -164.04877323528035, -1031.6687937511792, 1195.7175669864673, 1353.0, -1353.0, 2014.0, -2014.0, 2271.0, -2271.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.556901871203129, "mean_inference_ms": 4.71846900251549, "mean_action_processing_ms": 0.9751622163820087, "mean_env_wait_ms": 19.746583888669505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016096830368041992, "StateBufferConnector_ms": 0.014273643493652344, "ViewRequirementAgentConnector_ms": 0.5657382011413574}, "num_episodes": 9, "episode_return_max": 4.276579090856103e-13, "episode_return_min": -7.771561172376096e-16, "episode_return_mean": 1.2485790179539434e-13, "episodes_this_iter": 9}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 718124, "num_agent_steps_trained": 71907, "num_env_steps_sampled": 240128, "num_env_steps_trained": 71907, "num_env_steps_sampled_this_iter": 27136, "num_env_steps_trained_this_iter": 10748, "num_env_steps_sampled_throughput_per_sec": 2713.590877716213, "num_env_steps_trained_throughput_per_sec": 1074.796386854874, "timesteps_total": 240128, "num_env_steps_sampled_lifetime": 240128, "num_agent_steps_sampled_lifetime": 718124, "num_steps_trained_this_iter": 10748, "agent_timesteps_total": 718124, "timers": {"training_iteration_time_ms": 10000.118, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.161, "sample_time_ms": 0.115, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 240128, "num_env_steps_trained": 71907, "num_agent_steps_sampled": 718124, "num_agent_steps_trained": 71907, "num_training_step_calls_since_last_synch_worker_weights": 97, "num_samples_added_to_queue": 28160, "num_times_learner_queue_full": 414, "num_weight_broadcasts": 27}, "done": false, "training_iteration": 10, "trial_id": "aec47_00000", "date": "2024-09-02_10-29-04", "timestamp": 1725240544, "time_this_iter_s": 43.49669122695923, "time_total_s": 445.2274646759033, "pid": 3866939, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.4, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 0.4, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ecf73628c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 445.2274646759033, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 51.596721311475406, "ram_util_percent": 41.16229508196722}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -39077.15234375, "policy_loss": -43600.7890625, "entropy": 15.096328735351562, "entropy_coeff": 0.01, "var_gnorm": 2049.299560546875, "vf_loss": 9201.8564453125, "vf_explained_var": -0.0013579130172729492}, "model": {}, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 267776, "num_env_steps_trained": 83683, "num_agent_steps_sampled": 795510, "num_agent_steps_trained": 83683, "num_training_step_calls_since_last_synch_worker_weights": 581, "num_samples_added_to_queue": 32256, "num_times_learner_queue_full": 460, "num_weight_broadcasts": 32, "learner_queue": {"size_count": 63, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 43.67, "learner_load_time_ms": 133.613, "learner_load_wait_time_ms": 4330.37, "learner_dequeue_time_ms": 55520.714}}, "env_runners": {"episode_reward_max": 4.2743586448068527e-13, "episode_reward_min": -1.1102230246251565e-15, "episode_reward_mean": 1.0062839450597494e-13, "episode_len_mean": 2030.83, "episode_media": {}, "episodes_timesteps_total": 203083, "policy_reward_min": {"default_policy": -2542.0488783656056}, "policy_reward_max": {"default_policy": 3256.542705308488}, "policy_reward_mean": {"default_policy": 1.3271198199339667e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 7.860379014346108e-14, -2.220446049250313e-16, 3.310685059432217e-13, 2.220446049250313e-16, 3.823608096809039e-13, 4.234390615920347e-13, 1.1102230246251565e-16, -3.3306690738754696e-16, 3.559375016948252e-13, -2.220446049250313e-16, 0.0, 4.0478731477833207e-13, 3.170796958329447e-13, 0.0, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 3.885780586188048e-13, 0.0, 9.57012247226885e-14, -3.3306690738754696e-16, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 1.2856382625159313e-13, 0.0, 0.0, 0.0, 4.192202140984591e-13, 3.9834802123550617e-13, 0.0, 3.133049375492192e-13, 0.0, 4.1255887595070817e-13, -2.220446049250313e-16, 3.956834859764058e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 3.8702374638432957e-13, 1.9095836023552692e-14, 2.020605904817785e-13, 0.0, 0.0, 4.1455727739503345e-13, 2.220446049250313e-16, -3.3306690738754696e-16, 4.2743586448068527e-13, 0.0, 4.2010839251815923e-13, -3.3306690738754696e-16, 0.0, 4.001243780749064e-13, 4.1033842990145786e-13, 2.220446049250313e-16, 4.440892098500626e-16, 0.0, 4.212186155427844e-13, 3.914646384828302e-13, 3.232969447708456e-13, -7.771561172376096e-16, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 3.4305891460917337e-13, 0.0, 0.0, 0.0, -2.220446049250313e-16, 3.668176873361517e-13, 0.0, 0.0, 0.0, 2.220446049250313e-16, 2.824407374646398e-13, 0.0, 0.0, 0.0, 6.139533326177116e-14, 0.0, 0.0, 0.0, 0.0, 0.0, 3.4772185131259903e-13, 1.1102230246251565e-16, -1.1102230246251565e-15, -2.220446049250313e-16], "episode_lengths": [2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 1444, 2048, 2048, 2048, 2048, 2048, 2048, 1025, 2048, 1024, 2048, 1024, 1024, 2047, 1024, 1024, 2048, 2560, 2048, 2048, 2048, 1997, 2048, 2048, 2561, 2126, 2560, 2048, 2048, 2560, 2048, 2560, 2048, 2048, 2047, 2560, 2349, 2560, 2048, 2048, 2048, 2048, 1024, 2048, 2048, 2048, 2048, 2048, 1587, 2048, 2047, 1458, 2048, 2048, 2048, 2048, 2049, 2048, 2048, 2048, 2048, 1235, 2560, 2048, 2048, 2560, 2560, 2560, 2048, 2048, 2048, 2560, 2560, 2048, 2048, 2300, 2092, 2026, 2048, 2560, 2048, 2198, 2048, 2048, 2048, 2047, 2048, 2048], "policy_default_policy_reward": [-1329.0690343334752, 1019.6092900479352, -1174.3391621906662, 1483.79890647632, 1553.5059808498143, -938.0505938937215, 491.46867261978184, -1106.9240595759818, -576.0, 576.0, -1866.0, 1866.0, -1266.1697947705202, -168.44188761730007, -526.687836487043, 1961.2995188748496, 766.1999259807349, -196.0904508847442, -1218.8425370254056, 648.7330619293825, -287.08535316173993, 463.86204845837767, -176.77669529663768, -1224.2697577609072, 2240.406231534637, -362.2887819721987, -653.8476918015696, -614.4757928511141, -1274.2064196981275, 1888.682212549283, 935.572409168224, 1251.9603566841856, -1372.0492126755603, -815.4835531768126, -1475.7318523362628, -701.4499269370601, 2177.181779273376, 2676.399166791002, -1368.9587283771111, -1307.4404384138907, -873.4754222892791, -591.8395609140308, 1812.2469599915512, -346.93197678831694, -1139.0993792189101, -146.08231999719513, 1904.7324781579164, -619.5507789418468, -847.8210306426766, 2124.148770684393, -1276.3277400416869, 1118.943297462414, -682.4664939550976, -1035.7279071532855, 599.2511036458966, 1633.0, -1633.0, 2207.5873708643785, -1023.1835123769425, -1184.4038584874368, 843.5783899555568, 255.97265478953005, -1099.551044745077, 404.0, -404.0, -765.8455131368256, -1052.2112466548876, -1082.8300488084, 2900.8868086001034, 0.0, 0.0, 1297.5664569454384, 759.4760060607101, -1752.518469066838, -304.5239939392857, 0.0, 0.0, 0.0, 0.0, -853.0341184434559, -1633.6116823877412, 344.9658815565441, 2141.679919274662, 764.0, -764.0, -672.0, 672.0, 363.4528855298877, -2037.8817433795748, 1674.4288578497574, 0.0, 0.0, -126.57211383239242, -393.8584771209089, 520.4305909533022, -100.12515309965258, -797.0771652210582, 2134.279483541736, -1237.077165221067, 974.7552759272311, -819.6493607141223, -272.697348592674, 117.59143337948478, 1592.0, -1592.0, 242.31375840624287, -1602.6485632674376, 1471.0127018922306, -110.6778970310307, -787.8285152959595, 96.6158260421137, -1217.7737777479422, 1908.9864670017719, 1208.0, -1208.0, 649.0, -649.0, -2047.0, 2047.0, -1179.454111019145, 1991.9198026025188, -812.4656915833496, 2.828427124746116, -1904.2385617352847, 1901.4101346106409, -919.0, 919.0, -122.32947314527318, -1356.937913096941, 1479.267386242277, -900.0, 900.0, 1142.6845583974502, -2542.0488783656056, 1399.3643199681553, -570.1852590989752, 2972.4359926486522, -970.1852590989915, -1432.0654744506203, -1161.0693347082977, -951.0586206959141, 2112.1279554042226, 1099.0, -1099.0, -2098.0, 2098.0, 1854.0, -1854.0, -667.1852590989777, -819.6057301650449, -1272.7116453781757, 2759.502634642211, 1716.8552647209117, 125.86500705120524, -1842.7202717721175, -629.7211574838374, 116.8537131674253, 1388.0402497698738, -875.1728054534948, 1024.5977259393146, -651.2453454728143, -373.3523804664995, 434.0, -434.0, 1102.0, -1102.0, -55.86143571373726, 1776.959341121817, -1721.0979054079592, 572.9609404556074, 421.2362230889238, -1231.8625723585094, 237.66540881397896, -1578.673169605224, 1266.9040242428787, 1278.4510296266324, -966.6818842642641, -1280.5703807287935, -1289.0556621030432, 2569.626042831837, 947.0, -947.0, -344.3610024378514, -1279.8632739476195, 1624.2242763855108, -845.1801043228419, -623.4776009540149, 2219.2737449941196, -750.6160397173354, 1180.0, -1180.0, -1591.6973644508687, 1096.0155108391557, 495.68185361177314, -31.81980515339477, -1826.4568158047746, 1858.2766209582433, -1055.6834791575616, 3256.542705308488, -1201.1757469933254, -999.6834791575651, 1163.7921568068857, 1168.410958960407, -1858.921880911186, -473.2812348561187, 996.0, -996.0, 2409.8199102837148, -795.4951288348717, -1614.324781448805, 1779.0806614653666, -658.3164132846811, -1120.7642481806706, -243.24473272817372, 1665.9435764755187, -1422.6988437472799, -1150.9010481314597, 143.72094380862248, 2018.0811524542703, -1010.9010481314781, 186.17553331812738, -665.9934640057701, 212.19615242270123, 267.62177826489665, -1795.0, 1795.0, 2430.892547147653, -504.8520491310601, -1828.1388661135634, -97.90163190292778, -164.04877323528035, -1031.6687937511792, 1195.7175669864673, 1353.0, -1353.0, 2014.0, -2014.0, 2271.0, -2271.0, -425.54780283046114, -1002.2348418708401, 1310.0484152289732, 117.73422947231109, -1378.1511165325915, -427.79960261786346, 1805.950719150408, -485.0, 485.0, 1333.0, -1333.0, -1192.0, 1192.0, 857.6108849411528, 66.14954576223764, 1019.2689603142643, -1943.0293910175799, 1678.5430355183794, -516.7665940288725, -1161.7764414894837, -1989.0, 1989.0, 342.0, -342.0, 1532.0, -1532.0, -886.8796529799357, -1071.5095407327126, 2883.268846692478, -924.8796529799376, 116.0, -116.0, -1657.0, 1657.0, 1405.0, -1405.0, 193.0, -193.0, 74.0, -74.0, -1156.8266940211788, 1346.3313113791949, -189.5046173579963, -1037.262210644858, -605.4042092910169, 700.0896534380779, 942.5767664977604, -1088.052772558457, 979.5109219507808, 1275.1142597759183, -1166.5724091682346, 645.3909236273132, 1256.3120070918505, -1163.851465359602, -737.8514653596117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.803998336319356, "mean_inference_ms": 4.688417190072691, "mean_action_processing_ms": 0.9660882515791009, "mean_env_wait_ms": 19.33876588983478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015813827514648438, "StateBufferConnector_ms": 0.014370441436767578, "ViewRequirementAgentConnector_ms": 0.5643339157104492}, "num_episodes": 20, "episode_return_max": 4.2743586448068527e-13, "episode_return_min": -1.1102230246251565e-15, "episode_return_mean": 1.0062839450597494e-13, "episodes_this_iter": 20}, "num_healthy_workers": 25, "num_in_flight_async_sample_reqs": 50, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 795510, "num_agent_steps_trained": 83683, "num_env_steps_sampled": 267776, "num_env_steps_trained": 83683, "num_env_steps_sampled_this_iter": 27648, "num_env_steps_trained_this_iter": 11776, "num_env_steps_sampled_throughput_per_sec": 2764.7753468995156, "num_env_steps_trained_throughput_per_sec": 1177.5894996053491, "timesteps_total": 267776, "num_env_steps_sampled_lifetime": 267776, "num_agent_steps_sampled_lifetime": 795510, "num_steps_trained_this_iter": 11776, "agent_timesteps_total": 795510, "timers": {"training_iteration_time_ms": 10000.123, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.163, "sample_time_ms": 0.116, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 267776, "num_env_steps_trained": 83683, "num_agent_steps_sampled": 795510, "num_agent_steps_trained": 83683, "num_training_step_calls_since_last_synch_worker_weights": 581, "num_samples_added_to_queue": 32256, "num_times_learner_queue_full": 460, "num_weight_broadcasts": 32}, "done": false, "training_iteration": 11, "trial_id": "aec47_00000", "date": "2024-09-02_10-29-51", "timestamp": 1725240591, "time_this_iter_s": 46.43087363243103, "time_total_s": 491.65833830833435, "pid": 3866939, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.4, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 25, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 0.4, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 64, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ecf73628c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 491.65833830833435, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 55.63484848484848, "ram_util_percent": 40.55151515151516}}
