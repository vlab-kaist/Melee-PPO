{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 75668, "learner_queue": {"size_count": 0, "size_mean": NaN, "size_std": NaN, "size_quantiles": 1.0}, "timing_breakdown": {"learner_grad_time_ms": 0.0, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 0.0, "learner_dequeue_time_ms": 0.0}}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 16, "num_in_flight_async_sample_reqs": 32, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 0, "num_env_steps_sampled_lifetime": 0, "num_agent_steps_sampled_lifetime": 0, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 0, "timers": {"training_iteration_time_ms": 10000.03, "restore_workers_time_ms": 0.005, "training_step_time_ms": 0.121, "sample_time_ms": 0.102, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 0, "num_env_steps_trained": 0, "num_agent_steps_sampled": 0, "num_agent_steps_trained": 0, "num_training_step_calls_since_last_synch_worker_weights": 75668}, "done": false, "training_iteration": 1, "trial_id": "15bea_00000", "date": "2024-09-01_19-38-01", "timestamp": 1725187081, "time_this_iter_s": 64.95525598526001, "time_total_s": 64.95525598526001, "pid": 2164158, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 16, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 256, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79eda3566b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 64.95525598526001, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 26.726881720430107, "ram_util_percent": 33.880645161290325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 825.988525390625, "policy_loss": 113.6168212890625, "entropy": 11.625459671020508, "entropy_coeff": 0.01, "var_gnorm": 2047.54638671875, "vf_loss": 2377.10107421875, "vf_explained_var": 0.02223867177963257}, "model": {}, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_training_step_calls_since_last_synch_worker_weights": 57962, "num_samples_added_to_queue": 16384, "num_weight_broadcasts": 1, "learner_queue": {"size_count": 4, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 121.542, "learner_load_time_ms": 546.513, "learner_load_wait_time_ms": 16908.598, "learner_dequeue_time_ms": 65077.579}}, "env_runners": {"episode_reward_max": 1.8052226380405045e-13, "episode_reward_min": 0.0, "episode_reward_mean": 7.551224602873565e-14, "episode_len_mean": 1026.0, "episode_media": {}, "episodes_timesteps_total": 13338, "policy_reward_min": {"default_policy": -1087.5302294649175}, "policy_reward_max": {"default_policy": 885.2976900455635}, "policy_reward_mean": {"default_policy": 0.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 1.7075230118734908e-13, 1.8052226380405045e-13, 1.6253665080512292e-13, 1.1834977442504169e-13, 9.103828801926284e-14, 0.0, 0.0, 1.0635936575909e-13, 1.5210055437364645e-13], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026], "policy_default_policy_reward": [302.0, -302.0, 415.0, -415.0, 863.0, -863.0, 792.0, -792.0, 543.7651147324588, 543.7651147324588, -1087.5302294649175, -352.13917703090306, 324.5620125646267, 27.577164466274706, 502.04581464245217, 334.46150750123905, -836.5073221436912, -416.4858941188791, 714.1778489984175, -297.6919548795383, 244.6589462905468, -557.2001435750027, 312.5411972844559, 0.0, 0.0, -496.0, 496.0, 518.3092706097427, -149.90663761154858, -368.402632998193, -567.806745292801, -317.4909447527618, 885.2976900455635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.9648969131631855, "mean_inference_ms": 3.6530814407313694, "mean_action_processing_ms": 0.7132789315943578, "mean_env_wait_ms": 37.02482875727021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009954892672025241, "StateBufferConnector_ms": 0.009964062617375301, "ViewRequirementAgentConnector_ms": 0.40473387791560245}, "num_episodes": 13, "episode_return_max": 1.8052226380405045e-13, "episode_return_min": 0.0, "episode_return_mean": 7.551224602873565e-14, "episodes_this_iter": 13}, "num_healthy_workers": 16, "num_in_flight_async_sample_reqs": 32, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_env_steps_sampled": 16384, "num_env_steps_trained": 46080, "num_env_steps_sampled_this_iter": 16384, "num_env_steps_trained_this_iter": 46080, "num_env_steps_sampled_throughput_per_sec": 1638.3851173226906, "num_env_steps_trained_throughput_per_sec": 4607.958142470067, "timesteps_total": 16384, "num_env_steps_sampled_lifetime": 16384, "num_agent_steps_sampled_lifetime": 46080, "num_steps_trained_this_iter": 46080, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 10000.065, "restore_workers_time_ms": 0.005, "training_step_time_ms": 0.14, "sample_time_ms": 0.097, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_training_step_calls_since_last_synch_worker_weights": 57962, "num_samples_added_to_queue": 16384, "num_weight_broadcasts": 1}, "done": false, "training_iteration": 2, "trial_id": "15bea_00000", "date": "2024-09-01_19-39-06", "timestamp": 1725187146, "time_this_iter_s": 64.94193911552429, "time_total_s": 129.8971951007843, "pid": 2164158, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 16, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 256, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79eda3566b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 129.8971951007843, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.6445652173913, "ram_util_percent": 34.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 2283.32958984375, "policy_loss": 660.6717529296875, "entropy": 11.681750297546387, "entropy_coeff": 0.01, "var_gnorm": 2047.5465087890625, "vf_loss": 4202.28466796875, "vf_explained_var": -0.0034780502319335938}, "model": {}, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 97270, "num_agent_steps_sampled": 97270, "num_agent_steps_trained": 97270, "num_training_step_calls_since_last_synch_worker_weights": 55927, "num_samples_added_to_queue": 32768, "num_weight_broadcasts": 2, "learner_queue": {"size_count": 8, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 132.945, "learner_load_time_ms": 546.513, "learner_load_wait_time_ms": 16572.211, "learner_dequeue_time_ms": 65077.579}}, "env_runners": {"episode_reward_max": 1.8052226380405045e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 6.07708328104195e-14, "episode_len_mean": 1153.3333333333333, "episode_media": {}, "episodes_timesteps_total": 27680, "policy_reward_min": {"default_policy": -1896.0182840186228}, "policy_reward_max": {"default_policy": 2438.0865209056556}, "policy_reward_mean": {"default_policy": 1.0197364838060104e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 1.7075230118734908e-13, 1.8052226380405045e-13, 1.6253665080512292e-13, 1.1834977442504169e-13, 9.103828801926284e-14, 0.0, 0.0, 1.0635936575909e-13, 1.5210055437364645e-13, 1.7630341631047486e-13, 1.0325074129013956e-13, 0.0, 1.2390088954816747e-13, 0.0, 2.220446049250313e-16, 7.127631818093505e-14, 1.9984014443252818e-15, 1.1102230246251565e-16, -2.220446049250313e-16, 0.0], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1024, 1024, 1024, 1024, 1024, 2050, 1024, 1024, 2050, 2050, 1024], "policy_default_policy_reward": [302.0, -302.0, 415.0, -415.0, 863.0, -863.0, 792.0, -792.0, 543.7651147324588, 543.7651147324588, -1087.5302294649175, -352.13917703090306, 324.5620125646267, 27.577164466274706, 502.04581464245217, 334.46150750123905, -836.5073221436912, -416.4858941188791, 714.1778489984175, -297.6919548795383, 244.6589462905468, -557.2001435750027, 312.5411972844559, 0.0, 0.0, -496.0, 496.0, 518.3092706097427, -149.90663761154858, -368.402632998193, -567.806745292801, -317.4909447527618, 885.2976900455635, 1029.5474734076204, -374.7665940288726, -654.780879378747, -555.078823231443, 123.74368670764622, 431.33513652379685, 1.0, -1.0, 728.3199846221486, -272.9432175380089, -455.3767670841391, -277.0, 277.0, -729.1297241043178, -820.4783984006694, -888.4783984006727, 2438.0865209056556, 318.19805153394833, -362.74577874870056, 44.547727214752456, 6.363961030678929, 6.363961030678929, -12.727922061357855, -182.44268506392092, -182.44268506392092, 2260.9036541465716, -1896.0182840186228, -1473.5176716202075, 1020.8750605755466, 1535.871500692689, -1083.2288896480643, 804.0, -804.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.300542467336068, "mean_inference_ms": 3.700934333933795, "mean_action_processing_ms": 0.7296512866747129, "mean_env_wait_ms": 37.34476010897613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013879934946695963, "StateBufferConnector_ms": 0.010817249615987143, "ViewRequirementAgentConnector_ms": 0.44937630494435626}, "num_episodes": 11, "episode_return_max": 1.8052226380405045e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 6.07708328104195e-14, "episodes_this_iter": 11}, "num_healthy_workers": 16, "num_in_flight_async_sample_reqs": 32, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97270, "num_agent_steps_trained": 97270, "num_env_steps_sampled": 32768, "num_env_steps_trained": 97270, "num_env_steps_sampled_this_iter": 16384, "num_env_steps_trained_this_iter": 51190, "num_env_steps_sampled_throughput_per_sec": 1638.3878907144995, "num_env_steps_trained_throughput_per_sec": 5118.962165873732, "timesteps_total": 32768, "num_env_steps_sampled_lifetime": 32768, "num_agent_steps_sampled_lifetime": 97270, "num_steps_trained_this_iter": 51190, "agent_timesteps_total": 97270, "timers": {"training_iteration_time_ms": 10000.071, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.167, "sample_time_ms": 0.112, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 97270, "num_agent_steps_sampled": 97270, "num_agent_steps_trained": 97270, "num_training_step_calls_since_last_synch_worker_weights": 55927, "num_samples_added_to_queue": 32768, "num_weight_broadcasts": 2}, "done": false, "training_iteration": 3, "trial_id": "15bea_00000", "date": "2024-09-01_19-40-13", "timestamp": 1725187213, "time_this_iter_s": 66.80036425590515, "time_total_s": 196.69755935668945, "pid": 2164158, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 16, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 256, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79eda3566b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 196.69755935668945, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.894736842105257, "ram_util_percent": 34.63263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 27315.689453125, "policy_loss": 3072.32421875, "entropy": 11.916316986083984, "entropy_coeff": 0.01, "var_gnorm": 2047.5465087890625, "vf_loss": 49462.9140625, "vf_explained_var": 0.020859241485595703}, "model": {}, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 145404, "num_agent_steps_sampled": 145404, "num_agent_steps_trained": 145404, "num_training_step_calls_since_last_synch_worker_weights": 56712, "num_samples_added_to_queue": 49152, "num_weight_broadcasts": 3, "learner_queue": {"size_count": 12, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 121.342, "learner_load_time_ms": 583.452, "learner_load_wait_time_ms": 13211.34, "learner_dequeue_time_ms": 97289.844}}, "env_runners": {"episode_reward_max": 2.7711166694643907e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 6.460229177004553e-14, "episode_len_mean": 1229.7142857142858, "episode_media": {}, "episodes_timesteps_total": 43040, "policy_reward_min": {"default_policy": -1896.0182840186228}, "policy_reward_max": {"default_policy": 2438.0865209056556}, "policy_reward_mean": {"default_policy": 1.064202563414715e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 1.7075230118734908e-13, 1.8052226380405045e-13, 1.6253665080512292e-13, 1.1834977442504169e-13, 9.103828801926284e-14, 0.0, 0.0, 1.0635936575909e-13, 1.5210055437364645e-13, 1.7630341631047486e-13, 1.0325074129013956e-13, 0.0, 1.2390088954816747e-13, 0.0, 2.220446049250313e-16, 7.127631818093505e-14, 1.9984014443252818e-15, 1.1102230246251565e-16, -2.220446049250313e-16, 0.0, 0.0, 1.9984014443252818e-14, 1.5054624213917123e-13, 1.7896795156957523e-13, 0.0, 1.1102230246251565e-16, 1.7608137170554983e-13, -2.220446049250313e-16, 0.0, 2.7711166694643907e-13, 0.0], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1024, 1024, 1024, 1024, 1024, 2050, 1024, 1024, 2050, 2050, 1024, 1024, 1024, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 1024], "policy_default_policy_reward": [302.0, -302.0, 415.0, -415.0, 863.0, -863.0, 792.0, -792.0, 543.7651147324588, 543.7651147324588, -1087.5302294649175, -352.13917703090306, 324.5620125646267, 27.577164466274706, 502.04581464245217, 334.46150750123905, -836.5073221436912, -416.4858941188791, 714.1778489984175, -297.6919548795383, 244.6589462905468, -557.2001435750027, 312.5411972844559, 0.0, 0.0, -496.0, 496.0, 518.3092706097427, -149.90663761154858, -368.402632998193, -567.806745292801, -317.4909447527618, 885.2976900455635, 1029.5474734076204, -374.7665940288726, -654.780879378747, -555.078823231443, 123.74368670764622, 431.33513652379685, 1.0, -1.0, 728.3199846221486, -272.9432175380089, -455.3767670841391, -277.0, 277.0, -729.1297241043178, -820.4783984006694, -888.4783984006727, 2438.0865209056556, 318.19805153394833, -362.74577874870056, 44.547727214752456, 6.363961030678929, 6.363961030678929, -12.727922061357855, -182.44268506392092, -182.44268506392092, 2260.9036541465716, -1896.0182840186228, -1473.5176716202075, 1020.8750605755466, 1535.871500692689, -1083.2288896480643, 804.0, -804.0, 216.0, -216.0, -79.90306627407995, -31.112698372208065, 111.01576464628782, -729.7341981845217, 21.213203435596434, 708.5209947489257, 803.9804102091103, 101.82337649086304, -905.8037866999734, 727.0, -727.0, -1299.0113206740796, 207.8193119057055, 1891.3726968626427, -800.1806880942969, 611.6473657263679, -1070.559666716433, 458.9123009900724, -48.7225387019402, 2355.3639822036744, -760.72253870195, -1545.918904799743, 442.0, -442.0, -354.9676041556491, -1146.220092303382, 1501.1876964590465, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.558866686775985, "mean_inference_ms": 3.721897524387545, "mean_action_processing_ms": 0.7411608770698622, "mean_env_wait_ms": 37.32863743439736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014521053859165736, "StateBufferConnector_ms": 0.011277198791503906, "ViewRequirementAgentConnector_ms": 0.46488285064697266}, "num_episodes": 11, "episode_return_max": 2.7711166694643907e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 6.460229177004553e-14, "episodes_this_iter": 11}, "num_healthy_workers": 16, "num_in_flight_async_sample_reqs": 32, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145404, "num_agent_steps_trained": 145404, "num_env_steps_sampled": 49152, "num_env_steps_trained": 145404, "num_env_steps_sampled_this_iter": 16384, "num_env_steps_trained_this_iter": 48134, "num_env_steps_sampled_throughput_per_sec": 1638.3931250288485, "num_env_steps_trained_throughput_per_sec": 4813.3798022545525, "timesteps_total": 49152, "num_env_steps_sampled_lifetime": 49152, "num_agent_steps_sampled_lifetime": 145404, "num_steps_trained_this_iter": 48134, "agent_timesteps_total": 145404, "timers": {"training_iteration_time_ms": 10000.066, "restore_workers_time_ms": 0.004, "training_step_time_ms": 0.135, "sample_time_ms": 0.095, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 145404, "num_agent_steps_sampled": 145404, "num_agent_steps_trained": 145404, "num_training_step_calls_since_last_synch_worker_weights": 56712, "num_samples_added_to_queue": 49152, "num_weight_broadcasts": 3}, "done": false, "training_iteration": 4, "trial_id": "15bea_00000", "date": "2024-09-01_19-41-23", "timestamp": 1725187283, "time_this_iter_s": 70.00742650032043, "time_total_s": 266.7049858570099, "pid": 2164158, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 16, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 256, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79eda3566b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 266.7049858570099, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.164, "ram_util_percent": 34.721000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": -47423.8671875, "policy_loss": -78193.890625, "entropy": 11.885082244873047, "entropy_coeff": 0.01, "var_gnorm": 2047.546630859375, "vf_loss": 62513.671875, "vf_explained_var": 0.0016030669212341309}, "model": {}, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 196214, "num_agent_steps_sampled": 196214, "num_agent_steps_trained": 196214, "num_training_step_calls_since_last_synch_worker_weights": 55984, "num_samples_added_to_queue": 65536, "num_weight_broadcasts": 5, "learner_queue": {"size_count": 16, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 125.434, "learner_load_time_ms": 583.452, "learner_load_wait_time_ms": 13677.361, "learner_dequeue_time_ms": 97289.844}}, "env_runners": {"episode_reward_max": 4.241051954068098e-13, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 9.084458953411547e-14, "episode_len_mean": 1264.340425531915, "episode_media": {}, "episodes_timesteps_total": 59424, "policy_reward_min": {"default_policy": -2053.438092565647}, "policy_reward_max": {"default_policy": 2643.290804215879}, "policy_reward_mean": {"default_policy": 2.1824427786861742e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 1.7075230118734908e-13, 1.8052226380405045e-13, 1.6253665080512292e-13, 1.1834977442504169e-13, 9.103828801926284e-14, 0.0, 0.0, 1.0635936575909e-13, 1.5210055437364645e-13, 1.7630341631047486e-13, 1.0325074129013956e-13, 0.0, 1.2390088954816747e-13, 0.0, 2.220446049250313e-16, 7.127631818093505e-14, 1.9984014443252818e-15, 1.1102230246251565e-16, -2.220446049250313e-16, 0.0, 0.0, 1.9984014443252818e-14, 1.5054624213917123e-13, 1.7896795156957523e-13, 0.0, 1.1102230246251565e-16, 1.7608137170554983e-13, -2.220446049250313e-16, 0.0, 2.7711166694643907e-13, 0.0, 2.786659791809143e-13, 0.0, 2.0383694732117874e-13, 1.6076029396572267e-13, 1.9095836023552692e-13, 1.2612133559741778e-13, 8.104628079763643e-14, 1.7719159473017498e-13, 2.220446049250313e-16, 4.241051954068098e-13, 3.6570746431152656e-13, 0.0], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1024, 1024, 1024, 1024, 1024, 2050, 1024, 1024, 2050, 2050, 1024, 1024, 1024, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 1024], "policy_default_policy_reward": [302.0, -302.0, 415.0, -415.0, 863.0, -863.0, 792.0, -792.0, 543.7651147324588, 543.7651147324588, -1087.5302294649175, -352.13917703090306, 324.5620125646267, 27.577164466274706, 502.04581464245217, 334.46150750123905, -836.5073221436912, -416.4858941188791, 714.1778489984175, -297.6919548795383, 244.6589462905468, -557.2001435750027, 312.5411972844559, 0.0, 0.0, -496.0, 496.0, 518.3092706097427, -149.90663761154858, -368.402632998193, -567.806745292801, -317.4909447527618, 885.2976900455635, 1029.5474734076204, -374.7665940288726, -654.780879378747, -555.078823231443, 123.74368670764622, 431.33513652379685, 1.0, -1.0, 728.3199846221486, -272.9432175380089, -455.3767670841391, -277.0, 277.0, -729.1297241043178, -820.4783984006694, -888.4783984006727, 2438.0865209056556, 318.19805153394833, -362.74577874870056, 44.547727214752456, 6.363961030678929, 6.363961030678929, -12.727922061357855, -182.44268506392092, -182.44268506392092, 2260.9036541465716, -1896.0182840186228, -1473.5176716202075, 1020.8750605755466, 1535.871500692689, -1083.2288896480643, 804.0, -804.0, 216.0, -216.0, -79.90306627407995, -31.112698372208065, 111.01576464628782, -729.7341981845217, 21.213203435596434, 708.5209947489257, 803.9804102091103, 101.82337649086304, -905.8037866999734, 727.0, -727.0, -1299.0113206740796, 207.8193119057055, 1891.3726968626427, -800.1806880942969, 611.6473657263679, -1070.559666716433, 458.9123009900724, -48.7225387019402, 2355.3639822036744, -760.72253870195, -1545.918904799743, 442.0, -442.0, -354.9676041556491, -1146.220092303382, 1501.1876964590465, 0.0, 0.0, 1485.9652583074626, -1561.2917728598738, 75.32651455244547, 205.0, -205.0, -731.8555185280813, 4.242640687118131, 727.6128778409621, -702.1570337182461, 833.6788950189456, -131.52186130069828, -458.20519420888587, 1141.2703448350958, -683.0651506262092, -439.8204178980354, -325.26911934581386, 765.0895372438493, 217.08178182427125, -495.68185361177257, 278.60007178750135, -988.5352800988002, 284.2569260369938, 704.2783540618063, 2643.290804215879, -1116.7766924784903, -488.2570558686947, -1038.2570558687166, 55.15432893255056, -2053.438092565647, 1998.2837636331988, -573.463599542294, -1460.1755031501611, 2033.6391026925264, 631.0, -631.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.781099753394809, "mean_inference_ms": 3.747256032198274, "mean_action_processing_ms": 0.7508096656500088, "mean_env_wait_ms": 37.33012381437571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014096625307773022, "StateBufferConnector_ms": 0.011268575140770445, "ViewRequirementAgentConnector_ms": 0.46480817997709234}, "num_episodes": 12, "episode_return_max": 4.241051954068098e-13, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 9.084458953411547e-14, "episodes_this_iter": 12}, "num_healthy_workers": 16, "num_in_flight_async_sample_reqs": 32, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196214, "num_agent_steps_trained": 196214, "num_env_steps_sampled": 65536, "num_env_steps_trained": 196214, "num_env_steps_sampled_this_iter": 16384, "num_env_steps_trained_this_iter": 50810, "num_env_steps_sampled_throughput_per_sec": 1638.394335957081, "num_env_steps_trained_throughput_per_sec": 5080.982434691118, "timesteps_total": 65536, "num_env_steps_sampled_lifetime": 65536, "num_agent_steps_sampled_lifetime": 196214, "num_steps_trained_this_iter": 50810, "agent_timesteps_total": 196214, "timers": {"training_iteration_time_ms": 10000.062, "restore_workers_time_ms": 0.005, "training_step_time_ms": 0.139, "sample_time_ms": 0.095, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 196214, "num_agent_steps_sampled": 196214, "num_agent_steps_trained": 196214, "num_training_step_calls_since_last_synch_worker_weights": 55984, "num_samples_added_to_queue": 65536, "num_weight_broadcasts": 5}, "done": false, "training_iteration": 5, "trial_id": "15bea_00000", "date": "2024-09-01_19-42-33", "timestamp": 1725187353, "time_this_iter_s": 70.00762009620667, "time_total_s": 336.71260595321655, "pid": 2164158, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 16, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 256, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79eda3566b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 336.71260595321655, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.58282828282829, "ram_util_percent": 34.757575757575765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 22604.3671875, "policy_loss": -20002.23828125, "entropy": 12.111368179321289, "entropy_coeff": 0.01, "var_gnorm": 2047.5467529296875, "vf_loss": 86205.375, "vf_explained_var": -0.01700890064239502}, "model": {}, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 247540, "num_agent_steps_sampled": 247540, "num_agent_steps_trained": 247540, "num_training_step_calls_since_last_synch_worker_weights": 45033, "num_samples_added_to_queue": 81920, "num_weight_broadcasts": 7, "learner_queue": {"size_count": 20, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 122.235, "learner_load_time_ms": 605.484, "learner_load_wait_time_ms": 14048.64, "learner_dequeue_time_ms": 111329.153}}, "env_runners": {"episode_reward_max": 4.241051954068098e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 7.993417603907123e-14, "episode_len_mean": 1267.5254237288136, "episode_media": {}, "episodes_timesteps_total": 74784, "policy_reward_min": {"default_policy": -2053.438092565647}, "policy_reward_max": {"default_policy": 2643.290804215879}, "policy_reward_mean": {"default_policy": 2.637262331338566e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 1.7075230118734908e-13, 1.8052226380405045e-13, 1.6253665080512292e-13, 1.1834977442504169e-13, 9.103828801926284e-14, 0.0, 0.0, 1.0635936575909e-13, 1.5210055437364645e-13, 1.7630341631047486e-13, 1.0325074129013956e-13, 0.0, 1.2390088954816747e-13, 0.0, 2.220446049250313e-16, 7.127631818093505e-14, 1.9984014443252818e-15, 1.1102230246251565e-16, -2.220446049250313e-16, 0.0, 0.0, 1.9984014443252818e-14, 1.5054624213917123e-13, 1.7896795156957523e-13, 0.0, 1.1102230246251565e-16, 1.7608137170554983e-13, -2.220446049250313e-16, 0.0, 2.7711166694643907e-13, 0.0, 2.786659791809143e-13, 0.0, 2.0383694732117874e-13, 1.6076029396572267e-13, 1.9095836023552692e-13, 1.2612133559741778e-13, 8.104628079763643e-14, 1.7719159473017498e-13, 2.220446049250313e-16, 4.241051954068098e-13, 3.6570746431152656e-13, 0.0, 1.1102230246251565e-16, 0.0, 1.6009416015094757e-13, 1.3433698597964394e-13, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 1.5210055437364645e-13, 0.0, -3.3306690738754696e-16], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1024, 1024, 1024, 1024, 1024, 2050, 1024, 1024, 2050, 2050, 1024, 1024, 1024, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048], "policy_default_policy_reward": [302.0, -302.0, 415.0, -415.0, 863.0, -863.0, 792.0, -792.0, 543.7651147324588, 543.7651147324588, -1087.5302294649175, -352.13917703090306, 324.5620125646267, 27.577164466274706, 502.04581464245217, 334.46150750123905, -836.5073221436912, -416.4858941188791, 714.1778489984175, -297.6919548795383, 244.6589462905468, -557.2001435750027, 312.5411972844559, 0.0, 0.0, -496.0, 496.0, 518.3092706097427, -149.90663761154858, -368.402632998193, -567.806745292801, -317.4909447527618, 885.2976900455635, 1029.5474734076204, -374.7665940288726, -654.780879378747, -555.078823231443, 123.74368670764622, 431.33513652379685, 1.0, -1.0, 728.3199846221486, -272.9432175380089, -455.3767670841391, -277.0, 277.0, -729.1297241043178, -820.4783984006694, -888.4783984006727, 2438.0865209056556, 318.19805153394833, -362.74577874870056, 44.547727214752456, 6.363961030678929, 6.363961030678929, -12.727922061357855, -182.44268506392092, -182.44268506392092, 2260.9036541465716, -1896.0182840186228, -1473.5176716202075, 1020.8750605755466, 1535.871500692689, -1083.2288896480643, 804.0, -804.0, 216.0, -216.0, -79.90306627407995, -31.112698372208065, 111.01576464628782, -729.7341981845217, 21.213203435596434, 708.5209947489257, 803.9804102091103, 101.82337649086304, -905.8037866999734, 727.0, -727.0, -1299.0113206740796, 207.8193119057055, 1891.3726968626427, -800.1806880942969, 611.6473657263679, -1070.559666716433, 458.9123009900724, -48.7225387019402, 2355.3639822036744, -760.72253870195, -1545.918904799743, 442.0, -442.0, -354.9676041556491, -1146.220092303382, 1501.1876964590465, 0.0, 0.0, 1485.9652583074626, -1561.2917728598738, 75.32651455244547, 205.0, -205.0, -731.8555185280813, 4.242640687118131, 727.6128778409621, -702.1570337182461, 833.6788950189456, -131.52186130069828, -458.20519420888587, 1141.2703448350958, -683.0651506262092, -439.8204178980354, -325.26911934581386, 765.0895372438493, 217.08178182427125, -495.68185361177257, 278.60007178750135, -988.5352800988002, 284.2569260369938, 704.2783540618063, 2643.290804215879, -1116.7766924784903, -488.2570558686947, -1038.2570558687166, 55.15432893255056, -2053.438092565647, 1998.2837636331988, -573.463599542294, -1460.1755031501611, 2033.6391026925264, 631.0, -631.0, -1694.8516790346678, -341.5426480542957, 2329.9369751433665, -293.5426480542957, 103.0, -103.0, -1019.6479784710085, 509.82398923550426, 509.82398923550426, -855.5992052357282, 427.7996026178641, 427.7996026178641, -932.1297241043126, 373.2546635287475, 190.23919920032196, 368.63586137523043, -803.0, 803.0, 254.0, -254.0, 507.0, -507.0, -630.0, 630.0, 793.373808491312, -133.64318164425794, -659.7306268470529, -548.7019195973769, 633.7677641442725, -1124.459160514211, 1039.3933159672897, -1986.0529862335416, -67.58330249198795, 1594.6095037230666, 459.0267850025432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.996418035055489, "mean_inference_ms": 3.762049145430241, "mean_action_processing_ms": 0.7578548663891422, "mean_env_wait_ms": 37.38037716552455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014437255212816141, "StateBufferConnector_ms": 0.011358422748113082, "ViewRequirementAgentConnector_ms": 0.471061367099568}, "num_episodes": 12, "episode_return_max": 4.241051954068098e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 7.993417603907123e-14, "episodes_this_iter": 12}, "num_healthy_workers": 16, "num_in_flight_async_sample_reqs": 32, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247540, "num_agent_steps_trained": 247540, "num_env_steps_sampled": 81920, "num_env_steps_trained": 247540, "num_env_steps_sampled_this_iter": 16384, "num_env_steps_trained_this_iter": 51326, "num_env_steps_sampled_throughput_per_sec": 1638.3994921876574, "num_env_steps_trained_throughput_per_sec": 5132.598409181134, "timesteps_total": 81920, "num_env_steps_sampled_lifetime": 81920, "num_agent_steps_sampled_lifetime": 247540, "num_steps_trained_this_iter": 51326, "agent_timesteps_total": 247540, "timers": {"training_iteration_time_ms": 10000.054, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.152, "sample_time_ms": 0.104, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 247540, "num_agent_steps_sampled": 247540, "num_agent_steps_trained": 247540, "num_training_step_calls_since_last_synch_worker_weights": 45033, "num_samples_added_to_queue": 81920, "num_weight_broadcasts": 7}, "done": false, "training_iteration": 6, "trial_id": "15bea_00000", "date": "2024-09-01_19-43-43", "timestamp": 1725187423, "time_this_iter_s": 70.00820541381836, "time_total_s": 406.7208113670349, "pid": 2164158, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 16, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 256, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79eda3566b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 406.7208113670349, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 24.92, "ram_util_percent": 34.733}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 77200.5, "policy_loss": 27091.4296875, "entropy": 12.150127410888672, "entropy_coeff": 0.01, "var_gnorm": 2047.5467529296875, "vf_loss": 101213.4765625, "vf_explained_var": 0.02494215965270996}, "model": {}, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 6.68}}, "num_env_steps_sampled": 98304, "num_env_steps_trained": 300784, "num_agent_steps_sampled": 300784, "num_agent_steps_trained": 300784, "num_training_step_calls_since_last_synch_worker_weights": 49899, "num_samples_added_to_queue": 98304, "num_weight_broadcasts": 9, "learner_queue": {"size_count": 24, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 124.837, "learner_load_time_ms": 605.484, "learner_load_wait_time_ms": 14091.534, "learner_dequeue_time_ms": 111329.153}}, "env_runners": {"episode_reward_max": 4.241051954068098e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 8.263343061453014e-14, "episode_len_mean": 1269.6338028169014, "episode_media": {}, "episodes_timesteps_total": 90144, "policy_reward_min": {"default_policy": -2053.438092565647}, "policy_reward_max": {"default_policy": 2643.290804215879}, "policy_reward_mean": {"default_policy": 2.844943792740928e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 1.7075230118734908e-13, 1.8052226380405045e-13, 1.6253665080512292e-13, 1.1834977442504169e-13, 9.103828801926284e-14, 0.0, 0.0, 1.0635936575909e-13, 1.5210055437364645e-13, 1.7630341631047486e-13, 1.0325074129013956e-13, 0.0, 1.2390088954816747e-13, 0.0, 2.220446049250313e-16, 7.127631818093505e-14, 1.9984014443252818e-15, 1.1102230246251565e-16, -2.220446049250313e-16, 0.0, 0.0, 1.9984014443252818e-14, 1.5054624213917123e-13, 1.7896795156957523e-13, 0.0, 1.1102230246251565e-16, 1.7608137170554983e-13, -2.220446049250313e-16, 0.0, 2.7711166694643907e-13, 0.0, 2.786659791809143e-13, 0.0, 2.0383694732117874e-13, 1.6076029396572267e-13, 1.9095836023552692e-13, 1.2612133559741778e-13, 8.104628079763643e-14, 1.7719159473017498e-13, 2.220446049250313e-16, 4.241051954068098e-13, 3.6570746431152656e-13, 0.0, 1.1102230246251565e-16, 0.0, 1.6009416015094757e-13, 1.3433698597964394e-13, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 1.5210055437364645e-13, 0.0, -3.3306690738754696e-16, 0.0, 1.6497914145929826e-13, 1.6009416015094757e-13, 1.1102230246251565e-16, 1.5343282200319663e-13, 1.765254609153999e-13, 0.0, 2.220446049250313e-16, 1.4432899320127035e-13, 1.8851586958135158e-13, 1.1102230246251565e-16, 1.6253665080512292e-13], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1024, 1024, 1024, 1024, 1024, 2050, 1024, 1024, 2050, 2050, 1024, 1024, 1024, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 1024, 1024, 1024, 2048, 1024, 1024, 1024, 2048, 1024, 1024, 2048, 1024], "policy_default_policy_reward": [302.0, -302.0, 415.0, -415.0, 863.0, -863.0, 792.0, -792.0, 543.7651147324588, 543.7651147324588, -1087.5302294649175, -352.13917703090306, 324.5620125646267, 27.577164466274706, 502.04581464245217, 334.46150750123905, -836.5073221436912, -416.4858941188791, 714.1778489984175, -297.6919548795383, 244.6589462905468, -557.2001435750027, 312.5411972844559, 0.0, 0.0, -496.0, 496.0, 518.3092706097427, -149.90663761154858, -368.402632998193, -567.806745292801, -317.4909447527618, 885.2976900455635, 1029.5474734076204, -374.7665940288726, -654.780879378747, -555.078823231443, 123.74368670764622, 431.33513652379685, 1.0, -1.0, 728.3199846221486, -272.9432175380089, -455.3767670841391, -277.0, 277.0, -729.1297241043178, -820.4783984006694, -888.4783984006727, 2438.0865209056556, 318.19805153394833, -362.74577874870056, 44.547727214752456, 6.363961030678929, 6.363961030678929, -12.727922061357855, -182.44268506392092, -182.44268506392092, 2260.9036541465716, -1896.0182840186228, -1473.5176716202075, 1020.8750605755466, 1535.871500692689, -1083.2288896480643, 804.0, -804.0, 216.0, -216.0, -79.90306627407995, -31.112698372208065, 111.01576464628782, -729.7341981845217, 21.213203435596434, 708.5209947489257, 803.9804102091103, 101.82337649086304, -905.8037866999734, 727.0, -727.0, -1299.0113206740796, 207.8193119057055, 1891.3726968626427, -800.1806880942969, 611.6473657263679, -1070.559666716433, 458.9123009900724, -48.7225387019402, 2355.3639822036744, -760.72253870195, -1545.918904799743, 442.0, -442.0, -354.9676041556491, -1146.220092303382, 1501.1876964590465, 0.0, 0.0, 1485.9652583074626, -1561.2917728598738, 75.32651455244547, 205.0, -205.0, -731.8555185280813, 4.242640687118131, 727.6128778409621, -702.1570337182461, 833.6788950189456, -131.52186130069828, -458.20519420888587, 1141.2703448350958, -683.0651506262092, -439.8204178980354, -325.26911934581386, 765.0895372438493, 217.08178182427125, -495.68185361177257, 278.60007178750135, -988.5352800988002, 284.2569260369938, 704.2783540618063, 2643.290804215879, -1116.7766924784903, -488.2570558686947, -1038.2570558687166, 55.15432893255056, -2053.438092565647, 1998.2837636331988, -573.463599542294, -1460.1755031501611, 2033.6391026925264, 631.0, -631.0, -1694.8516790346678, -341.5426480542957, 2329.9369751433665, -293.5426480542957, 103.0, -103.0, -1019.6479784710085, 509.82398923550426, 509.82398923550426, -855.5992052357282, 427.7996026178641, 427.7996026178641, -932.1297241043126, 373.2546635287475, 190.23919920032196, 368.63586137523043, -803.0, 803.0, 254.0, -254.0, 507.0, -507.0, -630.0, 630.0, 793.373808491312, -133.64318164425794, -659.7306268470529, -548.7019195973769, 633.7677641442725, -1124.459160514211, 1039.3933159672897, -1986.0529862335416, -67.58330249198795, 1594.6095037230666, 459.0267850025432, 0.0, 0.0, 0.0, -290.62088706767213, 280.01428534987446, 10.606601717798199, -231.22391744800228, -649.1240251292546, 880.3479425772581, 1206.6412298265782, -907.5737903863607, -175.49364905391045, -123.57379038634235, -409.4148263070137, -528.2087655463545, 937.6235918533683, 994.8992411294797, -303.3488091290307, -691.5504320004478, -404.0, 404.0, 2471.1521517773776, -1433.0763677743482, -1536.9994162284643, 498.92363222557117, -451.13412639702034, 914.9961748553986, -463.8620484583783, 194.45436482630151, -997.7276682542254, 803.2733034279238, -1427.554766175006, -630.8113946933856, 2477.177555561808, -418.81139469337757, -397.3940110268423, 958.1296885077784, -560.7356774809359]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.218227038408197, "mean_inference_ms": 3.7699653787037963, "mean_action_processing_ms": 0.7631413408996003, "mean_env_wait_ms": 37.42993676719604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01418321905001788, "StateBufferConnector_ms": 0.011380625442719795, "ViewRequirementAgentConnector_ms": 0.4758492322035239}, "num_episodes": 12, "episode_return_max": 4.241051954068098e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 8.263343061453014e-14, "episodes_this_iter": 12}, "num_healthy_workers": 16, "num_in_flight_async_sample_reqs": 32, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300784, "num_agent_steps_trained": 300784, "num_env_steps_sampled": 98304, "num_env_steps_trained": 300784, "num_env_steps_sampled_this_iter": 16384, "num_env_steps_trained_this_iter": 53244, "num_env_steps_sampled_throughput_per_sec": 1638.3798049364293, "num_env_steps_trained_throughput_per_sec": 5324.33437097383, "timesteps_total": 98304, "num_env_steps_sampled_lifetime": 98304, "num_agent_steps_sampled_lifetime": 300784, "num_steps_trained_this_iter": 53244, "agent_timesteps_total": 300784, "timers": {"training_iteration_time_ms": 10000.065, "restore_workers_time_ms": 0.005, "training_step_time_ms": 0.126, "sample_time_ms": 0.089, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 98304, "num_env_steps_trained": 300784, "num_agent_steps_sampled": 300784, "num_agent_steps_trained": 300784, "num_training_step_calls_since_last_synch_worker_weights": 49899, "num_samples_added_to_queue": 98304, "num_weight_broadcasts": 9}, "done": false, "training_iteration": 7, "trial_id": "15bea_00000", "date": "2024-09-01_19-44-53", "timestamp": 1725187493, "time_this_iter_s": 70.00866842269897, "time_total_s": 476.7294797897339, "pid": 2164158, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 16, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 256, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79eda3566b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 476.7294797897339, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.366666666666667, "ram_util_percent": 34.71616161616162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 18410.77734375, "policy_loss": -8981.62109375, "entropy": 12.442962646484375, "entropy_coeff": 0.01, "var_gnorm": 2047.5467529296875, "vf_loss": 55804.125, "vf_explained_var": 0.06213301420211792}, "model": {}, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 114688, "num_env_steps_trained": 353010, "num_agent_steps_sampled": 353010, "num_agent_steps_trained": 353010, "num_training_step_calls_since_last_synch_worker_weights": 56738, "num_samples_added_to_queue": 114688, "num_weight_broadcasts": 10, "learner_queue": {"size_count": 28, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 117.729, "learner_load_time_ms": 605.462, "learner_load_wait_time_ms": 14071.827, "learner_dequeue_time_ms": 118352.692}}, "env_runners": {"episode_reward_max": 4.241051954068098e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 7.613015908737552e-14, "episode_len_mean": 1274.1463414634147, "episode_media": {}, "episodes_timesteps_total": 104480, "policy_reward_min": {"default_policy": -2053.438092565647}, "policy_reward_max": {"default_policy": 2643.290804215879}, "policy_reward_mean": {"default_policy": 2.2467602166678692e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 1.7075230118734908e-13, 1.8052226380405045e-13, 1.6253665080512292e-13, 1.1834977442504169e-13, 9.103828801926284e-14, 0.0, 0.0, 1.0635936575909e-13, 1.5210055437364645e-13, 1.7630341631047486e-13, 1.0325074129013956e-13, 0.0, 1.2390088954816747e-13, 0.0, 2.220446049250313e-16, 7.127631818093505e-14, 1.9984014443252818e-15, 1.1102230246251565e-16, -2.220446049250313e-16, 0.0, 0.0, 1.9984014443252818e-14, 1.5054624213917123e-13, 1.7896795156957523e-13, 0.0, 1.1102230246251565e-16, 1.7608137170554983e-13, -2.220446049250313e-16, 0.0, 2.7711166694643907e-13, 0.0, 2.786659791809143e-13, 0.0, 2.0383694732117874e-13, 1.6076029396572267e-13, 1.9095836023552692e-13, 1.2612133559741778e-13, 8.104628079763643e-14, 1.7719159473017498e-13, 2.220446049250313e-16, 4.241051954068098e-13, 3.6570746431152656e-13, 0.0, 1.1102230246251565e-16, 0.0, 1.6009416015094757e-13, 1.3433698597964394e-13, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 1.5210055437364645e-13, 0.0, -3.3306690738754696e-16, 0.0, 1.6497914145929826e-13, 1.6009416015094757e-13, 1.1102230246251565e-16, 1.5343282200319663e-13, 1.765254609153999e-13, 0.0, 2.220446049250313e-16, 1.4432899320127035e-13, 1.8851586958135158e-13, 1.1102230246251565e-16, 1.6253665080512292e-13, 2.220446049250313e-16, 1.1168843627729075e-13, 1.2079226507921703e-13, 2.220446049250313e-16, 0.0, 1.425526363618701e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1024, 1024, 1024, 1024, 1024, 2050, 1024, 1024, 2050, 2050, 1024, 1024, 1024, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 1024, 1024, 1024, 2048, 1024, 1024, 1024, 2048, 1024, 1024, 2048, 1024, 2048, 1024, 1024, 2048, 1024, 1024, 1024, 1024, 2048, 1024, 1024], "policy_default_policy_reward": [302.0, -302.0, 415.0, -415.0, 863.0, -863.0, 792.0, -792.0, 543.7651147324588, 543.7651147324588, -1087.5302294649175, -352.13917703090306, 324.5620125646267, 27.577164466274706, 502.04581464245217, 334.46150750123905, -836.5073221436912, -416.4858941188791, 714.1778489984175, -297.6919548795383, 244.6589462905468, -557.2001435750027, 312.5411972844559, 0.0, 0.0, -496.0, 496.0, 518.3092706097427, -149.90663761154858, -368.402632998193, -567.806745292801, -317.4909447527618, 885.2976900455635, 1029.5474734076204, -374.7665940288726, -654.780879378747, -555.078823231443, 123.74368670764622, 431.33513652379685, 1.0, -1.0, 728.3199846221486, -272.9432175380089, -455.3767670841391, -277.0, 277.0, -729.1297241043178, -820.4783984006694, -888.4783984006727, 2438.0865209056556, 318.19805153394833, -362.74577874870056, 44.547727214752456, 6.363961030678929, 6.363961030678929, -12.727922061357855, -182.44268506392092, -182.44268506392092, 2260.9036541465716, -1896.0182840186228, -1473.5176716202075, 1020.8750605755466, 1535.871500692689, -1083.2288896480643, 804.0, -804.0, 216.0, -216.0, -79.90306627407995, -31.112698372208065, 111.01576464628782, -729.7341981845217, 21.213203435596434, 708.5209947489257, 803.9804102091103, 101.82337649086304, -905.8037866999734, 727.0, -727.0, -1299.0113206740796, 207.8193119057055, 1891.3726968626427, -800.1806880942969, 611.6473657263679, -1070.559666716433, 458.9123009900724, -48.7225387019402, 2355.3639822036744, -760.72253870195, -1545.918904799743, 442.0, -442.0, -354.9676041556491, -1146.220092303382, 1501.1876964590465, 0.0, 0.0, 1485.9652583074626, -1561.2917728598738, 75.32651455244547, 205.0, -205.0, -731.8555185280813, 4.242640687118131, 727.6128778409621, -702.1570337182461, 833.6788950189456, -131.52186130069828, -458.20519420888587, 1141.2703448350958, -683.0651506262092, -439.8204178980354, -325.26911934581386, 765.0895372438493, 217.08178182427125, -495.68185361177257, 278.60007178750135, -988.5352800988002, 284.2569260369938, 704.2783540618063, 2643.290804215879, -1116.7766924784903, -488.2570558686947, -1038.2570558687166, 55.15432893255056, -2053.438092565647, 1998.2837636331988, -573.463599542294, -1460.1755031501611, 2033.6391026925264, 631.0, -631.0, -1694.8516790346678, -341.5426480542957, 2329.9369751433665, -293.5426480542957, 103.0, -103.0, -1019.6479784710085, 509.82398923550426, 509.82398923550426, -855.5992052357282, 427.7996026178641, 427.7996026178641, -932.1297241043126, 373.2546635287475, 190.23919920032196, 368.63586137523043, -803.0, 803.0, 254.0, -254.0, 507.0, -507.0, -630.0, 630.0, 793.373808491312, -133.64318164425794, -659.7306268470529, -548.7019195973769, 633.7677641442725, -1124.459160514211, 1039.3933159672897, -1986.0529862335416, -67.58330249198795, 1594.6095037230666, 459.0267850025432, 0.0, 0.0, 0.0, -290.62088706767213, 280.01428534987446, 10.606601717798199, -231.22391744800228, -649.1240251292546, 880.3479425772581, 1206.6412298265782, -907.5737903863607, -175.49364905391045, -123.57379038634235, -409.4148263070137, -528.2087655463545, 937.6235918533683, 994.8992411294797, -303.3488091290307, -691.5504320004478, -404.0, 404.0, 2471.1521517773776, -1433.0763677743482, -1536.9994162284643, 498.92363222557117, -451.13412639702034, 914.9961748553986, -463.8620484583783, 194.45436482630151, -997.7276682542254, 803.2733034279238, -1427.554766175006, -630.8113946933856, 2477.177555561808, -418.81139469337757, -397.3940110268423, 958.1296885077784, -560.7356774809359, -742.881810245009, -1016.881810245022, 1453.3586137523773, 306.4050067376042, -521.1376977344885, -24.74873734152914, 545.8864350760184, 318.19805153394833, -727.612877840962, 409.4148263070137, -83.27469886186938, -1211.1446046612803, 2401.6408597303302, -1107.2215562071658, 714.0, -714.0, 193.747258045115, -198.69700551341987, 4.949747468306415, 623.0, -623.0, -282.0, 282.0, 491.57676649771815, 1127.3133883100172, -889.445077403882, -729.4450774038745, 0.0, 0.0, 787.0, -787.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.353987364007336, "mean_inference_ms": 3.776672111317529, "mean_action_processing_ms": 0.7667144880282403, "mean_env_wait_ms": 37.51052280344446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014664487140934641, "StateBufferConnector_ms": 0.011655760974418826, "ViewRequirementAgentConnector_ms": 0.4777943215719083}, "num_episodes": 11, "episode_return_max": 4.241051954068098e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 7.613015908737552e-14, "episodes_this_iter": 11}, "num_healthy_workers": 16, "num_in_flight_async_sample_reqs": 32, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 353010, "num_agent_steps_trained": 353010, "num_env_steps_sampled": 114688, "num_env_steps_trained": 353010, "num_env_steps_sampled_this_iter": 16384, "num_env_steps_trained_this_iter": 52226, "num_env_steps_sampled_throughput_per_sec": 1638.382226755305, "num_env_steps_trained_throughput_per_sec": 5222.543345612949, "timesteps_total": 114688, "num_env_steps_sampled_lifetime": 114688, "num_agent_steps_sampled_lifetime": 353010, "num_steps_trained_this_iter": 52226, "agent_timesteps_total": 353010, "timers": {"training_iteration_time_ms": 10000.071, "restore_workers_time_ms": 0.005, "training_step_time_ms": 0.134, "sample_time_ms": 0.095, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 114688, "num_env_steps_trained": 353010, "num_agent_steps_sampled": 353010, "num_agent_steps_trained": 353010, "num_training_step_calls_since_last_synch_worker_weights": 56738, "num_samples_added_to_queue": 114688, "num_weight_broadcasts": 10}, "done": false, "training_iteration": 8, "trial_id": "15bea_00000", "date": "2024-09-01_19-45-58", "timestamp": 1725187558, "time_this_iter_s": 65.1103925704956, "time_total_s": 541.8398723602295, "pid": 2164158, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 16, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 256, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79eda3566b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 541.8398723602295, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.149462365591393, "ram_util_percent": 34.7978494623656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_lr": 0.0005, "total_loss": 72694.296875, "policy_loss": 14575.259765625, "entropy": 12.222284317016602, "entropy_coeff": 0.01, "var_gnorm": 2047.5467529296875, "vf_loss": 117239.328125, "vf_explained_var": 0.03719967603683472}, "model": {}, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 131072, "num_env_steps_trained": 408300, "num_agent_steps_sampled": 408300, "num_agent_steps_trained": 408300, "num_training_step_calls_since_last_synch_worker_weights": 57577, "num_samples_added_to_queue": 131072, "num_weight_broadcasts": 11, "learner_queue": {"size_count": 32, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 123.67, "learner_load_time_ms": 605.462, "learner_load_wait_time_ms": 13542.86, "learner_dequeue_time_ms": 118352.692}}, "env_runners": {"episode_reward_max": 4.241051954068098e-13, "episode_reward_min": -3.3306690738754696e-16, "episode_reward_mean": 7.112709465611984e-14, "episode_len_mean": 1299.6129032258063, "episode_media": {}, "episodes_timesteps_total": 120864, "policy_reward_min": {"default_policy": -2053.438092565647}, "policy_reward_max": {"default_policy": 2876.883832488707}, "policy_reward_mean": {"default_policy": 1.8609402661737592e-12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 1.7075230118734908e-13, 1.8052226380405045e-13, 1.6253665080512292e-13, 1.1834977442504169e-13, 9.103828801926284e-14, 0.0, 0.0, 1.0635936575909e-13, 1.5210055437364645e-13, 1.7630341631047486e-13, 1.0325074129013956e-13, 0.0, 1.2390088954816747e-13, 0.0, 2.220446049250313e-16, 7.127631818093505e-14, 1.9984014443252818e-15, 1.1102230246251565e-16, -2.220446049250313e-16, 0.0, 0.0, 1.9984014443252818e-14, 1.5054624213917123e-13, 1.7896795156957523e-13, 0.0, 1.1102230246251565e-16, 1.7608137170554983e-13, -2.220446049250313e-16, 0.0, 2.7711166694643907e-13, 0.0, 2.786659791809143e-13, 0.0, 2.0383694732117874e-13, 1.6076029396572267e-13, 1.9095836023552692e-13, 1.2612133559741778e-13, 8.104628079763643e-14, 1.7719159473017498e-13, 2.220446049250313e-16, 4.241051954068098e-13, 3.6570746431152656e-13, 0.0, 1.1102230246251565e-16, 0.0, 1.6009416015094757e-13, 1.3433698597964394e-13, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 1.5210055437364645e-13, 0.0, -3.3306690738754696e-16, 0.0, 1.6497914145929826e-13, 1.6009416015094757e-13, 1.1102230246251565e-16, 1.5343282200319663e-13, 1.765254609153999e-13, 0.0, 2.220446049250313e-16, 1.4432899320127035e-13, 1.8851586958135158e-13, 1.1102230246251565e-16, 1.6253665080512292e-13, 2.220446049250313e-16, 1.1168843627729075e-13, 1.2079226507921703e-13, 2.220446049250313e-16, 0.0, 1.425526363618701e-13, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, -2.220446049250313e-16, 1.4477308241112041e-13, 2.220446049250313e-16, 0.0, 2.220446049250313e-16, 2.220446049250313e-16, 1.6431300764452317e-13, 0.0, 6.23945339839338e-14, 2.220446049250313e-16, 0.0], "episode_lengths": [1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1026, 1024, 1024, 1024, 1024, 1024, 2050, 1024, 1024, 2050, 2050, 1024, 1024, 1024, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 2048, 1024, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 2048, 2048, 1024, 1024, 1024, 2048, 1024, 1024, 1024, 2048, 1024, 1024, 2048, 1024, 2048, 1024, 1024, 2048, 1024, 1024, 1024, 1024, 2048, 1024, 1024, 2048, 1024, 2048, 1024, 2048, 2048, 1024, 1024, 1024, 2048, 1024], "policy_default_policy_reward": [302.0, -302.0, 415.0, -415.0, 863.0, -863.0, 792.0, -792.0, 543.7651147324588, 543.7651147324588, -1087.5302294649175, -352.13917703090306, 324.5620125646267, 27.577164466274706, 502.04581464245217, 334.46150750123905, -836.5073221436912, -416.4858941188791, 714.1778489984175, -297.6919548795383, 244.6589462905468, -557.2001435750027, 312.5411972844559, 0.0, 0.0, -496.0, 496.0, 518.3092706097427, -149.90663761154858, -368.402632998193, -567.806745292801, -317.4909447527618, 885.2976900455635, 1029.5474734076204, -374.7665940288726, -654.780879378747, -555.078823231443, 123.74368670764622, 431.33513652379685, 1.0, -1.0, 728.3199846221486, -272.9432175380089, -455.3767670841391, -277.0, 277.0, -729.1297241043178, -820.4783984006694, -888.4783984006727, 2438.0865209056556, 318.19805153394833, -362.74577874870056, 44.547727214752456, 6.363961030678929, 6.363961030678929, -12.727922061357855, -182.44268506392092, -182.44268506392092, 2260.9036541465716, -1896.0182840186228, -1473.5176716202075, 1020.8750605755466, 1535.871500692689, -1083.2288896480643, 804.0, -804.0, 216.0, -216.0, -79.90306627407995, -31.112698372208065, 111.01576464628782, -729.7341981845217, 21.213203435596434, 708.5209947489257, 803.9804102091103, 101.82337649086304, -905.8037866999734, 727.0, -727.0, -1299.0113206740796, 207.8193119057055, 1891.3726968626427, -800.1806880942969, 611.6473657263679, -1070.559666716433, 458.9123009900724, -48.7225387019402, 2355.3639822036744, -760.72253870195, -1545.918904799743, 442.0, -442.0, -354.9676041556491, -1146.220092303382, 1501.1876964590465, 0.0, 0.0, 1485.9652583074626, -1561.2917728598738, 75.32651455244547, 205.0, -205.0, -731.8555185280813, 4.242640687118131, 727.6128778409621, -702.1570337182461, 833.6788950189456, -131.52186130069828, -458.20519420888587, 1141.2703448350958, -683.0651506262092, -439.8204178980354, -325.26911934581386, 765.0895372438493, 217.08178182427125, -495.68185361177257, 278.60007178750135, -988.5352800988002, 284.2569260369938, 704.2783540618063, 2643.290804215879, -1116.7766924784903, -488.2570558686947, -1038.2570558687166, 55.15432893255056, -2053.438092565647, 1998.2837636331988, -573.463599542294, -1460.1755031501611, 2033.6391026925264, 631.0, -631.0, -1694.8516790346678, -341.5426480542957, 2329.9369751433665, -293.5426480542957, 103.0, -103.0, -1019.6479784710085, 509.82398923550426, 509.82398923550426, -855.5992052357282, 427.7996026178641, 427.7996026178641, -932.1297241043126, 373.2546635287475, 190.23919920032196, 368.63586137523043, -803.0, 803.0, 254.0, -254.0, 507.0, -507.0, -630.0, 630.0, 793.373808491312, -133.64318164425794, -659.7306268470529, -548.7019195973769, 633.7677641442725, -1124.459160514211, 1039.3933159672897, -1986.0529862335416, -67.58330249198795, 1594.6095037230666, 459.0267850025432, 0.0, 0.0, 0.0, -290.62088706767213, 280.01428534987446, 10.606601717798199, -231.22391744800228, -649.1240251292546, 880.3479425772581, 1206.6412298265782, -907.5737903863607, -175.49364905391045, -123.57379038634235, -409.4148263070137, -528.2087655463545, 937.6235918533683, 994.8992411294797, -303.3488091290307, -691.5504320004478, -404.0, 404.0, 2471.1521517773776, -1433.0763677743482, -1536.9994162284643, 498.92363222557117, -451.13412639702034, 914.9961748553986, -463.8620484583783, 194.45436482630151, -997.7276682542254, 803.2733034279238, -1427.554766175006, -630.8113946933856, 2477.177555561808, -418.81139469337757, -397.3940110268423, 958.1296885077784, -560.7356774809359, -742.881810245009, -1016.881810245022, 1453.3586137523773, 306.4050067376042, -521.1376977344885, -24.74873734152914, 545.8864350760184, 318.19805153394833, -727.612877840962, 409.4148263070137, -83.27469886186938, -1211.1446046612803, 2401.6408597303302, -1107.2215562071658, 714.0, -714.0, 193.747258045115, -198.69700551341987, 4.949747468306415, 623.0, -623.0, -282.0, 282.0, 491.57676649771815, 1127.3133883100172, -889.445077403882, -729.4450774038745, 0.0, 0.0, 787.0, -787.0, -853.160068989727, -224.17553331814472, 2293.071640348636, -1215.7360380408088, 759.4326829943575, -623.6681810065387, -135.7645019878176, -1893.5997779422303, -812.8000740192557, 1353.1999259807444, 1353.1999259807444, 381.0, -381.0, -684.5353146134199, 807.3377809725806, -450.5353146134088, 327.7328482541907, -922.0809387791179, 2876.883832488707, -994.7219549304987, -960.0809387791196, -736.8052659963872, 832.971788237759, -96.16652224137063, 806.0, -806.0, 198.69700551342086, 198.69700551342086, -397.39401102684167, -1953.045652792631, -46.89567968013457, -294.89567968012426, 2294.837012152993, -314.0, 314.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.473554067790405, "mean_inference_ms": 3.7805392782444547, "mean_action_processing_ms": 0.7692264871274408, "mean_env_wait_ms": 37.50756405734482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014655308056903142, "StateBufferConnector_ms": 0.011778903263871389, "ViewRequirementAgentConnector_ms": 0.4850972083307082}, "num_episodes": 11, "episode_return_max": 4.241051954068098e-13, "episode_return_min": -3.3306690738754696e-16, "episode_return_mean": 7.112709465611984e-14, "episodes_this_iter": 11}, "num_healthy_workers": 16, "num_in_flight_async_sample_reqs": 32, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408300, "num_agent_steps_trained": 408300, "num_env_steps_sampled": 131072, "num_env_steps_trained": 408300, "num_env_steps_sampled_this_iter": 16384, "num_env_steps_trained_this_iter": 55290, "num_env_steps_sampled_throughput_per_sec": 1638.377617493276, "num_env_steps_trained_throughput_per_sec": 5528.924467236526, "timesteps_total": 131072, "num_env_steps_sampled_lifetime": 131072, "num_agent_steps_sampled_lifetime": 408300, "num_steps_trained_this_iter": 55290, "agent_timesteps_total": 408300, "timers": {"training_iteration_time_ms": 10000.08, "restore_workers_time_ms": 0.006, "training_step_time_ms": 0.165, "sample_time_ms": 0.109, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 131072, "num_env_steps_trained": 408300, "num_agent_steps_sampled": 408300, "num_agent_steps_trained": 408300, "num_training_step_calls_since_last_synch_worker_weights": 57577, "num_samples_added_to_queue": 131072, "num_weight_broadcasts": 11}, "done": false, "training_iteration": 9, "trial_id": "15bea_00000", "date": "2024-09-01_19-47-05", "timestamp": 1725187625, "time_this_iter_s": 67.30698275566101, "time_total_s": 609.1468551158905, "pid": 2164158, "hostname": "v1", "node_ip": "143.248.233.21", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_env", "env_config": {"slippi_path": "/home/yoshi/.local/share/melee-env/Slippi/squashfs-root/usr/bin/", "iso_path": "/home/yoshi/ssbm.iso", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 16, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 512, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 4096, "train_batch_size_per_learner": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 256, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_custom_rnn_model", "custom_model_config": {"tokenizer_dims": 64, "projector_dims": 64, "load_directory": "/home/map/KAPO/checkpoint_dir/082714", "step": 1, "device_map": "cpu", "observation_config": {"settings": [0, 512], "frame": [512, 1024], "port_id": [1024, 1025]}, "num_agent_choices": [2, 3, 4], "character_choices": ["Character.LUIGI", "Character.MARIO", "Character.DOC", "Character.YOSHI", "Character.LINK", "Character.PIKACHU", "Character.FOX"], "stage_choices": ["Stage.FINAL_DESTINATION", "Stage.POKEMON_STADIUM", "Stage.BATTLEFIELD"], "available_ports": [1, 2, 3, 4]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79eda3566b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": "stdout", "__stderr_file__": "stderr", "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 609.1468551158905, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.477083333333336, "ram_util_percent": 34.71458333333333}}
